

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyccel.ast.numpyext &mdash; pyccel * documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/fonts.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> pyccel
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">docBranck</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyccel</a>
        
      </nav>


      <div class="wy-nav-content">
<div class="git-ribbon">
  <a href="http://github.com/SwissDataScienceCenter" rel="me">Join us on GitHub</a>
</div>

        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pyccel.ast.numpyext</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyccel.ast.numpyext</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#------------------------------------------------------------------------------------------#</span>
<span class="c1"># This file is part of Pyccel which is released under MIT License. See the LICENSE file or #</span>
<span class="c1"># go to https://github.com/pyccel/pyccel/blob/master/LICENSE for full license details.     #</span>
<span class="c1">#------------------------------------------------------------------------------------------#</span>
<span class="sd">&quot;&quot;&quot; Module containing objects from the numpy module understood by pyccel</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">import</span> <span class="nn">operator</span>

<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">from</span> <span class="nn">pyccel.errors.errors</span> <span class="kn">import</span> <span class="n">Errors</span>
<span class="kn">from</span> <span class="nn">pyccel.errors.messages</span> <span class="kn">import</span> <span class="n">WRONG_LINSPACE_ENDPOINT</span><span class="p">,</span> <span class="n">NON_LITERAL_KEEP_DIMS</span><span class="p">,</span> <span class="n">NON_LITERAL_AXIS</span>

<span class="kn">from</span> <span class="nn">pyccel.utilities.stage</span> <span class="kn">import</span> <span class="n">PyccelStage</span>

<span class="kn">from</span> <span class="nn">.basic</span>          <span class="kn">import</span> <span class="n">PyccelAstNode</span>
<span class="kn">from</span> <span class="nn">.builtins</span>       <span class="kn">import</span> <span class="p">(</span><span class="n">PythonInt</span><span class="p">,</span> <span class="n">PythonBool</span><span class="p">,</span> <span class="n">PythonFloat</span><span class="p">,</span> <span class="n">PythonTuple</span><span class="p">,</span>
                             <span class="n">PythonComplex</span><span class="p">,</span> <span class="n">PythonReal</span><span class="p">,</span> <span class="n">PythonImag</span><span class="p">,</span> <span class="n">PythonList</span><span class="p">,</span>
                             <span class="n">PythonType</span><span class="p">,</span> <span class="n">PythonConjugate</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">.core</span>           <span class="kn">import</span> <span class="n">Module</span><span class="p">,</span> <span class="n">Import</span><span class="p">,</span> <span class="n">PyccelFunctionDef</span><span class="p">,</span> <span class="n">FunctionCall</span>

<span class="kn">from</span> <span class="nn">.datatypes</span>      <span class="kn">import</span> <span class="p">(</span><span class="n">dtype_and_precision_registry</span> <span class="k">as</span> <span class="n">dtype_registry</span><span class="p">,</span>
                             <span class="n">default_precision</span><span class="p">,</span> <span class="n">datatype</span><span class="p">,</span> <span class="n">NativeInteger</span><span class="p">,</span>
                             <span class="n">NativeFloat</span><span class="p">,</span> <span class="n">NativeComplex</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">,</span> <span class="n">str_dtype</span><span class="p">,</span>
                             <span class="n">NativeNumeric</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">.internals</span>      <span class="kn">import</span> <span class="n">PyccelInternalFunction</span><span class="p">,</span> <span class="n">Slice</span><span class="p">,</span> <span class="n">max_precision</span><span class="p">,</span> <span class="n">get_final_precision</span>
<span class="kn">from</span> <span class="nn">.internals</span>      <span class="kn">import</span> <span class="n">PyccelArraySize</span>

<span class="kn">from</span> <span class="nn">.literals</span>       <span class="kn">import</span> <span class="n">LiteralInteger</span><span class="p">,</span> <span class="n">LiteralFloat</span><span class="p">,</span> <span class="n">LiteralComplex</span><span class="p">,</span> <span class="n">LiteralString</span><span class="p">,</span> <span class="n">convert_to_literal</span>
<span class="kn">from</span> <span class="nn">.literals</span>       <span class="kn">import</span> <span class="n">LiteralTrue</span><span class="p">,</span> <span class="n">LiteralFalse</span>
<span class="kn">from</span> <span class="nn">.literals</span>       <span class="kn">import</span> <span class="n">Nil</span>
<span class="kn">from</span> <span class="nn">.mathext</span>        <span class="kn">import</span> <span class="n">MathCeil</span>
<span class="kn">from</span> <span class="nn">.operators</span>      <span class="kn">import</span> <span class="n">broadcast</span><span class="p">,</span> <span class="n">PyccelMinus</span><span class="p">,</span> <span class="n">PyccelDiv</span><span class="p">,</span> <span class="n">PyccelMul</span><span class="p">,</span> <span class="n">PyccelAdd</span>
<span class="kn">from</span> <span class="nn">.variable</span>       <span class="kn">import</span> <span class="p">(</span><span class="n">Variable</span><span class="p">,</span> <span class="n">Constant</span><span class="p">,</span> <span class="n">HomogeneousTupleVariable</span><span class="p">)</span>

<span class="n">errors</span> <span class="o">=</span> <span class="n">Errors</span><span class="p">()</span>
<span class="n">pyccel_stage</span> <span class="o">=</span> <span class="n">PyccelStage</span><span class="p">()</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;NumpySign&#39;</span><span class="p">,</span>
    <span class="s1">&#39;process_shape&#39;</span><span class="p">,</span>
    <span class="c1"># ---</span>
    <span class="s1">&#39;NumpyAbs&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyFloor&#39;</span><span class="p">,</span>
    <span class="c1"># ---</span>
    <span class="s1">&#39;NumpySqrt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpySin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyCos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyExp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyLog&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyTan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArcsin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArccos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArctan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArctan2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpySinh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyCosh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyTanh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArcsinh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArccosh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArctanh&#39;</span><span class="p">,</span>
    <span class="c1"># ---</span>
    <span class="s1">&#39;NumpyEmpty&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyEmptyLike&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyFloat&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyComplex&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyComplex64&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyComplex128&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyFloat32&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyFloat64&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyFull&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyFullLike&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyImag&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyBool&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyInt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyInt8&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyInt16&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyInt32&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyInt64&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyLinspace&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyMatmul&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyAmax&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyAmin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArange&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArraySize&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyCountNonZero&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyMod&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyNonZero&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyNonZeroElement&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyNorm&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpySum&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyOnes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyOnesLike&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyProduct&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyRand&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyRandint&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyReal&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Shape&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyWhere&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyZeros&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyZerosLike&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1">#=======================================================================================</span>
<div class="viewcode-block" id="process_shape"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.process_shape">[docs]</a><span class="k">def</span> <span class="nf">process_shape</span><span class="p">(</span><span class="n">is_scalar</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Modify the input shape to the expected type</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    is_scalar : bool</span>
<span class="sd">                True if the result is a scalar, False if it is an array</span>
<span class="sd">    shape     : PyccelAstNode/iterable/int</span>
<span class="sd">                input shape</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_scalar</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">()</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span><span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">shape</span><span class="p">]</span>

    <span class="n">new_shape</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">shape</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,(</span><span class="n">LiteralInteger</span><span class="p">,</span> <span class="n">Variable</span><span class="p">,</span> <span class="n">Slice</span><span class="p">,</span> <span class="n">PyccelAstNode</span><span class="p">,</span> <span class="n">FunctionCall</span><span class="p">)):</span>
            <span class="n">new_shape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">new_shape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;shape elements cannot be &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;. They must be one of the following types: LiteralInteger, Variable, Slice, PyccelAstNode, int, FunctionCall&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_shape</span><span class="p">)</span></div>

<span class="c1">#=======================================================================================</span>
<div class="viewcode-block" id="NumpyFloat"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyFloat">[docs]</a><span class="k">class</span> <span class="nc">NumpyFloat</span><span class="p">(</span><span class="n">PythonFloat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.float() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;float&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">rank</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">order</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumpyFloat32"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyFloat32">[docs]</a><span class="k">class</span> <span class="nc">NumpyFloat32</span><span class="p">(</span><span class="n">NumpyFloat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.float32() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="n">dtype_registry</span><span class="p">[</span><span class="s1">&#39;float32&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;float32&#39;</span></div>

<div class="viewcode-block" id="NumpyFloat64"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyFloat64">[docs]</a><span class="k">class</span> <span class="nc">NumpyFloat64</span><span class="p">(</span><span class="n">NumpyFloat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.float64() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="n">dtype_registry</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;float64&#39;</span></div>

<span class="c1">#=======================================================================================</span>
<div class="viewcode-block" id="NumpyBool"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyBool">[docs]</a><span class="k">class</span> <span class="nc">NumpyBool</span><span class="p">(</span><span class="n">PythonBool</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.bool() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;bool&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">rank</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">order</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span></div>

<span class="c1">#=======================================================================================</span>
<span class="c1"># TODO [YG, 13.03.2020]: handle case where base != 10</span>
<div class="viewcode-block" id="NumpyInt"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyInt">[docs]</a><span class="k">class</span> <span class="nc">NumpyInt</span><span class="p">(</span><span class="n">PythonInt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.int() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;int&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">rank</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">order</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumpyInt8"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyInt8">[docs]</a><span class="k">class</span> <span class="nc">NumpyInt8</span><span class="p">(</span><span class="n">NumpyInt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.int8() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="n">dtype_registry</span><span class="p">[</span><span class="s1">&#39;int8&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;int8&#39;</span></div>

<div class="viewcode-block" id="NumpyInt16"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyInt16">[docs]</a><span class="k">class</span> <span class="nc">NumpyInt16</span><span class="p">(</span><span class="n">NumpyInt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.int16() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="n">dtype_registry</span><span class="p">[</span><span class="s1">&#39;int16&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;int16&#39;</span></div>

<div class="viewcode-block" id="NumpyInt32"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyInt32">[docs]</a><span class="k">class</span> <span class="nc">NumpyInt32</span><span class="p">(</span><span class="n">NumpyInt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.int32() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="n">dtype_registry</span><span class="p">[</span><span class="s1">&#39;int32&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;int32&#39;</span></div>

<div class="viewcode-block" id="NumpyInt64"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyInt64">[docs]</a><span class="k">class</span> <span class="nc">NumpyInt64</span><span class="p">(</span><span class="n">NumpyInt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.int64() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="n">dtype_registry</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;int64&#39;</span></div>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyReal"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyReal">[docs]</a><span class="k">class</span> <span class="nc">NumpyReal</span><span class="p">(</span><span class="n">PythonReal</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a call to  numpy.real for code generation.</span>

<span class="sd">    &gt; a = 1+2j</span>
<span class="sd">    &gt; np.real(a)</span>
<span class="sd">    1.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;real&#39;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">NumpyInt</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_var</span><span class="o">.</span><span class="n">rank</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">process_shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_var</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_elemental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates whether the function should be</span>
<span class="sd">        called elementwise for an array argument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<span class="c1">#==============================================================================</span>

<div class="viewcode-block" id="NumpyImag"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyImag">[docs]</a><span class="k">class</span> <span class="nc">NumpyImag</span><span class="p">(</span><span class="n">PythonImag</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a call to  numpy.imag for code generation.</span>

<span class="sd">    &gt; a = 1+2j</span>
<span class="sd">    &gt; np.imag(a)</span>
<span class="sd">    2.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;imag&#39;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeComplex</span><span class="p">):</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">NativeInteger</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">)</span> <span class="k">else</span> <span class="n">arg</span><span class="o">.</span><span class="n">dtype</span>
            <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">convert_to_literal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">arg</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">DtypePrecisionToCastFunction</span><span class="p">[</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">arg</span><span class="o">.</span><span class="n">precision</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">NumpyZeros</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_var</span><span class="o">.</span><span class="n">rank</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">process_shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_var</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_elemental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates whether the function should be</span>
<span class="sd">        called elementwise for an array argument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<span class="c1">#=======================================================================================</span>
<div class="viewcode-block" id="NumpyComplex"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyComplex">[docs]</a><span class="k">class</span> <span class="nc">NumpyComplex</span><span class="p">(</span><span class="n">PythonComplex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.complex() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_real_cast</span> <span class="o">=</span> <span class="n">NumpyReal</span>
    <span class="n">_imag_cast</span> <span class="o">=</span> <span class="n">NumpyImag</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;complex&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg0</span><span class="p">,</span> <span class="n">arg1</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">arg1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Use builtin complex function not deprecated np.complex&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">arg0</span><span class="o">.</span><span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="n">arg0</span><span class="o">.</span><span class="n">rank</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">arg0</span><span class="o">.</span><span class="n">order</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">arg0</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumpyComplex64"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyComplex64">[docs]</a><span class="k">class</span> <span class="nc">NumpyComplex64</span><span class="p">(</span><span class="n">NumpyComplex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.complex64() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="n">dtype_registry</span><span class="p">[</span><span class="s1">&#39;complex64&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;complex64&#39;</span></div>

<div class="viewcode-block" id="NumpyComplex128"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyComplex128">[docs]</a><span class="k">class</span> <span class="nc">NumpyComplex128</span><span class="p">(</span><span class="n">NumpyComplex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.complex128() function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="n">dtype_registry</span><span class="p">[</span><span class="s1">&#39;complex128&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span></div>

<span class="n">DtypePrecisionToCastFunction</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Int&#39;</span> <span class="p">:</span> <span class="p">{</span>
       <span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="n">PythonInt</span><span class="p">,</span>
        <span class="mi">1</span> <span class="p">:</span> <span class="n">NumpyInt8</span><span class="p">,</span>
        <span class="mi">2</span> <span class="p">:</span> <span class="n">NumpyInt16</span><span class="p">,</span>
        <span class="mi">4</span> <span class="p">:</span> <span class="n">NumpyInt32</span><span class="p">,</span>
        <span class="mi">8</span> <span class="p">:</span> <span class="n">NumpyInt64</span><span class="p">},</span>
    <span class="s1">&#39;Float&#39;</span> <span class="p">:</span> <span class="p">{</span>
       <span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="n">PythonFloat</span><span class="p">,</span>
        <span class="mi">4</span> <span class="p">:</span> <span class="n">NumpyFloat32</span><span class="p">,</span>
        <span class="mi">8</span> <span class="p">:</span> <span class="n">NumpyFloat64</span><span class="p">},</span>
    <span class="s1">&#39;Complex&#39;</span> <span class="p">:</span> <span class="p">{</span>
       <span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="n">PythonComplex</span><span class="p">,</span>
        <span class="mi">4</span> <span class="p">:</span> <span class="n">NumpyComplex64</span><span class="p">,</span>
        <span class="mi">8</span> <span class="p">:</span> <span class="n">NumpyComplex128</span><span class="p">,},</span>
    <span class="s1">&#39;Bool&#39;</span><span class="p">:</span>  <span class="p">{</span>
       <span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="n">PythonBool</span><span class="p">,</span>
        <span class="mi">4</span> <span class="p">:</span> <span class="n">NumpyBool</span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">#==============================================================================</span>

<span class="k">def</span> <span class="nf">process_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes a dtype passed to a numpy array creation function,</span>
<span class="sd">    processes it in different ways depending on its type, and finally extracts</span>
<span class="sd">    the corresponding type and precision from the `dtype_registry` dictionary.</span>

<span class="sd">    This function could be useful when working with numpy creation function</span>
<span class="sd">    having a dtype argument, like numpy.array, numpy.arrange, numpy.linspace...</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dtype: PythonType | PyccelFunctionDef | String</span>
<span class="sd">        The actual dtype passed to the numpy function</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    TypeError: In the case of unrecognized argument type.</span>
<span class="sd">    TypeError: In the case of passed string argument not recognized as valid dtype.</span>

<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">    dtype: Datatype</span>
<span class="sd">        The Datatype corresponding to the passed dtype.</span>
<span class="sd">    precision: int</span>
<span class="sd">        The precision corresponding to the passed dtype.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">PythonType</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dtype</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">PyccelFunctionDef</span><span class="p">):</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="o">.</span><span class="n">cls_name</span>

    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">(</span><span class="n">PythonInt</span><span class="p">,</span> <span class="n">PythonFloat</span><span class="p">,</span> <span class="n">PythonComplex</span><span class="p">,</span> <span class="n">PythonBool</span><span class="p">):</span>
        <span class="c1"># remove python prefix from dtype.name len(&quot;python&quot;) = 6</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="mi">6</span><span class="p">:]</span>
    <span class="k">elif</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">(</span><span class="n">NumpyInt</span><span class="p">,</span> <span class="n">NumpyInt8</span><span class="p">,</span> <span class="n">NumpyInt16</span><span class="p">,</span> <span class="n">NumpyInt32</span><span class="p">,</span> <span class="n">NumpyInt64</span><span class="p">,</span> <span class="n">NumpyComplex</span><span class="p">,</span> <span class="n">NumpyFloat</span><span class="p">,</span>
				  <span class="n">NumpyComplex128</span><span class="p">,</span> <span class="n">NumpyComplex64</span><span class="p">,</span> <span class="n">NumpyFloat64</span><span class="p">,</span> <span class="n">NumpyFloat32</span><span class="p">):</span>
        <span class="c1"># remove numpy prefix from dtype.name len(&quot;numpy&quot;) = 5</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="mi">5</span><span class="p">:]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="p">(</span><span class="n">LiteralString</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dtype_registry</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unknown type of </span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unknown type of </span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
    <span class="n">dtype</span><span class="p">,</span> <span class="n">precision</span> <span class="o">=</span> <span class="n">dtype_registry</span><span class="p">[</span><span class="n">dtype</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">precision</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">precision</span> <span class="o">=</span> <span class="n">default_precision</span><span class="p">[</span><span class="n">dtype</span><span class="p">]</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">datatype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">precision</span>

<span class="c1">#==============================================================================</span>
<span class="k">class</span> <span class="nc">NumpyNewArray</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class from which all numpy functions which imply a call to Allocate</span>
<span class="sd">    inherit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="c1">#--------------------------------------------------------------------------</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_process_order</span><span class="p">(</span><span class="n">rank</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">rank</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">order</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">order</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;unrecognized order = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">order</span>

<span class="c1">#==============================================================================</span>
<span class="c1"># TODO [YG, 18.02.2020]: accept Numpy array argument</span>
<span class="c1"># TODO [YG, 18.02.2020]: use order=&#39;K&#39; as default, like in numpy.array</span>
<span class="c1"># TODO [YG, 22.05.2020]: move dtype &amp; prec processing to __init__</span>
<span class="k">class</span> <span class="nc">NumpyArray</span><span class="p">(</span><span class="n">NumpyNewArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a call to  numpy.array for code generation.</span>

<span class="sd">    arg : list, tuple, PythonList</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_arg&#39;</span><span class="p">,</span><span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_arg&#39;</span><span class="p">,)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;array&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">(</span><span class="n">PythonTuple</span><span class="p">,</span> <span class="n">PythonList</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unknown type of  </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>

        <span class="n">is_homogeneous_tuple</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">(</span><span class="n">PythonTuple</span><span class="p">,</span> <span class="n">PythonList</span><span class="p">,</span> <span class="n">HomogeneousTupleVariable</span><span class="p">))</span> <span class="ow">and</span> <span class="n">arg</span><span class="o">.</span><span class="n">is_homogeneous</span>
        <span class="n">is_array</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)</span> <span class="ow">and</span> <span class="n">arg</span><span class="o">.</span><span class="n">is_ndarray</span>

        <span class="c1"># TODO: treat inhomogenous lists and tuples when they have mixed ordering</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">is_homogeneous_tuple</span> <span class="ow">or</span> <span class="n">is_array</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;we only accept homogeneous arguments&#39;</span><span class="p">)</span>

        <span class="c1"># Verify dtype and get precision</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">dtype</span>
            <span class="n">prec</span> <span class="o">=</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dtype</span><span class="p">,</span> <span class="n">prec</span> <span class="o">=</span> <span class="n">process_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="c1"># ... Determine ordering</span>
        <span class="n">order</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">shape</span> <span class="o">=</span> <span class="n">process_shape</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">arg</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">rank</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rank</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">order</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># ... Determine ordering</span>
            <span class="n">order</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">order</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot recognize &#39;</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">&#39; order&quot;</span><span class="p">)</span>

            <span class="c1"># TODO [YG, 18.02.2020]: set correct order based on input array</span>
            <span class="k">if</span> <span class="n">order</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">):</span>
                <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span>
            <span class="c1"># ...</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_arg</span>   <span class="o">=</span> <span class="n">arg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="n">rank</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">prec</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg</span>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyArange"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyArange">[docs]</a><span class="k">class</span> <span class="nc">NumpyArange</span><span class="p">(</span><span class="n">NumpyNewArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a call to  numpy.arange for code generation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    start : Numeric</span>
<span class="sd">        Start of interval, default value 0</span>

<span class="sd">    stop : Numeric</span>
<span class="sd">        End of interval</span>

<span class="sd">    step : Numeric</span>
<span class="sd">        Spacing between values, default value 1</span>

<span class="sd">    dtype : Datatype</span>
<span class="sd">        The type of the output array, if dtype is not given,</span>
<span class="sd">        infer the data type from the other input arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_start&#39;</span><span class="p">,</span><span class="s1">&#39;_step&#39;</span><span class="p">,</span><span class="s1">&#39;_stop&#39;</span><span class="p">,</span><span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_start&#39;</span><span class="p">,</span><span class="s1">&#39;_step&#39;</span><span class="p">,</span><span class="s1">&#39;_stop&#39;</span><span class="p">)</span>
    <span class="n">_rank</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;arange&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_start</span> <span class="o">=</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span> <span class="o">=</span> <span class="n">start</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_start</span> <span class="o">=</span> <span class="n">start</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_step</span> <span class="o">=</span> <span class="n">step</span> <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">dtype</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arg</span><span class="p">],</span> <span class="n">key</span> <span class="o">=</span> <span class="n">NativeNumeric</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arg</span><span class="p">,</span> <span class="n">allow_native</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">process_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">MathCeil</span><span class="p">(</span><span class="n">PyccelDiv</span><span class="p">(</span><span class="n">PyccelMinus</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">process_shape</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">PyccelMul</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">PyccelAdd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpySum"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpySum">[docs]</a><span class="k">class</span> <span class="nc">NumpySum</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a call to  numpy.sum for code generation.</span>

<span class="sd">    arg : list , tuple , PythonTuple, PythonList, Variable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span>
    <span class="n">_rank</span>  <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_shape</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">PyccelAstNode</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unknown type of  </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyProduct"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyProduct">[docs]</a><span class="k">class</span> <span class="nc">NumpyProduct</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a call to  numpy.prod for code generation.</span>

<span class="sd">    arg : list , tuple , PythonTuple, PythonList, Variable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_arg&#39;</span><span class="p">,</span><span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;product&#39;</span>
    <span class="n">_rank</span>  <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_shape</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">PyccelAstNode</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unknown type of  </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arg</span> <span class="o">=</span> <span class="n">PythonList</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arg</span> <span class="o">=</span> <span class="n">NumpyInt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_arg</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">)</span> <span class="ow">or</span> \
                    <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeInteger</span><span class="p">)</span> <span class="ow">and</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_arg</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">default_precision</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">]))</span>\
                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg</span><span class="o">.</span><span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_arg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg</span></div>


<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyMatmul"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyMatmul">[docs]</a><span class="k">class</span> <span class="nc">NumpyMatmul</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a call to numpy.matmul for code generation.</span>
<span class="sd">    arg : list , tuple , PythonTuple, PythonList, Variable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;matmul&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span> <span class="p">,</span><span class="n">b</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pyccel_stage</span> <span class="o">==</span> <span class="s1">&#39;syntactic&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">PyccelAstNode</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unknown type of  </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">PyccelAstNode</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unknown type of  </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

        <span class="n">args</span>      <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">integers</span>  <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">()]</span>
        <span class="n">booleans</span>  <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()]</span>
        <span class="n">floats</span>    <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeFloat</span><span class="p">()]</span>
        <span class="n">complexs</span>  <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeComplex</span><span class="p">()]</span>

        <span class="k">if</span> <span class="n">complexs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeComplex</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="n">complexs</span><span class="p">,</span> <span class="n">allow_native</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">floats</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeFloat</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="n">floats</span><span class="p">,</span> <span class="n">allow_native</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">integers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeInteger</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="n">integers</span><span class="p">,</span> <span class="n">allow_native</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">booleans</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeBool</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="n">booleans</span><span class="p">,</span> <span class="n">allow_native</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;cannot determine the type of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>

            <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">rank</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">b</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">=</span> <span class="mi">2</span>


        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">b</span><span class="o">.</span><span class="n">order</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">order</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="s1">&#39;C&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">b</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>


<span class="c1">#==============================================================================</span>

<div class="viewcode-block" id="Shape"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.Shape">[docs]</a><span class="k">class</span> <span class="nc">Shape</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.shape for code generation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;shape&#39;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">PythonTuple</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PythonTuple</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span></div>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyLinspace"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyLinspace">[docs]</a><span class="k">class</span> <span class="nc">NumpyLinspace</span><span class="p">(</span><span class="n">NumpyNewArray</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents numpy.linspace which returns num evenly spaced samples, calculated over the interval [start, stop].</span>

<span class="sd">    Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      start           : list , tuple , PythonTuple, PythonList, Variable, Literals</span>
<span class="sd">                        Represents the starting value of the sequence.</span>
<span class="sd">      stop            : list , tuple , PythonTuple, PythonList, Variable, Literals</span>
<span class="sd">                        Represents the ending value of the sequence (if endpoint is set to False).</span>
<span class="sd">      num             : int, optional</span>
<span class="sd">                        Number of samples to generate. Default is 50. Must be non-negative.</span>
<span class="sd">      endpoint        : bool, optional</span>
<span class="sd">                        If True, stop is the last sample. Otherwise, it is not included. Default is True.</span>
<span class="sd">      dtype           : str, DataType</span>
<span class="sd">                        The type of the output array. If dtype is not given, the data type is calculated</span>
<span class="sd">                        from start and stop, the calculated dtype will never be an integer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_index&#39;</span><span class="p">,</span><span class="s1">&#39;_start&#39;</span><span class="p">,</span><span class="s1">&#39;_stop&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_num&#39;</span><span class="p">,</span><span class="s1">&#39;_endpoint&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span> <span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_ind&#39;</span><span class="p">,</span><span class="s1">&#39;_step&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_py_argument&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_start&#39;</span><span class="p">,</span> <span class="s1">&#39;_stop&#39;</span><span class="p">,</span> <span class="s1">&#39;_index&#39;</span><span class="p">,</span> <span class="s1">&#39;_step&#39;</span><span class="p">,</span> <span class="s1">&#39;_num&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_endpoint&#39;</span><span class="p">,</span> <span class="s1">&#39;_ind&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;linspace&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">num</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">=</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">num</span><span class="o">.</span><span class="n">rank</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeInteger</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting positive integer num argument.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">PyccelAstNode</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">num</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting valid args.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dtype</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">process_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span>      <span class="o">=</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
            <span class="n">integers</span>  <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">()]</span>
            <span class="n">floats</span>    <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeFloat</span><span class="p">()]</span>
            <span class="n">complexs</span>  <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeComplex</span><span class="p">()]</span>

            <span class="k">if</span> <span class="n">complexs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeComplex</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="n">complexs</span><span class="p">,</span> <span class="n">allow_native</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">floats</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeFloat</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="n">floats</span><span class="p">,</span> <span class="n">allow_native</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">integers</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeFloat</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">default_precision</span><span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;cannot determine the type of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;linspace_index&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span>  <span class="o">=</span> <span class="n">stop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num</span>  <span class="o">=</span> <span class="n">num</span>
        <span class="k">if</span> <span class="n">endpoint</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_endpoint</span> <span class="o">=</span> <span class="n">LiteralTrue</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">endpoint</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_endpoint</span> <span class="o">=</span> <span class="n">LiteralFalse</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">endpoint</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">):</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">WRONG_LINSPACE_ENDPOINT</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;fatal&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_endpoint</span> <span class="o">=</span> <span class="n">endpoint</span>

        <span class="n">shape</span> <span class="o">=</span> <span class="n">broadcast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_num</span><span class="p">,)</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">+=</span> <span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="s1">&#39;C&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ind</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">LiteralFalse</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_step</span> <span class="o">=</span> <span class="n">PyccelDiv</span><span class="p">(</span><span class="n">PyccelMinus</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">LiteralTrue</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_step</span> <span class="o">=</span> <span class="n">PyccelDiv</span><span class="p">(</span><span class="n">PyccelMinus</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">),</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_step</span> <span class="o">=</span> <span class="n">PyccelDiv</span><span class="p">(</span><span class="n">PyccelMinus</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">),</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">,</span> <span class="n">PythonInt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">)))</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">endpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Indicates if the stop must be included or not.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_endpoint</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Represent the starting value of the sequence.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Represent the end value of the sequence, if the endpoint is False the stop will not be included.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Represent the number of generated elements by the linspace function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Used in the fortran codegen when there is no for loop created.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rank</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Represent size of spacing between generated elements.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Used to store the index generated by the created for loop and needed by linspace function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ind</span>

    <span class="nd">@ind</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ind</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="n">value</span><span class="o">.</span><span class="n">set_current_user_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ind</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_elemental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyWhere"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyWhere">[docs]</a><span class="k">class</span> <span class="nc">NumpyWhere</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to  numpy.where &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_condition&#39;</span><span class="p">,</span> <span class="s1">&#39;_value_true&#39;</span><span class="p">,</span> <span class="s1">&#39;_value_false&#39;</span><span class="p">,</span> <span class="s1">&#39;_dtype&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_rank&#39;</span><span class="p">,</span> <span class="s1">&#39;_shape&#39;</span><span class="p">,</span> <span class="s1">&#39;_order&#39;</span><span class="p">,</span> <span class="s1">&#39;_precision&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_condition&#39;</span><span class="p">,</span><span class="s1">&#39;_value_true&#39;</span><span class="p">,</span><span class="s1">&#39;_value_false&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;where&#39;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">condition</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">NumpyNonZero</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">condition</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_condition</span> <span class="o">=</span> <span class="n">condition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_true</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_false</span> <span class="o">=</span> <span class="n">y</span>

        <span class="n">args</span>      <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">integers</span>  <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">()</span> <span class="ow">or</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()]</span>
        <span class="n">floats</span>    <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeFloat</span><span class="p">()]</span>
        <span class="n">complexs</span>  <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeComplex</span><span class="p">()]</span>

        <span class="k">if</span> <span class="n">complexs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeComplex</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">allow_native</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">floats</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeFloat</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">allow_native</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">integers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeInteger</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">allow_native</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;cannot determine the type of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="n">shape</span> <span class="o">=</span> <span class="n">broadcast</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">broadcast</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">process_shape</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="s1">&#39;C&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">condition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Boolean argument determining which value is returned&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_condition</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value_true</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Value returned when the condition is evaluated to True.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_true</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value_false</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Value returned when the condition is evaluated to False.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_false</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_elemental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates whether the function should be</span>
<span class="sd">        called elementwise for an array argument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyRand"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyRand">[docs]</a><span class="k">class</span> <span class="nc">NumpyRand</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Represents a call to  numpy.random.random or numpy.random.rand for code generation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;rand&#39;</span>
    <span class="n">_dtype</span> <span class="o">=</span> <span class="n">NativeFloat</span><span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="n">default_precision</span><span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="s1">&#39;C&#39;</span></div>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyRandint"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyRandint">[docs]</a><span class="k">class</span> <span class="nc">NumpyRandint</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Represents a call to  numpy.random.random or numpy.random.rand for code generation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_rand&#39;</span><span class="p">,</span><span class="s1">&#39;_low&#39;</span><span class="p">,</span><span class="s1">&#39;_high&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;randint&#39;</span>
    <span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeInteger</span><span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_low&#39;</span><span class="p">,</span> <span class="s1">&#39;_high&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
            <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">,)</span>

        <span class="k">if</span> <span class="n">high</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">high</span> <span class="o">=</span> <span class="n">low</span>
            <span class="n">low</span>  <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>   <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>    <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span>   <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="s1">&#39;C&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rand</span>    <span class="o">=</span> <span class="n">NumpyRand</span><span class="p">()</span> <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">NumpyRand</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_low</span>     <span class="o">=</span> <span class="n">low</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_high</span>    <span class="o">=</span> <span class="n">high</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rand_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rand</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">high</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; return high property of NumpyRandint&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_high</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">low</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; return low property of NumpyRandint&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_low</span></div>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyFull"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyFull">[docs]</a><span class="k">class</span> <span class="nc">NumpyFull</span><span class="p">(</span><span class="n">NumpyNewArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a call to numpy.full for code generation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    shape : int or sequence of ints</span>
<span class="sd">        Shape of the new array, e.g., ``(2, 3)`` or ``2``.</span>

<span class="sd">    fill_value : scalar</span>
<span class="sd">        Fill value.</span>

<span class="sd">    dtype: str, DataType</span>
<span class="sd">        datatype for the constructed array</span>
<span class="sd">        The default, `None`, means `np.array(fill_value).dtype`.</span>

<span class="sd">    order : {&#39;C&#39;, &#39;F&#39;}, optional</span>
<span class="sd">        Whether to store multidimensional data in C- or Fortran-contiguous</span>
<span class="sd">        (row- or column-wise) order in memory.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_fill_value&#39;</span><span class="p">,</span><span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;full&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">fill_value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">):</span>

        <span class="c1"># Convert shape to PythonTuple</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">process_shape</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>

        <span class="c1"># If there is no dtype, extract it from fill_value</span>
        <span class="c1"># TODO: must get dtype from an annotated node</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">fill_value</span><span class="o">.</span><span class="n">dtype</span>
            <span class="n">precision</span> <span class="o">=</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">fill_value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dtype</span><span class="p">,</span> <span class="n">precision</span> <span class="o">=</span> <span class="n">process_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

        <span class="c1"># Cast fill_value to correct type</span>
        <span class="k">if</span> <span class="n">fill_value</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fill_value</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">dtype</span> <span class="ow">or</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">fill_value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">precision</span><span class="p">:</span>
                <span class="n">cast_func</span> <span class="o">=</span> <span class="n">DtypePrecisionToCastFunction</span><span class="p">[</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">precision</span><span class="p">]</span>
                <span class="n">fill_value</span> <span class="o">=</span> <span class="n">cast_func</span><span class="p">(</span><span class="n">fill_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">NumpyNewArray</span><span class="o">.</span><span class="n">_process_order</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rank</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">precision</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">fill_value</span><span class="p">)</span>

    <span class="c1">#--------------------------------------------------------------------------</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fill_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<span class="c1">#==============================================================================</span>
<span class="k">class</span> <span class="nc">NumpyAutoFill</span><span class="p">(</span><span class="n">NumpyFull</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Abstract class for all classes which inherit from NumpyFull but</span>
<span class="sd">        the fill_value is implicitly specified</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dtype</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data type must be provided&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">Nil</span><span class="p">(),</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyEmpty"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyEmpty">[docs]</a><span class="k">class</span> <span class="nc">NumpyEmpty</span><span class="p">(</span><span class="n">NumpyAutoFill</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.empty for code generation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;empty&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="n">NativeNumeric</span><span class="p">:</span>
            <span class="n">precision</span> <span class="o">=</span> <span class="n">default_precision</span><span class="p">[</span><span class="n">str_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)]</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">DtypePrecisionToCastFunction</span><span class="p">[</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">precision</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fill_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyZeros"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyZeros">[docs]</a><span class="k">class</span> <span class="nc">NumpyZeros</span><span class="p">(</span><span class="n">NumpyAutoFill</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.zeros for code generation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;zeros&#39;</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fill_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeInteger</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeFloat</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">LiteralFloat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeComplex</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">LiteralComplex</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">LiteralFalse</span><span class="p">(</span><span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unknown type&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span></div>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="NumpyOnes"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyOnes">[docs]</a><span class="k">class</span> <span class="nc">NumpyOnes</span><span class="p">(</span><span class="n">NumpyAutoFill</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.ones for code generation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;ones&#39;</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fill_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeInteger</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeFloat</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">LiteralFloat</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeComplex</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">LiteralComplex</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">LiteralTrue</span><span class="p">(</span><span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unknown type&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span></div>

<span class="c1">#=======================================================================================</span>
<div class="viewcode-block" id="NumpyFullLike"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyFullLike">[docs]</a><span class="k">class</span> <span class="nc">NumpyFullLike</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.full_like for code generation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;full_like&#39;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fill_value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="c1"># NOTE: we ignore &#39;subok&#39; argument</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">DtypePrecisionToCastFunction</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">a</span><span class="o">.</span><span class="n">precision</span><span class="p">]</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">order</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&quot;&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">order</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">shape</span>
        <span class="k">return</span> <span class="n">NumpyFull</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">fill_value</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span></div>

<span class="c1">#=======================================================================================</span>
<div class="viewcode-block" id="NumpyEmptyLike"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyEmptyLike">[docs]</a><span class="k">class</span> <span class="nc">NumpyEmptyLike</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.empty_like for code generation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;empty_like&#39;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="c1"># NOTE: we ignore &#39;subok&#39; argument</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">DtypePrecisionToCastFunction</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">a</span><span class="o">.</span><span class="n">precision</span><span class="p">]</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">order</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&quot;&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">order</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">shape</span>

        <span class="k">return</span> <span class="n">NumpyEmpty</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span></div>

<span class="c1">#=======================================================================================</span>
<div class="viewcode-block" id="NumpyOnesLike"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyOnesLike">[docs]</a><span class="k">class</span> <span class="nc">NumpyOnesLike</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.ones_like for code generation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;ones_like&#39;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="c1"># NOTE: we ignore &#39;subok&#39; argument</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">DtypePrecisionToCastFunction</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">a</span><span class="o">.</span><span class="n">precision</span><span class="p">]</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">order</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&quot;&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">order</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">shape</span>

        <span class="k">return</span> <span class="n">NumpyOnes</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span></div>

<span class="c1">#=======================================================================================</span>
<div class="viewcode-block" id="NumpyZerosLike"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyZerosLike">[docs]</a><span class="k">class</span> <span class="nc">NumpyZerosLike</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents a call to numpy.zeros_like for code generation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;zeros_like&#39;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="c1"># NOTE: we ignore &#39;subok&#39; argument</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">DtypePrecisionToCastFunction</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">a</span><span class="o">.</span><span class="n">precision</span><span class="p">]</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">order</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&quot;&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">order</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">shape</span>

        <span class="k">return</span> <span class="n">NumpyZeros</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span></div>

<span class="c1">#=======================================================================================</span>

<div class="viewcode-block" id="NumpyNorm"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyNorm">[docs]</a><span class="k">class</span> <span class="nc">NumpyNorm</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents call to numpy.norm&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">,</span><span class="s1">&#39;_arg&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;norm&#39;</span>
    <span class="n">_dtype</span> <span class="o">=</span> <span class="n">NativeFloat</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="p">(</span><span class="n">NativeComplex</span><span class="p">,</span> <span class="n">NativeFloat</span><span class="p">)):</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">NumpyFloat</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arg</span> <span class="o">=</span> <span class="n">PythonList</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">arg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sh</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">sh</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shape</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">arg</span><span class="o">.</span><span class="n">order</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">python_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.norm argument without casting.</span>
<span class="sd">        the actual arg property contains casting methods for C/Fortran,</span>
<span class="sd">        which is not necessary for a Python code, and the casting makes Python language tests fail.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mimic the behavior of axis argument of numpy.norm in python,</span>
<span class="sd">        and dim argument of Norm2 in Fortran.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<span class="c1">#====================================================</span>


<span class="c1">#==============================================================================</span>
<span class="c1"># Numpy universal functions</span>
<span class="c1"># https://numpy.org/doc/stable/reference/ufuncs.html#available-ufuncs</span>
<span class="c1">#==============================================================================</span>
<span class="k">class</span> <span class="nc">NumpyUfuncBase</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for Numpy&#39;s universal functions.&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_elemental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="c1">#------------------------------------------------------------------------------</span>
<span class="k">class</span> <span class="nc">NumpyUfuncUnary</span><span class="p">(</span><span class="n">NumpyUfuncBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Numpy&#39;s universal function with one argument.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_dtype_precision</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_shape_rank</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_order</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_shape_rank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>      <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>       <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">rank</span>

    <span class="k">def</span> <span class="nf">_set_dtype_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>      <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeComplex</span><span class="p">()</span> <span class="k">else</span> <span class="n">NativeFloat</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span>  <span class="o">=</span> <span class="n">default_precision</span><span class="p">[</span><span class="n">str_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">_set_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span>      <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">order</span>

<span class="c1">#------------------------------------------------------------------------------</span>
<span class="k">class</span> <span class="nc">NumpyUfuncBinary</span><span class="p">(</span><span class="n">NumpyUfuncBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Numpy&#39;s universal function with two arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="c1"># TODO: apply Numpy&#39;s broadcasting rules to get shape/rank of output</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_dtype_precision</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_shape_rank</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_order</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_shape_rank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">broadcast</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shape</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_dtype_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeFloat</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">default_precision</span><span class="p">[</span><span class="s1">&#39;float&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_set_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x1</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="n">x2</span><span class="o">.</span><span class="n">order</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">x1</span><span class="o">.</span><span class="n">order</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="s1">&#39;C&#39;</span>

<span class="c1">#------------------------------------------------------------------------------</span>
<span class="c1"># Math operations</span>
<span class="c1">#------------------------------------------------------------------------------</span>
<span class="c1">#class NumpyAbsolute(NumpyUfuncUnary): __slots__ = ()</span>
<span class="k">class</span> <span class="nc">NumpyFabs</span>    <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the fabs function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;fabs&#39;</span>
<div class="viewcode-block" id="NumpyExp"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyExp">[docs]</a><span class="k">class</span> <span class="nc">NumpyExp</span>     <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the exp function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;exp&#39;</span></div>
<div class="viewcode-block" id="NumpyLog"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyLog">[docs]</a><span class="k">class</span> <span class="nc">NumpyLog</span>     <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the log function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;log&#39;</span></div>
<div class="viewcode-block" id="NumpySqrt"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpySqrt">[docs]</a><span class="k">class</span> <span class="nc">NumpySqrt</span>    <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the sqrt function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sqrt&#39;</span></div>

<span class="c1">#------------------------------------------------------------------------------</span>
<span class="c1"># Trigonometric functions</span>
<span class="c1">#------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="NumpySin"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpySin">[docs]</a><span class="k">class</span> <span class="nc">NumpySin</span>    <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the sin function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sin&#39;</span></div>
<div class="viewcode-block" id="NumpyCos"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyCos">[docs]</a><span class="k">class</span> <span class="nc">NumpyCos</span>    <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the cos function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;cos&#39;</span></div>
<div class="viewcode-block" id="NumpyTan"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyTan">[docs]</a><span class="k">class</span> <span class="nc">NumpyTan</span>    <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the tan function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;tan&#39;</span></div>
<div class="viewcode-block" id="NumpyArcsin"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyArcsin">[docs]</a><span class="k">class</span> <span class="nc">NumpyArcsin</span> <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the arcsin function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;arcsin&#39;</span></div>
<div class="viewcode-block" id="NumpyArccos"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyArccos">[docs]</a><span class="k">class</span> <span class="nc">NumpyArccos</span> <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the arccos function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;arccos&#39;</span></div>
<div class="viewcode-block" id="NumpyArctan"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyArctan">[docs]</a><span class="k">class</span> <span class="nc">NumpyArctan</span> <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the arctan function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;arctan&#39;</span></div>
<div class="viewcode-block" id="NumpyArctan2"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyArctan2">[docs]</a><span class="k">class</span> <span class="nc">NumpyArctan2</span><span class="p">(</span><span class="n">NumpyUfuncBinary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the arctan2 function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;arctan2&#39;</span></div>
<span class="k">class</span> <span class="nc">NumpyHypot</span>  <span class="p">(</span><span class="n">NumpyUfuncBinary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the hypot function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;hypot&#39;</span>
<div class="viewcode-block" id="NumpySinh"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpySinh">[docs]</a><span class="k">class</span> <span class="nc">NumpySinh</span>   <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the sinh function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sinh&#39;</span></div>
<div class="viewcode-block" id="NumpyCosh"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyCosh">[docs]</a><span class="k">class</span> <span class="nc">NumpyCosh</span>   <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the cosh function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;cosh&#39;</span></div>
<div class="viewcode-block" id="NumpyTanh"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyTanh">[docs]</a><span class="k">class</span> <span class="nc">NumpyTanh</span>   <span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the tanh function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;tanh&#39;</span></div>
<div class="viewcode-block" id="NumpyArcsinh"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyArcsinh">[docs]</a><span class="k">class</span> <span class="nc">NumpyArcsinh</span><span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the arcsinh function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;arcsinh&#39;</span></div>
<div class="viewcode-block" id="NumpyArccosh"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyArccosh">[docs]</a><span class="k">class</span> <span class="nc">NumpyArccosh</span><span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the arccosh function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;arccosh&#39;</span></div>
<div class="viewcode-block" id="NumpyArctanh"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyArctanh">[docs]</a><span class="k">class</span> <span class="nc">NumpyArctanh</span><span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the arctanh function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;arctanh&#39;</span></div>
<span class="c1">#class NumpyDeg2rad(NumpyUfuncUnary):</span>
<span class="c1">#    &quot;&quot;&quot;Represent a call to the numpydeg2rad function in the Numpy library&quot;&quot;&quot;</span>
<span class="c1">#    __slots__ = ()</span>
<span class="c1">#    name = &#39;deg2rad&#39;</span>
<span class="c1">#class NumpyRad2deg(NumpyUfuncUnary):</span>
<span class="c1">#    &quot;&quot;&quot;Represent a call to the numpyrad2deg function in the Numpy library&quot;&quot;&quot;</span>
<span class="c1">#     __slots__ = ()</span>
<span class="c1">#     name = &#39;rad2deg&#39;</span>

<span class="c1">#=======================================================================================</span>


<div class="viewcode-block" id="NumpySign"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpySign">[docs]</a><span class="k">class</span> <span class="nc">NumpySign</span><span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the sign function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sign&#39;</span>
<div class="viewcode-block" id="NumpySign._set_dtype_precision"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpySign._set_dtype_precision">[docs]</a>    <span class="k">def</span> <span class="nf">_set_dtype_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="p">(</span><span class="n">NativeInteger</span><span class="p">,</span> <span class="n">NativeFloat</span><span class="p">,</span> <span class="n">NativeComplex</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s1"> not supported&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="NumpyAbs"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyAbs">[docs]</a><span class="k">class</span> <span class="nc">NumpyAbs</span><span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the abs function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;abs&#39;</span>
<div class="viewcode-block" id="NumpyAbs._set_dtype_precision"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyAbs._set_dtype_precision">[docs]</a>    <span class="k">def</span> <span class="nf">_set_dtype_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeInteger</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">()</span> <span class="k">else</span> <span class="n">NativeFloat</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="NumpyFloor"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyFloor">[docs]</a><span class="k">class</span> <span class="nc">NumpyFloor</span><span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the floor function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;floor&#39;</span>
<div class="viewcode-block" id="NumpyFloor._set_dtype_precision"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyFloor._set_dtype_precision">[docs]</a>    <span class="k">def</span> <span class="nf">_set_dtype_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeFloat</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">default_precision</span><span class="p">[</span><span class="n">str_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span><span class="p">)]</span></div></div>

<div class="viewcode-block" id="NumpyMod"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyMod">[docs]</a><span class="k">class</span> <span class="nc">NumpyMod</span><span class="p">(</span><span class="n">NumpyUfuncBinary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the mod function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;mod&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">NumpyInt</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">)</span> <span class="k">else</span> <span class="n">x1</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">NumpyInt</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">)</span> <span class="k">else</span> <span class="n">x2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>

<div class="viewcode-block" id="NumpyMod._set_shape_rank"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyMod._set_shape_rank">[docs]</a>    <span class="k">def</span> <span class="nf">_set_shape_rank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
        <span class="n">args</span>   <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
        <span class="n">ranks</span>  <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">rank</span>  <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">r</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ranks</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="n">broadcast</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
                    <span class="n">shape</span> <span class="o">=</span> <span class="n">broadcast</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">shape</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumpyMod._set_dtype_precision"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyMod._set_dtype_precision">[docs]</a>    <span class="k">def</span> <span class="nf">_set_dtype_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
        <span class="n">args</span>      <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
        <span class="n">integers</span>  <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">()</span> <span class="ow">or</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()]</span>
        <span class="n">floats</span>    <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeFloat</span><span class="p">()]</span>
        <span class="n">others</span>    <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">integers</span><span class="o">+</span><span class="n">floats</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">others</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> not supported&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">others</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">floats</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeFloat</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="n">floats</span><span class="p">,</span> <span class="n">allow_native</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">integers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">NativeInteger</span><span class="p">()</span>
            <span class="n">integers</span>  <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">()]</span>
            <span class="k">if</span> <span class="n">integers</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">max_precision</span><span class="p">(</span><span class="n">integers</span><span class="p">,</span> <span class="n">NativeInteger</span><span class="p">(),</span> <span class="n">allow_native</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;cannot determine the type of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div></div>

<div class="viewcode-block" id="NumpyAmin"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyAmin">[docs]</a><span class="k">class</span> <span class="nc">NumpyAmin</span><span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the amin function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;amin&#39;</span>
<div class="viewcode-block" id="NumpyAmin._set_shape_rank"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyAmin._set_shape_rank">[docs]</a>    <span class="k">def</span> <span class="nf">_set_shape_rank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>     <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>      <span class="o">=</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="NumpyAmin._set_dtype_precision"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyAmin._set_dtype_precision">[docs]</a>    <span class="k">def</span> <span class="nf">_set_dtype_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_elemental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="NumpyAmax"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyAmax">[docs]</a><span class="k">class</span> <span class="nc">NumpyAmax</span><span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent a call to the amax function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;amax&#39;</span>
<div class="viewcode-block" id="NumpyAmax._set_shape_rank"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyAmax._set_shape_rank">[docs]</a>    <span class="k">def</span> <span class="nf">_set_shape_rank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>     <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>      <span class="o">=</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="NumpyAmax._set_dtype_precision"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyAmax._set_dtype_precision">[docs]</a>    <span class="k">def</span> <span class="nf">_set_dtype_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_elemental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<span class="k">class</span> <span class="nc">NumpyTranspose</span><span class="p">(</span><span class="n">NumpyUfuncUnary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a call to the transpose function in the Numpy library&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;transpose&#39;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">axes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">rank</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">axes</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;The axes argument of the transpose function is not yet implemented&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">internal_var</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the variable being transposed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">rank</span>
        <span class="c1"># Add empty slices to fully index the object</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">rank</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">args</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">Slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span><span class="o">*</span><span class="p">(</span><span class="n">rank</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">NumpyTranspose</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="o">*</span><span class="nb">reversed</span><span class="p">(</span><span class="n">args</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_set_dtype_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>      <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span>  <span class="o">=</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_shape_rank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>      <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>       <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">rank</span>

    <span class="k">def</span> <span class="nf">_set_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">order</span><span class="o">==</span><span class="s1">&#39;F&#39;</span> <span class="k">else</span> <span class="s1">&#39;F&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_elemental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="k">class</span> <span class="nc">NumpyConjugate</span><span class="p">(</span><span class="n">PythonConjugate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a call to  numpy.conj for code generation.</span>

<span class="sd">    &gt; a = 1+2j</span>
<span class="sd">    &gt; np.conj(a)</span>
<span class="sd">    1-2j</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;conj&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_var</span><span class="o">.</span><span class="n">rank</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">process_shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_var</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_elemental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates whether the function should be</span>
<span class="sd">        called elementwise for an array argument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span>

<div class="viewcode-block" id="NumpyNonZeroElement"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyNonZeroElement">[docs]</a><span class="k">class</span> <span class="nc">NumpyNonZeroElement</span><span class="p">(</span><span class="n">NumpyNewArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Represents an element of the tuple returned by</span>
<span class="sd">    NumpyNonZero which represents a call to numpy.nonzero</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a   : array_like</span>
<span class="sd">          The argument which was passed to numpy.nonzero</span>
<span class="sd">    dim : int</span>
<span class="sd">          The index of the element in the tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_arr&#39;</span><span class="p">,</span><span class="s1">&#39;_dim&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_arr&#39;</span><span class="p">,)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;nonzero&#39;</span>
    <span class="n">_dtype</span> <span class="o">=</span> <span class="n">NativeInteger</span><span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">_rank</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arr</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dim</span> <span class="o">=</span> <span class="n">dim</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">NumpyCountNonZero</span><span class="p">(</span><span class="n">a</span><span class="p">),)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The argument which was passed to numpy.nonzero</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arr</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The dimension which the results describe</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dim</span></div>

<div class="viewcode-block" id="NumpyNonZero"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyNonZero">[docs]</a><span class="k">class</span> <span class="nc">NumpyNonZero</span><span class="p">(</span><span class="n">NumpyNewArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class representing a call to the function numpy.nonzero</span>

<span class="sd">    Example:</span>
<span class="sd">    &gt;&gt;&gt; x = np.array([[3, 0, 0], [0, 4, 0], [5, 6, 0]])</span>
<span class="sd">    &gt;&gt;&gt; np.nonzero(x)</span>
<span class="sd">    (array([0, 1, 2, 2]), array([0, 1, 0, 1]))</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_elements&#39;</span><span class="p">,</span><span class="s1">&#39;_arr&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_elements&#39;</span><span class="p">,)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;nonzero&#39;</span>
    <span class="n">_dtype</span> <span class="o">=</span> <span class="n">NativeInteger</span><span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">_rank</span>  <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_order</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Non-Zero function is only implemented for 1D arrays&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span> <span class="o">=</span> <span class="n">PythonTuple</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">NumpyNonZeroElement</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arr</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="o">.</span><span class="n">shape</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The array argument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arr</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The elements of the tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span></div>

<div class="viewcode-block" id="NumpyCountNonZero"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyCountNonZero">[docs]</a><span class="k">class</span> <span class="nc">NumpyCountNonZero</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class representing a call to the numpy size function which</span>
<span class="sd">    returns the shape of an object in a given dimension</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    arg   : PyccelAstNode</span>
<span class="sd">            An array for which the non-zero elements should be counted</span>
<span class="sd">    axis  : int</span>
<span class="sd">            The dimension along which the non-zero elements are counted</span>
<span class="sd">    keep_dims : NativeBool</span>
<span class="sd">            Indicates if output arrays should have the same number of dimensions</span>
<span class="sd">            as arg</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span> <span class="s1">&#39;_rank&#39;</span><span class="p">,</span> <span class="s1">&#39;_shape&#39;</span><span class="p">,</span> <span class="s1">&#39;_order&#39;</span><span class="p">,</span> <span class="s1">&#39;_arr&#39;</span><span class="p">,</span> <span class="s1">&#39;_axis&#39;</span><span class="p">,</span> <span class="s1">&#39;_keep_dims&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_arr&#39;</span><span class="p">,</span><span class="s1">&#39;_axis&#39;</span><span class="p">)</span>
    <span class="n">name</span>   <span class="o">=</span> <span class="s1">&#39;count_nonzero&#39;</span>
    <span class="n">_dtype</span> <span class="o">=</span> <span class="n">NativeInteger</span><span class="p">()</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">keepdims</span> <span class="o">=</span> <span class="n">LiteralFalse</span><span class="p">()):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keepdims</span><span class="p">,</span> <span class="p">(</span><span class="n">LiteralTrue</span><span class="p">,</span> <span class="n">LiteralFalse</span><span class="p">)):</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">NON_LITERAL_KEEP_DIMS</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">keepdims</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;fatal&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">):</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">NON_LITERAL_AXIS</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;fatal&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">keepdims</span><span class="o">.</span><span class="n">python_value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="mi">8</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">order</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">python_value</span><span class="p">]</span> <span class="o">=</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),)</span><span class="o">*</span><span class="n">a</span><span class="o">.</span><span class="n">rank</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">python_value</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="o">-</span><span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">order</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="o">&gt;</span><span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>  <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_arr</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axis</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_keep_dims</span> <span class="o">=</span> <span class="n">keepdims</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The argument which was passed to numpy.nonzero</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arr</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The dimension which the results describe</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axis</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">keep_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates if output arrays should have the same number</span>
<span class="sd">        of dimensions as arg</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keep_dims</span></div>

<div class="viewcode-block" id="NumpyArraySize"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.numpyext.NumpyArraySize">[docs]</a><span class="k">class</span> <span class="nc">NumpyArraySize</span><span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class representing a call to the numpy size function which</span>
<span class="sd">    returns the shape of an object in a given dimension</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    arg   : PyccelAstNode</span>
<span class="sd">            A PyccelAstNode of unknown shape</span>
<span class="sd">    axis  : int</span>
<span class="sd">            The dimension along which the size is</span>
<span class="sd">            requested</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_arg&#39;</span><span class="p">,)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_arg&#39;</span><span class="p">,)</span>
    <span class="n">name</span>   <span class="o">=</span> <span class="s1">&#39;size&#39;</span>
    <span class="n">_dtype</span> <span class="o">=</span> <span class="n">NativeInteger</span><span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">_rank</span>  <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_shape</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PyccelArraySize</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span>
                                    <span class="nb">tuple</span><span class="p">,</span>
                                    <span class="n">PyccelAstNode</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unknown type of  </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">python_value</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arg</span>   <span class="o">=</span> <span class="n">a</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Object whose size is investigated</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Size(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arg</span><span class="p">))</span></div>

<span class="c1">#==============================================================================</span>
<span class="c1"># TODO split numpy_functions into multiple dictionaries following</span>
<span class="c1"># https://docs.scipy.org/doc/numpy-1.15.0/reference/routines.array-creation.html</span>

<span class="n">numpy_linalg_mod</span> <span class="o">=</span> <span class="n">Module</span><span class="p">(</span><span class="s1">&#39;linalg&#39;</span><span class="p">,</span> <span class="p">(),</span>
    <span class="p">[</span><span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="n">NumpyNorm</span><span class="p">)])</span>

<span class="n">numpy_random_mod</span> <span class="o">=</span> <span class="n">Module</span><span class="p">(</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="p">(),</span>
    <span class="p">[</span><span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;rand&#39;</span>   <span class="p">,</span> <span class="n">NumpyRand</span><span class="p">),</span>
     <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;random&#39;</span> <span class="p">,</span> <span class="n">NumpyRand</span><span class="p">),</span>
     <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;randint&#39;</span><span class="p">,</span> <span class="n">NumpyRandint</span><span class="p">)])</span>

<span class="n">numpy_constants</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;pi&#39;</span><span class="p">:</span> <span class="n">Constant</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;pi&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
    <span class="p">}</span>

<span class="n">numpy_funcs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># ... array creation routines</span>
    <span class="s1">&#39;full&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;full&#39;</span>      <span class="p">,</span> <span class="n">NumpyFull</span><span class="p">),</span>
    <span class="s1">&#39;empty&#39;</span>     <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;empty&#39;</span>     <span class="p">,</span> <span class="n">NumpyEmpty</span><span class="p">),</span>
    <span class="s1">&#39;zeros&#39;</span>     <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;zeros&#39;</span>     <span class="p">,</span> <span class="n">NumpyZeros</span><span class="p">),</span>
    <span class="s1">&#39;ones&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;ones&#39;</span>      <span class="p">,</span> <span class="n">NumpyOnes</span><span class="p">),</span>
    <span class="s1">&#39;full_like&#39;</span> <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;full_like&#39;</span> <span class="p">,</span> <span class="n">NumpyFullLike</span><span class="p">),</span>
    <span class="s1">&#39;empty_like&#39;</span><span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;empty_like&#39;</span><span class="p">,</span> <span class="n">NumpyEmptyLike</span><span class="p">),</span>
    <span class="s1">&#39;zeros_like&#39;</span><span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;zeros_like&#39;</span><span class="p">,</span> <span class="n">NumpyZerosLike</span><span class="p">),</span>
    <span class="s1">&#39;ones_like&#39;</span> <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;ones_like&#39;</span> <span class="p">,</span> <span class="n">NumpyOnesLike</span><span class="p">),</span>
    <span class="s1">&#39;array&#39;</span>     <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;array&#39;</span>     <span class="p">,</span> <span class="n">NumpyArray</span><span class="p">),</span>
    <span class="s1">&#39;arange&#39;</span>    <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;arange&#39;</span>    <span class="p">,</span> <span class="n">NumpyArange</span><span class="p">),</span>
    <span class="c1"># ...</span>
    <span class="s1">&#39;shape&#39;</span>     <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;shape&#39;</span>     <span class="p">,</span> <span class="n">Shape</span><span class="p">),</span>
    <span class="s1">&#39;size&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;size&#39;</span>      <span class="p">,</span> <span class="n">NumpyArraySize</span><span class="p">),</span>
    <span class="s1">&#39;norm&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;norm&#39;</span>      <span class="p">,</span> <span class="n">NumpyNorm</span><span class="p">),</span>
    <span class="s1">&#39;int&#39;</span>       <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;int&#39;</span>       <span class="p">,</span> <span class="n">NumpyInt</span><span class="p">),</span>
    <span class="s1">&#39;real&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;real&#39;</span>      <span class="p">,</span> <span class="n">NumpyReal</span><span class="p">),</span>
    <span class="s1">&#39;imag&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;imag&#39;</span>      <span class="p">,</span> <span class="n">NumpyImag</span><span class="p">),</span>
    <span class="s1">&#39;conj&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;conj&#39;</span>      <span class="p">,</span> <span class="n">NumpyConjugate</span><span class="p">),</span>
    <span class="s1">&#39;conjugate&#39;</span> <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;conjugate&#39;</span> <span class="p">,</span> <span class="n">NumpyConjugate</span><span class="p">),</span>
    <span class="s1">&#39;float&#39;</span>     <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;float&#39;</span>     <span class="p">,</span> <span class="n">NumpyFloat</span><span class="p">),</span>
    <span class="s1">&#39;double&#39;</span>    <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;double&#39;</span>    <span class="p">,</span> <span class="n">NumpyFloat64</span><span class="p">),</span>
    <span class="s1">&#39;mod&#39;</span>       <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;mod&#39;</span>       <span class="p">,</span> <span class="n">NumpyMod</span><span class="p">),</span>
    <span class="s1">&#39;float32&#39;</span>   <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span>   <span class="p">,</span> <span class="n">NumpyFloat32</span><span class="p">),</span>
    <span class="s1">&#39;float64&#39;</span>   <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span>   <span class="p">,</span> <span class="n">NumpyFloat64</span><span class="p">),</span>
    <span class="s1">&#39;bool&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;bool&#39;</span>      <span class="p">,</span> <span class="n">NumpyBool</span><span class="p">),</span>
    <span class="s1">&#39;int8&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;int8&#39;</span>      <span class="p">,</span> <span class="n">NumpyInt8</span><span class="p">),</span>
    <span class="s1">&#39;int16&#39;</span>     <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;int16&#39;</span>     <span class="p">,</span> <span class="n">NumpyInt16</span><span class="p">),</span>
    <span class="s1">&#39;int32&#39;</span>     <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span>     <span class="p">,</span> <span class="n">NumpyInt32</span><span class="p">),</span>
    <span class="s1">&#39;int64&#39;</span>     <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span>     <span class="p">,</span> <span class="n">NumpyInt64</span><span class="p">),</span>
    <span class="s1">&#39;complex&#39;</span>   <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;complex&#39;</span>   <span class="p">,</span> <span class="n">NumpyComplex</span><span class="p">),</span>
    <span class="s1">&#39;complex128&#39;</span><span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;complex128&#39;</span><span class="p">,</span> <span class="n">NumpyComplex128</span><span class="p">),</span>
    <span class="s1">&#39;complex64&#39;</span> <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;complex64&#39;</span> <span class="p">,</span> <span class="n">NumpyComplex64</span><span class="p">),</span>
    <span class="s1">&#39;matmul&#39;</span>    <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;matmul&#39;</span>    <span class="p">,</span> <span class="n">NumpyMatmul</span><span class="p">),</span>
    <span class="s1">&#39;sum&#39;</span>       <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span>       <span class="p">,</span> <span class="n">NumpySum</span><span class="p">),</span>
    <span class="s1">&#39;max&#39;</span>       <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;max&#39;</span>       <span class="p">,</span> <span class="n">NumpyAmax</span><span class="p">),</span>
    <span class="s1">&#39;amax&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;amax&#39;</span>      <span class="p">,</span> <span class="n">NumpyAmax</span><span class="p">),</span>
    <span class="s1">&#39;min&#39;</span>       <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;min&#39;</span>       <span class="p">,</span> <span class="n">NumpyAmin</span><span class="p">),</span>
    <span class="s1">&#39;amin&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;amin&#39;</span>      <span class="p">,</span> <span class="n">NumpyAmin</span><span class="p">),</span>
    <span class="s1">&#39;prod&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;prod&#39;</span>      <span class="p">,</span> <span class="n">NumpyProduct</span><span class="p">),</span>
    <span class="s1">&#39;product&#39;</span>   <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;product&#39;</span>   <span class="p">,</span> <span class="n">NumpyProduct</span><span class="p">),</span>
    <span class="s1">&#39;linspace&#39;</span>  <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;linspace&#39;</span>  <span class="p">,</span> <span class="n">NumpyLinspace</span><span class="p">),</span>
    <span class="s1">&#39;where&#39;</span>     <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;where&#39;</span>     <span class="p">,</span> <span class="n">NumpyWhere</span><span class="p">),</span>
    <span class="c1"># ---</span>
    <span class="s1">&#39;sign&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;sign&#39;</span>      <span class="p">,</span> <span class="n">NumpySign</span><span class="p">),</span>
    <span class="s1">&#39;abs&#39;</span>       <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;abs&#39;</span>       <span class="p">,</span> <span class="n">NumpyAbs</span><span class="p">),</span>
    <span class="s1">&#39;floor&#39;</span>     <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;floor&#39;</span>     <span class="p">,</span> <span class="n">NumpyFloor</span><span class="p">),</span>
    <span class="s1">&#39;absolute&#39;</span>  <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;absolute&#39;</span>  <span class="p">,</span> <span class="n">NumpyAbs</span><span class="p">),</span>
    <span class="s1">&#39;fabs&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;fabs&#39;</span>      <span class="p">,</span> <span class="n">NumpyFabs</span><span class="p">),</span>
    <span class="s1">&#39;exp&#39;</span>       <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;exp&#39;</span>       <span class="p">,</span> <span class="n">NumpyExp</span><span class="p">),</span>
    <span class="s1">&#39;log&#39;</span>       <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;log&#39;</span>       <span class="p">,</span> <span class="n">NumpyLog</span><span class="p">),</span>
    <span class="s1">&#39;sqrt&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;sqrt&#39;</span>      <span class="p">,</span> <span class="n">NumpySqrt</span><span class="p">),</span>
    <span class="c1"># ---</span>
    <span class="s1">&#39;sin&#39;</span>       <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;sin&#39;</span>       <span class="p">,</span> <span class="n">NumpySin</span><span class="p">),</span>
    <span class="s1">&#39;cos&#39;</span>       <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;cos&#39;</span>       <span class="p">,</span> <span class="n">NumpyCos</span><span class="p">),</span>
    <span class="s1">&#39;tan&#39;</span>       <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;tan&#39;</span>       <span class="p">,</span> <span class="n">NumpyTan</span><span class="p">),</span>
    <span class="s1">&#39;arcsin&#39;</span>    <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;arcsin&#39;</span>    <span class="p">,</span> <span class="n">NumpyArcsin</span><span class="p">),</span>
    <span class="s1">&#39;arccos&#39;</span>    <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;arccos&#39;</span>    <span class="p">,</span> <span class="n">NumpyArccos</span><span class="p">),</span>
    <span class="s1">&#39;arctan&#39;</span>    <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;arctan&#39;</span>    <span class="p">,</span> <span class="n">NumpyArctan</span><span class="p">),</span>
    <span class="s1">&#39;arctan2&#39;</span>   <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;arctan2&#39;</span>   <span class="p">,</span> <span class="n">NumpyArctan2</span><span class="p">),</span>
    <span class="c1"># &#39;hypot&#39;     : PyccelFunctionDef(&#39;hypot&#39;     , NumpyHypot),</span>
    <span class="s1">&#39;sinh&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;sinh&#39;</span>      <span class="p">,</span> <span class="n">NumpySinh</span><span class="p">),</span>
    <span class="s1">&#39;cosh&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;cosh&#39;</span>      <span class="p">,</span> <span class="n">NumpyCosh</span><span class="p">),</span>
    <span class="s1">&#39;tanh&#39;</span>      <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;tanh&#39;</span>      <span class="p">,</span> <span class="n">NumpyTanh</span><span class="p">),</span>
    <span class="s1">&#39;arcsinh&#39;</span>   <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;arcsinh&#39;</span>   <span class="p">,</span> <span class="n">NumpyArcsinh</span><span class="p">),</span>
    <span class="s1">&#39;arccosh&#39;</span>   <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;arccosh&#39;</span>   <span class="p">,</span> <span class="n">NumpyArccosh</span><span class="p">),</span>
    <span class="s1">&#39;arctanh&#39;</span>   <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;arctanh&#39;</span>   <span class="p">,</span> <span class="n">NumpyArctanh</span><span class="p">),</span>
    <span class="c1"># &#39;deg2rad&#39;   : PyccelFunctionDef(&#39;deg2rad&#39;   , NumpyDeg2rad),</span>
    <span class="c1"># &#39;rad2deg&#39;   : PyccelFunctionDef(&#39;rad2deg&#39;   , NumpyRad2deg),</span>
    <span class="s1">&#39;transpose&#39;</span> <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;transpose&#39;</span> <span class="p">,</span> <span class="n">NumpyTranspose</span><span class="p">),</span>
    <span class="s1">&#39;nonzero&#39;</span>   <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;nonzero&#39;</span>   <span class="p">,</span> <span class="n">NumpyNonZero</span><span class="p">),</span>
    <span class="s1">&#39;count_nonzero&#39;</span> <span class="p">:</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;count_nonzero&#39;</span><span class="p">,</span> <span class="n">NumpyCountNonZero</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">numpy_mod</span> <span class="o">=</span> <span class="n">Module</span><span class="p">(</span><span class="s1">&#39;numpy&#39;</span><span class="p">,</span>
    <span class="n">variables</span> <span class="o">=</span> <span class="n">numpy_constants</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
    <span class="n">funcs</span> <span class="o">=</span> <span class="n">numpy_funcs</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
    <span class="n">imports</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Import</span><span class="p">(</span><span class="s1">&#39;linalg&#39;</span><span class="p">,</span> <span class="n">numpy_linalg_mod</span><span class="p">),</span>
        <span class="n">Import</span><span class="p">(</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">numpy_random_mod</span><span class="p">),</span>
        <span class="p">])</span>

<span class="c1">#==============================================================================</span>

<span class="n">numpy_target_swap</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">numpy_funcs</span><span class="p">[</span><span class="s1">&#39;full_like&#39;</span><span class="p">]</span>  <span class="p">:</span> <span class="n">numpy_funcs</span><span class="p">[</span><span class="s1">&#39;full&#39;</span><span class="p">],</span>
        <span class="n">numpy_funcs</span><span class="p">[</span><span class="s1">&#39;empty_like&#39;</span><span class="p">]</span> <span class="p">:</span> <span class="n">numpy_funcs</span><span class="p">[</span><span class="s1">&#39;empty&#39;</span><span class="p">],</span>
        <span class="n">numpy_funcs</span><span class="p">[</span><span class="s1">&#39;zeros_like&#39;</span><span class="p">]</span> <span class="p">:</span> <span class="n">numpy_funcs</span><span class="p">[</span><span class="s1">&#39;zeros&#39;</span><span class="p">],</span>
        <span class="n">numpy_funcs</span><span class="p">[</span><span class="s1">&#39;ones_like&#39;</span><span class="p">]</span>  <span class="p">:</span> <span class="n">numpy_funcs</span><span class="p">[</span><span class="s1">&#39;ones&#39;</span><span class="p">]</span>
    <span class="p">}</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, *.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>