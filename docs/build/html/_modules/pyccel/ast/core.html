

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyccel.ast.core &mdash; pyccel * documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/fonts.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> pyccel
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">docBranck</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyccel</a>
        
      </nav>


      <div class="wy-nav-content">
<div class="git-ribbon">
  <a href="http://github.com/SwissDataScienceCenter" rel="me">Join us on GitHub</a>
</div>

        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pyccel.ast.core</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyccel.ast.core</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#------------------------------------------------------------------------------------------#</span>
<span class="c1"># This file is part of Pyccel which is released under MIT License. See the LICENSE file or #</span>
<span class="c1"># go to https://github.com/pyccel/pyccel/blob/master/LICENSE for full license details.     #</span>
<span class="c1">#------------------------------------------------------------------------------------------#</span>

<span class="kn">from</span> <span class="nn">sympy.logic.boolalg</span>      <span class="kn">import</span> <span class="n">And</span> <span class="k">as</span> <span class="n">sp_And</span>


<span class="kn">from</span> <span class="nn">pyccel.errors.errors</span>     <span class="kn">import</span> <span class="n">Errors</span>
<span class="kn">from</span> <span class="nn">pyccel.errors.messages</span>   <span class="kn">import</span> <span class="n">RECURSIVE_RESULTS_REQUIRED</span>

<span class="kn">from</span> <span class="nn">pyccel.utilities.stage</span>   <span class="kn">import</span> <span class="n">PyccelStage</span>
<span class="kn">from</span> <span class="nn">pyccel.utilities.strings</span> <span class="kn">import</span> <span class="n">create_incremented_string</span>

<span class="kn">from</span> <span class="nn">.basic</span>     <span class="kn">import</span> <span class="n">Basic</span><span class="p">,</span> <span class="n">PyccelAstNode</span><span class="p">,</span> <span class="n">iterable</span><span class="p">,</span> <span class="n">ScopedNode</span>
<span class="kn">from</span> <span class="nn">.builtins</span>  <span class="kn">import</span> <span class="p">(</span><span class="n">PythonEnumerate</span><span class="p">,</span> <span class="n">PythonLen</span><span class="p">,</span> <span class="n">PythonMap</span><span class="p">,</span> <span class="n">PythonTuple</span><span class="p">,</span>
                        <span class="n">PythonRange</span><span class="p">,</span> <span class="n">PythonZip</span><span class="p">,</span> <span class="n">PythonBool</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.datatypes</span> <span class="kn">import</span> <span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">NativeSymbol</span><span class="p">,</span>
                        <span class="n">NativeBool</span><span class="p">,</span> <span class="n">NativeRange</span><span class="p">,</span>
                        <span class="n">NativeTuple</span><span class="p">,</span> <span class="n">str_dtype</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.internals</span> <span class="kn">import</span> <span class="n">Slice</span><span class="p">,</span> <span class="n">PyccelSymbol</span><span class="p">,</span> <span class="n">PyccelInternalFunction</span><span class="p">,</span> <span class="n">get_final_precision</span>

<span class="kn">from</span> <span class="nn">.literals</span>  <span class="kn">import</span> <span class="n">LiteralInteger</span><span class="p">,</span> <span class="n">Nil</span><span class="p">,</span> <span class="n">LiteralFalse</span>
<span class="kn">from</span> <span class="nn">.literals</span>  <span class="kn">import</span> <span class="n">NilArgument</span><span class="p">,</span> <span class="n">LiteralTrue</span>

<span class="kn">from</span> <span class="nn">.operators</span> <span class="kn">import</span> <span class="n">PyccelAdd</span><span class="p">,</span> <span class="n">PyccelMinus</span><span class="p">,</span> <span class="n">PyccelMul</span><span class="p">,</span> <span class="n">PyccelDiv</span><span class="p">,</span> <span class="n">PyccelMod</span><span class="p">,</span> <span class="n">Relational</span>
<span class="kn">from</span> <span class="nn">.operators</span> <span class="kn">import</span> <span class="n">PyccelOperator</span><span class="p">,</span> <span class="n">PyccelAssociativeParenthesis</span><span class="p">,</span> <span class="n">PyccelIs</span>

<span class="kn">from</span> <span class="nn">.variable</span> <span class="kn">import</span> <span class="n">DottedName</span><span class="p">,</span> <span class="n">IndexedElement</span>
<span class="kn">from</span> <span class="nn">.variable</span> <span class="kn">import</span> <span class="n">Variable</span>

<span class="n">errors</span> <span class="o">=</span> <span class="n">Errors</span><span class="p">()</span>
<span class="n">pyccel_stage</span> <span class="o">=</span> <span class="n">PyccelStage</span><span class="p">()</span>

<span class="c1"># TODO [YG, 12.03.2020]: Move non-Python constructs to other modules</span>
<span class="c1"># TODO [YG, 12.03.2020]: Rename classes to avoid name clashes in pyccel/ast</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;AliasAssign&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Allocate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AnnotatedComment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AsName&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Assert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Assign&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AugAssign&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Block&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Break&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ClassDef&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CodeBlock&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Comment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CommentBlock&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ConstructorCall&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Continue&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Deallocate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Declare&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Del&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Duplicate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DoConcurrent&#39;</span><span class="p">,</span>
    <span class="s1">&#39;EmptyNode&#39;</span><span class="p">,</span>
    <span class="s1">&#39;For&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ForIterator&#39;</span><span class="p">,</span>
    <span class="s1">&#39;FunctionCall&#39;</span><span class="p">,</span>
    <span class="s1">&#39;FunctionCallArgument&#39;</span><span class="p">,</span>
    <span class="s1">&#39;FunctionDef&#39;</span><span class="p">,</span>
    <span class="s1">&#39;FunctionDefArgument&#39;</span><span class="p">,</span>
    <span class="s1">&#39;If&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Import&#39;</span><span class="p">,</span>
    <span class="s1">&#39;InlineFunctionDef&#39;</span><span class="p">,</span>
    <span class="s1">&#39;InProgram&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Interface&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Module&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ModuleHeader&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Pass&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Program&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Return&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SeparatorComment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;StarredArguments&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SymbolicAssign&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SymbolicPrint&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SympyFunction&#39;</span><span class="p">,</span>
    <span class="s1">&#39;While&#39;</span><span class="p">,</span>
    <span class="s1">&#39;With&#39;</span><span class="p">,</span>
    <span class="s1">&#39;create_variable&#39;</span><span class="p">,</span>
    <span class="s1">&#39;create_incremented_string&#39;</span><span class="p">,</span>
    <span class="s1">&#39;get_iterable_ranges&#39;</span><span class="p">,</span>
    <span class="s1">&#39;inline&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subs&#39;</span>
<span class="p">)</span>

<span class="c1">#==============================================================================</span>

<span class="c1"># TODO - add EmptyStmt =&gt; empty lines</span>
<span class="c1">#      - update code examples</span>
<span class="c1">#      - add examples</span>
<span class="c1">#      - Function case</span>
<span class="c1">#      - AnnotatedComment case</span>
<span class="c1">#      - add a new Idx that uses Variable instead of Symbol</span>

<span class="c1">#==============================================================================</span>
<span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span><span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="subs"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.subs">[docs]</a><span class="k">def</span> <span class="nf">subs</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">new_elements</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Substitutes old for new in an expression.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    new_elements : list of tuples like [(x,2)(y,3)]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">new_elements</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">expr</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">subs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">new_elements</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="p">]</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">While</span><span class="p">):</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">subs</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">new_elements</span><span class="p">)</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">subs</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">new_elements</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">While</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">For</span><span class="p">):</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">subs</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">new_elements</span><span class="p">)</span>
        <span class="n">it</span> <span class="o">=</span> <span class="n">subs</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">iterable</span><span class="p">,</span> <span class="n">new_elements</span><span class="p">)</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">target</span>
        <span class="n">it</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">iterable</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">subs</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">new_elements</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">For</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">it</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">If</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">stmts</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">subs</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">new_elements</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">subs</span><span class="p">(</span><span class="n">stmts</span><span class="p">,</span> <span class="n">new_elements</span><span class="p">)</span>
            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">If</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Return</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_elements</span><span class="p">:</span>
            <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">expr</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Assign</span><span class="p">):</span>
        <span class="n">new_expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">new_elements</span><span class="p">)</span>
        <span class="n">new_expr</span><span class="o">.</span><span class="n">set_fst</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">fst</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_expr</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">PyccelAstNode</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">new_elements</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">expr</span></div>

<div class="viewcode-block" id="inline"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.inline">[docs]</a><span class="k">def</span> <span class="nf">inline</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="n">local_vars</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">local_vars</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">body</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">subs</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">arguments</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Block</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">local_vars</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span></div>

<div class="viewcode-block" id="create_variable"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.create_variable">[docs]</a><span class="k">def</span> <span class="nf">create_variable</span><span class="p">(</span><span class="n">forbidden_names</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function takes a prefix and a counter and uses them to construct</span>
<span class="sd">    a PyccelSymbol with a name of the form:</span>
<span class="sd">            prefix_counter</span>
<span class="sd">    Where counter is formatted to fill 4 characters</span>
<span class="sd">    The new name is checked against a list of forbidden expressions. If the</span>
<span class="sd">    constructed name is forbidden then the counter is incremented until a valid</span>
<span class="sd">    name is found</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      forbidden_exprs : Set</span>
<span class="sd">                        A set of all the values which are not valid solutions to this problem</span>
<span class="sd">      prefix          : str</span>
<span class="sd">                        The prefix used to begin the string</span>
<span class="sd">      counter         : int</span>
<span class="sd">                        The expected value of the next name</span>

<span class="sd">      Returns</span>
<span class="sd">      ----------</span>
<span class="sd">      name            : PyccelSymbol</span>
<span class="sd">                        A PyccelSymbol with the incremented string name</span>
<span class="sd">      counter         : int</span>
<span class="sd">                        The expected value of the next name</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">,</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">create_incremented_string</span><span class="p">(</span><span class="n">forbidden_names</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">PyccelSymbol</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">is_temp</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">counter</span></div>


<div class="viewcode-block" id="AsName"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.AsName">[docs]</a><span class="k">class</span> <span class="nc">AsName</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a renaming of a variable, used with Import.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import AsName, FunctionDef</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.numpyext import NumpyFull</span>
<span class="sd">    &gt;&gt;&gt; func = FunctionDef(&#39;old&#39;, (), (), ())</span>
<span class="sd">    &gt;&gt;&gt; AsName(func, &#39;new&#39;)</span>
<span class="sd">    old as new</span>
<span class="sd">    &gt;&gt;&gt; AsName(NumpyFull, &#39;fill_func&#39;)</span>
<span class="sd">    full as fill_func</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    obj    : Basic or BasicType</span>
<span class="sd">             The variable, function, or module being renamed</span>
<span class="sd">    target : str</span>
<span class="sd">             name of variable or function in this context</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_obj&#39;</span><span class="p">,</span> <span class="s1">&#39;_target&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pyccel_stage</span> <span class="o">!=</span> <span class="s2">&quot;syntactic&quot;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Basic</span><span class="p">)</span> <span class="ow">and</span> \
                    <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">PyccelSymbol</span><span class="p">))</span> <span class="ow">or</span> \
                   <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Basic</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="n">target</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The original name of the object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">PyccelSymbol</span><span class="p">,</span> <span class="n">DottedName</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The target name of the object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The underlying object described by this AsName</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> as </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> as </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">string</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">AsName</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">target</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">string</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">string</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">)</span></div>


<div class="viewcode-block" id="Duplicate"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Duplicate">[docs]</a><span class="k">class</span> <span class="nc">Duplicate</span><span class="p">(</span><span class="n">PyccelAstNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; this is equivalent to the * operator for python tuples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    value : PyccelAstNode</span>
<span class="sd">           an expression which represents the initilized value of the list</span>

<span class="sd">    shape : the shape of the array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_val&#39;</span><span class="p">,</span> <span class="s1">&#39;_length&#39;</span><span class="p">,</span><span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_val&#39;</span><span class="p">,</span> <span class="s1">&#39;_length&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>      <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">rank</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>     <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">s</span> <span class="k">if</span> <span class="n">i</span><span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">PyccelMul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span>     <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">order</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_val</span>       <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_length</span>    <span class="o">=</span> <span class="n">length</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">val</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_val</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> * </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> * </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">))</span></div>

<span class="k">class</span> <span class="nc">Concatenate</span><span class="p">(</span><span class="n">PyccelAstNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; this is equivalent to the + operator for python tuples</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    args : PyccelAstNodes</span>
<span class="sd">           The tuples</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_args&#39;</span><span class="p">,</span><span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_args&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>     <span class="o">=</span> <span class="n">arg1</span><span class="o">.</span><span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span> <span class="o">=</span> <span class="n">arg1</span><span class="o">.</span><span class="n">precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>      <span class="o">=</span> <span class="n">arg1</span><span class="o">.</span><span class="n">rank</span>
        <span class="n">shape_addition</span>  <span class="o">=</span> <span class="n">arg2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>     <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">s</span> <span class="k">if</span> <span class="n">i</span><span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">PyccelAdd</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">shape_addition</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arg1</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span>     <span class="o">=</span> <span class="n">arg1</span><span class="o">.</span><span class="n">order</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span>


<div class="viewcode-block" id="Assign"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Assign">[docs]</a><span class="k">class</span> <span class="nc">Assign</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents variable assignment for code generation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lhs : PyccelAstNode</span>
<span class="sd">        In the syntactic stage:</span>
<span class="sd">           Object representing the lhs of the expression. These should be</span>
<span class="sd">           singular objects, such as one would use in writing code. Notable types</span>
<span class="sd">           include PyccelSymbol, and IndexedElement. Types that</span>
<span class="sd">           subclass these types are also supported.</span>
<span class="sd">        In the semantic stage:</span>
<span class="sd">           Variable or IndexedElement</span>

<span class="sd">    rhs : PyccelAstNode</span>
<span class="sd">        In the syntactic stage:</span>
<span class="sd">          Object representing the rhs of the expression</span>
<span class="sd">        In the semantic stage :</span>
<span class="sd">          PyccelAstNode with the same shape as the lhs</span>

<span class="sd">    status: None, str</span>
<span class="sd">        if lhs is not allocatable, then status is None.</span>
<span class="sd">        otherwise, status is {&#39;allocated&#39;, &#39;unallocated&#39;}</span>

<span class="sd">    like: None, Variable</span>
<span class="sd">        contains the name of the variable from which the lhs will be cloned.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.internals import symbols</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.variable import Variable</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Assign</span>
<span class="sd">    &gt;&gt;&gt; x, y, z = symbols(&#39;x, y, z&#39;)</span>
<span class="sd">    &gt;&gt;&gt; Assign(x, y)</span>
<span class="sd">    x := y</span>
<span class="sd">    &gt;&gt;&gt; Assign(x, 0)</span>
<span class="sd">    x := 0</span>
<span class="sd">    &gt;&gt;&gt; A = Variable(&#39;int&#39;, &#39;A&#39;, rank = 2)</span>
<span class="sd">    &gt;&gt;&gt; Assign(x, A)</span>
<span class="sd">    x := A</span>
<span class="sd">    &gt;&gt;&gt; Assign(A[0,1], x)</span>
<span class="sd">    IndexedElement(A, 0, 1) := x</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_lhs&#39;</span><span class="p">,</span> <span class="s1">&#39;_rhs&#39;</span><span class="p">,</span> <span class="s1">&#39;_status&#39;</span><span class="p">,</span> <span class="s1">&#39;_like&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_lhs&#39;</span><span class="p">,</span> <span class="s1">&#39;_rhs&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">lhs</span><span class="p">,</span>
        <span class="n">rhs</span><span class="p">,</span>
        <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fst</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">lhs</span> <span class="o">=</span> <span class="n">PythonTuple</span><span class="p">(</span><span class="o">*</span><span class="n">lhs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">rhs</span> <span class="o">=</span> <span class="n">PythonTuple</span><span class="p">(</span><span class="o">*</span><span class="n">rhs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lhs</span> <span class="o">=</span> <span class="n">lhs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rhs</span> <span class="o">=</span> <span class="n">rhs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="n">status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_like</span> <span class="o">=</span> <span class="n">like</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">fst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_fst</span><span class="p">(</span><span class="n">fst</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> := </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;(</span><span class="si">{0}</span><span class="s1"> := </span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lhs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lhs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rhs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rhs</span>

    <span class="c1"># TODO : remove</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_status</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">like</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_like</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if the assignment is an alias.&quot;&quot;&quot;</span>

        <span class="c1"># TODO to be improved when handling classes</span>

        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lhs</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhs</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)</span> <span class="ow">and</span> <span class="n">rhs</span><span class="o">.</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">cond</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">IndexedElement</span><span class="p">)</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">cond</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">PyccelSymbol</span><span class="p">)</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">cond</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)</span> <span class="ow">and</span> <span class="n">rhs</span><span class="o">.</span><span class="n">is_alias</span>
        <span class="k">return</span> <span class="n">cond</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_symbolic_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if the assignment is a symbolic alias.&quot;&quot;&quot;</span>

        <span class="c1"># TODO to be improved when handling classes</span>

        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lhs</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lhs</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeSymbol</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">PyccelSymbol</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">PythonRange</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeSymbol</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">PyccelSymbol</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span></div>

<span class="c1">#------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="Allocate"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Allocate">[docs]</a><span class="k">class</span> <span class="nc">Allocate</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents memory allocation (usually of an array) for code generation.</span>
<span class="sd">    This is relevant to low-level target languages, such as C or Fortran,</span>
<span class="sd">    where the programmer must take care of heap memory allocation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variable : pyccel.ast.core.Variable</span>
<span class="sd">        The typed variable (usually an array) that needs memory allocation.</span>

<span class="sd">    shape : int or iterable or None</span>
<span class="sd">        Shape of the array after allocation (None for scalars).</span>

<span class="sd">    order : str {&#39;C&#39;|&#39;F&#39;}</span>
<span class="sd">        Ordering of multi-dimensional array after allocation</span>
<span class="sd">        (&#39;C&#39; = row-major, &#39;F&#39; = column-major).</span>

<span class="sd">    status : str {&#39;allocated&#39;|&#39;unallocated&#39;|&#39;unknown&#39;}</span>
<span class="sd">        Variable allocation status at object creation.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    An object of this class is immutable, although it contains a reference to a</span>
<span class="sd">    mutable Variable object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variable&#39;</span><span class="p">,</span> <span class="s1">&#39;_shape&#39;</span><span class="p">,</span> <span class="s1">&#39;_order&#39;</span><span class="p">,</span> <span class="s1">&#39;_status&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variable&#39;</span><span class="p">,)</span>

    <span class="c1"># ...</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can only allocate a &#39;Variable&#39; object, got </span><span class="si">{}</span><span class="s2"> instead&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">variable</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">on_stack</span><span class="p">:</span>
            <span class="c1"># Variable may only be a pointer in the wrapper</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Variable must be allocatable&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shape</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot understand &#39;shape&#39; parameter of type &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">shape</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">rank</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Incompatible rank in variable allocation&quot;</span><span class="p">)</span>

        <span class="c1"># rank is None for lambda functions</span>
        <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">rank</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">variable</span><span class="o">.</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">variable</span><span class="o">.</span><span class="n">order</span> <span class="o">!=</span> <span class="n">order</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Incompatible order in variable allocation&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot understand &#39;status&#39; parameter of type &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">status</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">status</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;allocated&#39;</span><span class="p">,</span> <span class="s1">&#39;unallocated&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value of &#39;status&#39; not allowed: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span> <span class="o">=</span> <span class="n">variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>    <span class="o">=</span> <span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span>    <span class="o">=</span> <span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_status</span>   <span class="o">=</span> <span class="n">status</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="c1"># ...</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_status</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Allocate(</span><span class="si">{}</span><span class="s1">, shape=</span><span class="si">{}</span><span class="s1">, order=</span><span class="si">{}</span><span class="s1">, status=</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Allocate</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="ow">is</span> <span class="n">other</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span> <span class="ow">and</span> \
                   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span>    <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">shape</span>   <span class="p">)</span> <span class="ow">and</span> \
                   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span>    <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span>   <span class="p">)</span> <span class="ow">and</span> \
                   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span>   <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">status</span>  <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">))</span></div>

<span class="c1">#------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="Deallocate"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Deallocate">[docs]</a><span class="k">class</span> <span class="nc">Deallocate</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents memory deallocation (usually of an array) for code generation.</span>
<span class="sd">    This is relevant to low-level target languages, such as C or Fortran,</span>
<span class="sd">    where the programmer must take care of heap memory deallocation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variable : pyccel.ast.core.Variable</span>
<span class="sd">        The typed variable (usually an array) that needs memory deallocation.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    An object of this class is immutable, although it contains a reference to a</span>
<span class="sd">    mutable Variable object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variable&#39;</span><span class="p">,)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variable&#39;</span><span class="p">,)</span>

    <span class="c1"># ...</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can only allocate a &#39;Variable&#39; object, got </span><span class="si">{}</span><span class="s2"> instead&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">variable</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span> <span class="o">=</span> <span class="n">variable</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># ...</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Deallocate</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="ow">is</span> <span class="n">other</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">))</span></div>

<span class="c1">#------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="CodeBlock"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.CodeBlock">[docs]</a><span class="k">class</span> <span class="nc">CodeBlock</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a list of stmt for code generation.</span>
<span class="sd">       we use it when a single statement in python</span>
<span class="sd">       produce multiple statement in the targeted language</span>

<span class="sd">       Parameters</span>
<span class="sd">       ==========</span>
<span class="sd">       body : iterable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_body&#39;</span><span class="p">,</span><span class="s1">&#39;_unravelled&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_body&#39;</span><span class="p">,)</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">unravelled</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">CodeBlock</span><span class="p">):</span>
                <span class="n">ls</span> <span class="o">+=</span> <span class="n">i</span><span class="o">.</span><span class="n">body</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">EmptyNode</span><span class="p">):</span>
                <span class="n">ls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">unravelled</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;unravelled must be a boolean&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_body</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unravelled</span> <span class="o">=</span> <span class="n">unravelled</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_body</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unravelled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates whether the vector syntax of python</span>
<span class="sd">        has been unravelled into for loops</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unravelled</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lhs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lhs</span>

<div class="viewcode-block" id="CodeBlock.insert2body"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.CodeBlock.insert2body">[docs]</a>    <span class="k">def</span> <span class="nf">insert2body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">obj</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Insert object(s) to the body of the codeblock</span>
<span class="sd">        The object(s) are inserted at the back by default but</span>
<span class="sd">        can be inserted at the front by setting back to False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span><span class="o">.</span><span class="n">set_current_user_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">back</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_body</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="o">*</span><span class="n">obj</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_body</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="o">*</span><span class="n">obj</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">])</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;CodeBlock(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__reduce_ex__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Used by pickle to create an object of this class.</span>

<span class="sd">          Parameters</span>
<span class="sd">          ----------</span>

<span class="sd">          i : int</span>
<span class="sd">           protocol</span>

<span class="sd">          Results</span>
<span class="sd">          -------</span>

<span class="sd">          out : tuple</span>
<span class="sd">           A tuple of two elements</span>
<span class="sd">           a callable function that can be called</span>
<span class="sd">           to create the initial version of the object</span>
<span class="sd">           and its arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">apply</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="p">(),</span> <span class="n">kwargs</span><span class="p">))</span>

<div class="viewcode-block" id="CodeBlock.set_fst"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.CodeBlock.set_fst">[docs]</a>    <span class="k">def</span> <span class="nf">set_fst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fst</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_fst</span><span class="p">(</span><span class="n">fst</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">l</span><span class="o">.</span><span class="n">fst</span><span class="p">:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">set_fst</span><span class="p">(</span><span class="n">fst</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="AliasAssign"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.AliasAssign">[docs]</a><span class="k">class</span> <span class="nc">AliasAssign</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents aliasing for code generation. An alias is any statement of the</span>
<span class="sd">    form `lhs := rhs` where</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lhs : PyccelSymbol</span>
<span class="sd">        at this point we don&#39;t know yet all information about lhs, this is why a</span>
<span class="sd">        PyccelSymbol is the appropriate type.</span>

<span class="sd">    rhs : Variable, IndexedElement</span>
<span class="sd">        an assignable variable can be of any rank and any datatype, however its</span>
<span class="sd">        shape must be known (not None)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.internals import PyccelSymbol</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import AliasAssign</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Variable</span>
<span class="sd">    &gt;&gt;&gt; n = Variable(&#39;int&#39;, &#39;n&#39;)</span>
<span class="sd">    &gt;&gt;&gt; x = Variable(&#39;int&#39;, &#39;x&#39;, rank=1, shape=[n])</span>
<span class="sd">    &gt;&gt;&gt; y = PyccelSymbol(&#39;y&#39;)</span>
<span class="sd">    &gt;&gt;&gt; AliasAssign(y, x)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_lhs&#39;</span><span class="p">,</span><span class="s1">&#39;_rhs&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_lhs&#39;</span><span class="p">,</span><span class="s1">&#39;_rhs&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pyccel_stage</span> <span class="o">==</span> <span class="s1">&#39;semantic&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">lhs</span><span class="o">.</span><span class="n">is_alias</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;lhs must be a pointer&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">FunctionCall</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">rhs</span><span class="o">.</span><span class="n">funcdef</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_alias</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;A pointer cannot point to the address of a temporary variable&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_lhs</span> <span class="o">=</span> <span class="n">lhs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rhs</span> <span class="o">=</span> <span class="n">rhs</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> := </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lhs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lhs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rhs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rhs</span></div>


<div class="viewcode-block" id="SymbolicAssign"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.SymbolicAssign">[docs]</a><span class="k">class</span> <span class="nc">SymbolicAssign</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents symbolic aliasing for code generation. An alias is any statement of the</span>
<span class="sd">    form `lhs := rhs` where</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lhs : PyccelSymbol</span>

<span class="sd">    rhs : Range</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.internals import PyccelSymbol</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import SymbolicAssign</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Range</span>
<span class="sd">    &gt;&gt;&gt; r = Range(0, 3)</span>
<span class="sd">    &gt;&gt;&gt; y = PyccelSymbol(&#39;y&#39;)</span>
<span class="sd">    &gt;&gt;&gt; SymbolicAssign(y, r)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_lhs&#39;</span><span class="p">,</span> <span class="s1">&#39;_rhs&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_lhs&#39;</span><span class="p">,</span> <span class="s1">&#39;_rhs&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lhs</span> <span class="o">=</span> <span class="n">lhs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rhs</span> <span class="o">=</span> <span class="n">rhs</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> := </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lhs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lhs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rhs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rhs</span></div>


<div class="viewcode-block" id="AugAssign"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.AugAssign">[docs]</a><span class="k">class</span> <span class="nc">AugAssign</span><span class="p">(</span><span class="n">Assign</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents augmented variable assignment for code generation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lhs : PyccelAstNode</span>
<span class="sd">        In the syntactic stage:</span>
<span class="sd">           Object representing the lhs of the expression. These should be</span>
<span class="sd">           singular objects, such as one would use in writing code. Notable types</span>
<span class="sd">           include PyccelSymbol, and IndexedElement. Types that</span>
<span class="sd">           subclass these types are also supported.</span>
<span class="sd">        In the semantic stage:</span>
<span class="sd">           Variable or IndexedElement</span>

<span class="sd">    op : str</span>
<span class="sd">        Operator (+, -, /, \*, %).</span>

<span class="sd">    rhs : PyccelAstNode</span>
<span class="sd">        In the syntactic stage:</span>
<span class="sd">          Object representing the rhs of the expression</span>
<span class="sd">        In the semantic stage :</span>
<span class="sd">          PyccelAstNode with the same shape as the lhs</span>

<span class="sd">    status: None, str</span>
<span class="sd">        if lhs is not allocatable, then status is None.</span>
<span class="sd">        otherwise, status is {&#39;allocated&#39;, &#39;unallocated&#39;}</span>

<span class="sd">    like: None, Variable</span>
<span class="sd">        contains the name of the variable from which the lhs will be cloned.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Variable</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import AugAssign</span>
<span class="sd">    &gt;&gt;&gt; s = Variable(&#39;int&#39;, &#39;s&#39;)</span>
<span class="sd">    &gt;&gt;&gt; t = Variable(&#39;int&#39;, &#39;t&#39;)</span>
<span class="sd">    &gt;&gt;&gt; AugAssign(s, &#39;+&#39;, 2 * t + 1)</span>
<span class="sd">    s += 1 + 2*t</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_op&#39;</span><span class="p">,)</span>
    <span class="n">_accepted_operators</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;+&#39;</span> <span class="p">:</span> <span class="n">PyccelAdd</span><span class="p">,</span>
            <span class="s1">&#39;-&#39;</span> <span class="p">:</span> <span class="n">PyccelMinus</span><span class="p">,</span>
            <span class="s1">&#39;*&#39;</span> <span class="p">:</span> <span class="n">PyccelMul</span><span class="p">,</span>
            <span class="s1">&#39;/&#39;</span> <span class="p">:</span> <span class="n">PyccelDiv</span><span class="p">,</span>
            <span class="s1">&#39;%&#39;</span> <span class="p">:</span> <span class="n">PyccelMod</span><span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">lhs</span><span class="p">,</span>
        <span class="n">op</span><span class="p">,</span>
        <span class="n">rhs</span><span class="p">,</span>
        <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fst</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">):</span>

        <span class="k">if</span> <span class="n">op</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepted_operators</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unrecognized Operator&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_op</span> <span class="o">=</span> <span class="n">op</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">like</span><span class="p">,</span> <span class="n">fst</span><span class="o">=</span><span class="n">fst</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1">= </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1">= </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">op</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_op</span>

<div class="viewcode-block" id="AugAssign.to_basic_assign"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.AugAssign.to_basic_assign">[docs]</a>    <span class="k">def</span> <span class="nf">to_basic_assign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the AugAssign to an Assign</span>
<span class="sd">        E.g. convert:</span>
<span class="sd">        a += b</span>
<span class="sd">        to:</span>
<span class="sd">        a = a + b</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Assign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_accepted_operators</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_op</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhs</span><span class="p">),</span>
                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
                <span class="n">like</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">like</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="While"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.While">[docs]</a><span class="k">class</span> <span class="nc">While</span><span class="p">(</span><span class="n">ScopedNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a &#39;while&#39; statement in the code.</span>

<span class="sd">    Expressions are of the form:</span>
<span class="sd">        &quot;while test:</span>
<span class="sd">            body...&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    test : PyccelAstNode</span>
<span class="sd">        test condition given as an expression</span>
<span class="sd">    body : list of Pyccel objects</span>
<span class="sd">        list of statements representing the body of the While statement.</span>
<span class="sd">    scope : Scope</span>
<span class="sd">        The scope for the loop</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.internals import PyccelSymbol</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Assign, While</span>
<span class="sd">    &gt;&gt;&gt; n = PyccelSymbol(&#39;n&#39;)</span>
<span class="sd">    &gt;&gt;&gt; While((n&gt;1), [Assign(n,n-1)])</span>
<span class="sd">    While(n &gt; 1, (n := n - 1,))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_body&#39;</span><span class="p">,</span><span class="s1">&#39;_test&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_body&#39;</span><span class="p">,</span><span class="s1">&#39;_test&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">scope</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">pyccel_stage</span> <span class="o">==</span> <span class="s1">&#39;semantic&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">test</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NativeBool</span><span class="p">():</span>
                <span class="n">test</span> <span class="o">=</span> <span class="n">PythonBool</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">iterable</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">CodeBlock</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span><span class="n">CodeBlock</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;body must be an iterable or a CodeBlock&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_test</span> <span class="o">=</span> <span class="n">test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_body</span> <span class="o">=</span> <span class="n">body</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_test</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_body</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">local_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of variables defined in the loop &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></div>


<div class="viewcode-block" id="With"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.With">[docs]</a><span class="k">class</span> <span class="nc">With</span><span class="p">(</span><span class="n">ScopedNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a &#39;with&#39; statement in the code.</span>

<span class="sd">    Expressions are of the form:</span>
<span class="sd">        &quot;with statement:</span>
<span class="sd">            body...&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    test : PyccelAstNode</span>
<span class="sd">        with definition statement given as an expression</span>
<span class="sd">    body : list of Pyccel objects</span>
<span class="sd">        list of statements representing the body of the With statement.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_test&#39;</span><span class="p">,</span><span class="s1">&#39;_body&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_test&#39;</span><span class="p">,</span><span class="s1">&#39;_body&#39;</span><span class="p">)</span>

    <span class="c1"># TODO check prelude and epilog</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">test</span><span class="p">,</span>
        <span class="n">body</span><span class="p">,</span>
        <span class="n">scope</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">):</span>

        <span class="k">if</span> <span class="n">iterable</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">CodeBlock</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span><span class="n">CodeBlock</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;body must be an iterable&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_test</span> <span class="o">=</span> <span class="n">test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_body</span> <span class="o">=</span> <span class="n">body</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_test</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_body</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">block</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">methods</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">cls_base</span><span class="o">.</span><span class="n">methods</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;__enter__&#39;</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;__exit__&#39;</span><span class="p">:</span>
                <span class="n">end</span>   <span class="o">=</span> <span class="n">i</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">inline</span><span class="p">(</span><span class="n">start</span><span class="p">,[])</span>
        <span class="n">end</span>   <span class="o">=</span> <span class="n">inline</span><span class="p">(</span><span class="n">end</span>  <span class="p">,[])</span>

        <span class="c1"># TODO check if enter is empty or not first</span>

        <span class="n">body</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">body</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">body</span>
        <span class="n">body</span> <span class="o">+=</span>  <span class="n">end</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">body</span>
        <span class="k">return</span> <span class="n">Block</span><span class="p">(</span><span class="s1">&#39;with&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">body</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="p">)</span></div>


<span class="c1"># TODO add a name to a block?</span>

<div class="viewcode-block" id="Block"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Block">[docs]</a><span class="k">class</span> <span class="nc">Block</span><span class="p">(</span><span class="n">ScopedNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a block in the code. A block consists of the following inputs</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables: list</span>
<span class="sd">        list of the variables that appear in the block.</span>

<span class="sd">    declarations: list</span>
<span class="sd">        list of declarations of the variables that appear in the block.</span>

<span class="sd">    body: list</span>
<span class="sd">        a list of statements</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Variable, Assign, Block</span>
<span class="sd">    &gt;&gt;&gt; n = Variable(&#39;int&#39;, &#39;n&#39;)</span>
<span class="sd">    &gt;&gt;&gt; x = Variable(&#39;int&#39;, &#39;x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; Block([n, x], [Assign(x,2.*n + 1.), Assign(n, n + 1)])</span>
<span class="sd">    Block([n, x], [x := 1.0 + 2.0*n, n := 1 + n])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span><span class="s1">&#39;_variables&#39;</span><span class="p">,</span><span class="s1">&#39;_body&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variables&#39;</span><span class="p">,</span><span class="s1">&#39;_body&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">variables</span><span class="p">,</span>
        <span class="n">body</span><span class="p">,</span>
        <span class="n">scope</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;name must be of type str&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;variables must be an iterable&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Only a Variable instance is allowed.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">iterable</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">CodeBlock</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">CodeBlock</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;body must be an iterable or a CodeBlock&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="n">variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_body</span> <span class="o">=</span> <span class="n">body</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_body</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">declarations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Declare</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">]</span></div>



<div class="viewcode-block" id="Module"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Module">[docs]</a><span class="k">class</span> <span class="nc">Module</span><span class="p">(</span><span class="n">ScopedNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a module in the code. A block consists of the following inputs</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        name of the module</span>

<span class="sd">    variables: list</span>
<span class="sd">        list of the variables that appear in the block.</span>

<span class="sd">    funcs: list</span>
<span class="sd">        a list of FunctionDef instances</span>

<span class="sd">    init_func: FunctionDef</span>
<span class="sd">        The function which initialises the module (expressions in the</span>
<span class="sd">        python module which are executed on import)</span>
<span class="sd">        Default : None</span>

<span class="sd">    free_func: FunctionDef</span>
<span class="sd">        The function which frees any variables allocated in the module</span>
<span class="sd">        Default : None</span>

<span class="sd">    program: Program/CodeBlock</span>
<span class="sd">        CodeBlock containing any expressions which are only executed</span>
<span class="sd">        when the module is executed directly</span>

<span class="sd">    interfaces: list</span>
<span class="sd">        a list of Interface instances</span>

<span class="sd">    classes: list</span>
<span class="sd">        a list of ClassDef instances</span>

<span class="sd">    imports: list, tuple</span>
<span class="sd">        list of needed imports</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Variable, Assign</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import ClassDef, FunctionDef, Module</span>
<span class="sd">    &gt;&gt;&gt; x = Variable(&#39;float&#39;, &#39;x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; y = Variable(&#39;float&#39;, &#39;y&#39;)</span>
<span class="sd">    &gt;&gt;&gt; z = Variable(&#39;float&#39;, &#39;z&#39;)</span>
<span class="sd">    &gt;&gt;&gt; t = Variable(&#39;float&#39;, &#39;t&#39;)</span>
<span class="sd">    &gt;&gt;&gt; a = Variable(&#39;float&#39;, &#39;a&#39;)</span>
<span class="sd">    &gt;&gt;&gt; b = Variable(&#39;float&#39;, &#39;b&#39;)</span>
<span class="sd">    &gt;&gt;&gt; body = [Assign(y,x+a)]</span>
<span class="sd">    &gt;&gt;&gt; translate = FunctionDef(&#39;translate&#39;, [x,y,a,b], [z,t], body)</span>
<span class="sd">    &gt;&gt;&gt; attributes   = [x,y]</span>
<span class="sd">    &gt;&gt;&gt; methods     = [translate]</span>
<span class="sd">    &gt;&gt;&gt; Point = ClassDef(&#39;Point&#39;, attributes, methods)</span>
<span class="sd">    &gt;&gt;&gt; incr = FunctionDef(&#39;incr&#39;, [x], [y], [Assign(y,x+1)])</span>
<span class="sd">    &gt;&gt;&gt; decr = FunctionDef(&#39;decr&#39;, [x], [y], [Assign(y,x-1)])</span>
<span class="sd">    &gt;&gt;&gt; Module(&#39;my_module&#39;, [], [incr, decr], classes = [Point])</span>
<span class="sd">    Module(my_module, [], [FunctionDef(), FunctionDef()], [], [ClassDef(Point, (x, y), (FunctionDef(),), [public], (), [], [])], ())</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span><span class="s1">&#39;_variables&#39;</span><span class="p">,</span><span class="s1">&#39;_funcs&#39;</span><span class="p">,</span><span class="s1">&#39;_interfaces&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_classes&#39;</span><span class="p">,</span><span class="s1">&#39;_imports&#39;</span><span class="p">,</span><span class="s1">&#39;_init_func&#39;</span><span class="p">,</span><span class="s1">&#39;_free_func&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_program&#39;</span><span class="p">,</span><span class="s1">&#39;_variable_inits&#39;</span><span class="p">,</span><span class="s1">&#39;_internal_dictionary&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variables&#39;</span><span class="p">,</span><span class="s1">&#39;_funcs&#39;</span><span class="p">,</span><span class="s1">&#39;_interfaces&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;_classes&#39;</span><span class="p">,</span><span class="s1">&#39;_imports&#39;</span><span class="p">,</span><span class="s1">&#39;_init_func&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;_free_func&#39;</span><span class="p">,</span><span class="s1">&#39;_program&#39;</span><span class="p">,</span><span class="s1">&#39;_variable_inits&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">variables</span><span class="p">,</span>
        <span class="n">funcs</span><span class="p">,</span>
        <span class="n">init_func</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">free_func</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">program</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">interfaces</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">classes</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">imports</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">scope</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">AsName</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;name must be a string or an AsName&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;variables must be an iterable&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Only a Variable instance is allowed.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">funcs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;funcs must be an iterable&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">FunctionDef</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Only a FunctionDef instance is allowed.&#39;</span>
                                <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;classes must be an iterable&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ClassDef</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Only a ClassDef instance is allowed.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">interfaces</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;interfaces must be an iterable&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">interfaces</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Interface</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Only a Interface instance is allowed.&#39;</span><span class="p">)</span>

        <span class="n">NoneType</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">init_func</span><span class="p">,</span> <span class="p">(</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">FunctionDef</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;init_func must be a FunctionDef&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">free_func</span><span class="p">,</span> <span class="p">(</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">FunctionDef</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;free_func must be a FunctionDef&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="p">(</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">Program</span><span class="p">,</span> <span class="n">CodeBlock</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;program must be a Program (or a CodeBlock at the syntactic stage)&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">imports</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;imports must be an iterable&#39;</span><span class="p">)</span>
        <span class="n">imports</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">imports</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
            <span class="n">imports</span> <span class="o">+=</span> <span class="n">i</span><span class="o">.</span><span class="n">imports</span>
        <span class="n">imports</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">imports</span><span class="p">)</span>  <span class="c1"># for unicity</span>
        <span class="n">imports</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">imports</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="n">variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_variable_inits</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_funcs</span> <span class="o">=</span> <span class="n">funcs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_func</span> <span class="o">=</span> <span class="n">init_func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_free_func</span> <span class="o">=</span> <span class="n">free_func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_program</span>   <span class="o">=</span> <span class="n">program</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interfaces</span> <span class="o">=</span> <span class="n">interfaces</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_classes</span> <span class="o">=</span> <span class="n">classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imports</span> <span class="o">=</span> <span class="n">imports</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_internal_dictionary</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_internal_dictionary</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_internal_dictionary</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">interfaces</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_internal_dictionary</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">})</span>
        <span class="n">import_mods</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="o">.</span><span class="n">source</span><span class="p">:</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">object</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">target</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">Module</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">imports</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_internal_dictionary</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">v</span><span class="p">:</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="n">import_mods</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">t</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">init_func</span><span class="p">:</span>
            <span class="n">init_if</span> <span class="o">=</span> <span class="n">init_func</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">init_cond</span> <span class="o">=</span> <span class="n">init_if</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">condition</span>
            <span class="n">init_var</span> <span class="o">=</span> <span class="n">init_cond</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">init_var</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_variable_inits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LiteralFalse</span><span class="p">())</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Name of the module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Module global variables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">init_func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The function which initialises the module (expressions in the</span>
<span class="sd">        python module which are executed on import)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_func</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">free_func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The function which frees any variables allocated in the module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_free_func</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">program</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; CodeBlock or Program containing any expressions which are only executed</span>
<span class="sd">        when the module is executed directly</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_program</span>

    <span class="nd">@program</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">program</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prog</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_program</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_program</span> <span class="o">=</span> <span class="n">prog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_program</span><span class="o">.</span><span class="n">set_current_user_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">funcs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Any functions defined in the module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_funcs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">interfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Any interfaces defined in the module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interfaces</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Any classes defined in the module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_classes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">imports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Any imports in the module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imports</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">declarations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the declarations of the variables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Declare</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">module_variable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> \
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable_inits</span><span class="p">)]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the functions, interfaces and classes defined</span>
<span class="sd">        in the module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interfaces</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">funcs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span>

<div class="viewcode-block" id="Module.set_name"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Module.set_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function for changing the name of a module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">new_name</span></div>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal_dictionary</span><span class="p">[</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">PyccelSymbol</span><span class="p">,</span> <span class="n">DottedName</span><span class="p">))</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">current_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal_dictionary</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal_dictionary</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">i</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="ow">and</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">current_pos</span> <span class="o">=</span> <span class="n">current_pos</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">current_pos</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="Module.keys"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Module.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the names of all objects accessible directly in this module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal_dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="ModuleHeader"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.ModuleHeader">[docs]</a><span class="k">class</span> <span class="nc">ModuleHeader</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents the header file for a module</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    module: Module</span>
<span class="sd">        the module</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Variable, Assign</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import ClassDef, FunctionDef, Module</span>
<span class="sd">    &gt;&gt;&gt; x = Variable(&#39;float&#39;, &#39;x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; y = Variable(&#39;float&#39;, &#39;y&#39;)</span>
<span class="sd">    &gt;&gt;&gt; z = Variable(&#39;float&#39;, &#39;z&#39;)</span>
<span class="sd">    &gt;&gt;&gt; t = Variable(&#39;float&#39;, &#39;t&#39;)</span>
<span class="sd">    &gt;&gt;&gt; a = Variable(&#39;float&#39;, &#39;a&#39;)</span>
<span class="sd">    &gt;&gt;&gt; b = Variable(&#39;float&#39;, &#39;b&#39;)</span>
<span class="sd">    &gt;&gt;&gt; body = [Assign(y,x+a)]</span>
<span class="sd">    &gt;&gt;&gt; translate = FunctionDef(&#39;translate&#39;, [x,y,a,b], [z,t], body)</span>
<span class="sd">    &gt;&gt;&gt; attributes   = [x,y]</span>
<span class="sd">    &gt;&gt;&gt; methods     = [translate]</span>
<span class="sd">    &gt;&gt;&gt; Point = ClassDef(&#39;Point&#39;, attributes, methods)</span>
<span class="sd">    &gt;&gt;&gt; incr = FunctionDef(&#39;incr&#39;, [x], [y], [Assign(y,x+1)])</span>
<span class="sd">    &gt;&gt;&gt; decr = FunctionDef(&#39;decr&#39;, [x], [y], [Assign(y,x-1)])</span>
<span class="sd">    &gt;&gt;&gt; mod = Module(&#39;my_module&#39;, [], [incr, decr], classes = [Point])</span>
<span class="sd">    &gt;&gt;&gt; ModuleHeader(mod)</span>
<span class="sd">    Module(my_module, [], [FunctionDef(), FunctionDef()], [], [ClassDef(Point, (x, y), (FunctionDef(),), [public], (), [], [])], ())</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_module&#39;</span><span class="p">,)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_module&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">Module</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;module must be a Module&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_module</span> <span class="o">=</span> <span class="n">module</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">module</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module</span></div>

<div class="viewcode-block" id="Program"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Program">[docs]</a><span class="k">class</span> <span class="nc">Program</span><span class="p">(</span><span class="n">ScopedNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a Program in the code. A block consists of the following inputs</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables: list</span>
<span class="sd">        list of the variables that appear in the block.</span>

<span class="sd">    body: list</span>
<span class="sd">        a list of statements</span>

<span class="sd">    imports: list, tuple</span>
<span class="sd">        list of needed imports</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;_variables&#39;</span><span class="p">,</span> <span class="s1">&#39;_body&#39;</span><span class="p">,</span> <span class="s1">&#39;_imports&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variables&#39;</span><span class="p">,</span> <span class="s1">&#39;_body&#39;</span><span class="p">,</span> <span class="s1">&#39;_imports&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">variables</span><span class="p">,</span>
        <span class="n">body</span><span class="p">,</span>
        <span class="n">imports</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">scope</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;name must be a string&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;variables must be an iterable&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Only a Variable instance is allowed.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;body must be an iterable&#39;</span><span class="p">)</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">CodeBlock</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">imports</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;imports must be an iterable&#39;</span><span class="p">)</span>

        <span class="n">imports</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">imports</span><span class="p">)</span>  <span class="c1"># for unicity</span>
        <span class="n">imports</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">imports</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="n">variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_body</span> <span class="o">=</span> <span class="n">body</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imports</span> <span class="o">=</span> <span class="n">imports</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Name of the executable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Variables contained within the program</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Statements in the program</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_body</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">imports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Imports imported in the program</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imports</span>

<div class="viewcode-block" id="Program.remove_import"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Program.remove_import">[docs]</a>    <span class="k">def</span> <span class="nf">remove_import</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Remove an import with the given source name from the list</span>
<span class="sd">        of imports</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">invalidate_node</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">imports</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="n">name</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imports</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">imports</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">source</span> <span class="o">!=</span> <span class="n">name</span><span class="p">)</span></div></div>


<span class="c1">#==============================================================================</span>
<span class="k">class</span> <span class="nc">Iterable</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper around iterable types helping to convert between those</span>
<span class="sd">    types and a range (necessary in low level languages, e.g. C and Fortran)</span>

<span class="sd">    Paramaters</span>
<span class="sd">    ----------</span>
<span class="sd">    iterable : acceptable_iterator_type</span>
<span class="sd">               The iterator being wrapped</span>
<span class="sd">               The type must be in acceptable_iterator_types or the class must</span>
<span class="sd">               implement the following functions:</span>
<span class="sd">               - n_indices</span>
<span class="sd">               - to_range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">acceptable_iterator_types</span> <span class="o">=</span> <span class="p">(</span><span class="n">Variable</span><span class="p">,</span> <span class="n">PythonMap</span><span class="p">,</span> <span class="n">PythonZip</span><span class="p">,</span> <span class="n">PythonEnumerate</span><span class="p">,</span> <span class="n">PythonRange</span><span class="p">,</span> <span class="n">IndexedElement</span><span class="p">)</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_iterable&#39;</span><span class="p">,</span><span class="s1">&#39;_indices&#39;</span><span class="p">,</span><span class="s1">&#39;_num_indices_required&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_iterable&#39;</span><span class="p">,</span><span class="s1">&#39;_indices&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iterable</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span> <span class="o">=</span> <span class="n">iterable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span>  <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">PythonRange</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_num_indices_required</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">PythonEnumerate</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_num_indices_required</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">iterable</span><span class="o">.</span><span class="n">start</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">acceptable_iterator_types</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_num_indices_required</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="s1">&#39;n_indices&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="s1">&#39;to_range&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_num_indices_required</span> <span class="o">=</span> <span class="n">iterable</span><span class="o">.</span><span class="n">n_indices</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unknown iterator type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">iterable</span><span class="p">)))</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_loop_counters_required</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Number of iterators which must be generated in order to</span>
<span class="sd">        convert this iterable to a range</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_indices_required</span>

    <span class="k">def</span> <span class="nf">set_loop_counter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">indices</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set the iterator(s) for the generated range</span>
<span class="sd">        These are iterators generated by pyccel so are not</span>
<span class="sd">        needed for python code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
            <span class="n">i</span><span class="o">.</span><span class="n">set_current_user_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span> <span class="o">=</span> <span class="n">indices</span>

    <span class="k">def</span> <span class="nf">unset_loop_counter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">invalidate</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Remove the iterator(s) set for the generated range</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">:</span>
            <span class="n">i</span><span class="o">.</span><span class="n">remove_user_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">invalidate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">get_assigns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns a list containing any assigns necessary to initialise</span>
<span class="sd">        the loop iterators/targets when using a range iterable</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        target : Variable or list of Variables</span>
<span class="sd">                 The index(es) over which the loop iterates</span>

<span class="sd">        Results</span>
<span class="sd">        -------</span>
<span class="sd">        assigns : list of Assign</span>
<span class="sd">                  The assignments necessary to define target</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">PythonRange</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="n">range_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_target_from_range</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_loop_counters_required</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">range_element</span> <span class="o">=</span> <span class="n">range_element</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">AliasAssign</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">is_alias</span> <span class="k">else</span> <span class="n">Assign</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">range_element</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">AliasAssign</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">range_element</span><span class="p">)</span> <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">is_alias</span> <span class="k">else</span> <span class="n">Assign</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">range_element</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">get_target_from_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns an element of the range indexed with the iterators</span>
<span class="sd">        previously provided via the set_loop_counters method</span>
<span class="sd">        (useful for get_assigns and to determine the dtype etc of the</span>
<span class="sd">        loop iterator)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span>
        <span class="n">range_base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span><span class="p">,</span> <span class="n">PythonMap</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">FunctionCall</span><span class="p">(</span><span class="n">range_base</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">range_base</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">range_base</span>

    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the range required for this iterable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span><span class="p">,</span> <span class="n">PythonRange</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span><span class="p">,</span> <span class="s1">&#39;to_range&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span><span class="o">.</span><span class="n">to_range</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">,</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="n">PythonLen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
                <span class="n">length</span> <span class="o">=</span> <span class="n">length</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">PythonRange</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">iterable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the iterable being wrapped</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">loop_counters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the iterator(s) of the generated range</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span>

<span class="c1">#==============================================================================</span>

<div class="viewcode-block" id="For"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.For">[docs]</a><span class="k">class</span> <span class="nc">For</span><span class="p">(</span><span class="n">ScopedNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a &#39;for-loop&#39; in the code.</span>

<span class="sd">    Expressions are of the form:</span>
<span class="sd">        &quot;for target in iter:</span>
<span class="sd">            body...&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    target : symbol / Variable</span>
<span class="sd">        symbol representing the iterator</span>
<span class="sd">    iter : iterable</span>
<span class="sd">        iterable object. for the moment only Range is used</span>
<span class="sd">    body : list of pyccel objects</span>
<span class="sd">        list of statements representing the body of the For statement.</span>
<span class="sd">    scope : Scope</span>
<span class="sd">        The scope for the loop</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.variable import Variable</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Assign, For</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.internals import symbols</span>
<span class="sd">    &gt;&gt;&gt; i,b,e,s,x = symbols(&#39;i,b,e,s,x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; A = Variable(&#39;int&#39;, &#39;A&#39;, rank = 2)</span>
<span class="sd">    &gt;&gt;&gt; For(i, (b,e,s), [Assign(x, i), Assign(A[0, 1], x)])</span>
<span class="sd">    For(i, (b, e, s), (x := i, IndexedElement(A, 0, 1) := x))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_target&#39;</span><span class="p">,</span><span class="s1">&#39;_iterable&#39;</span><span class="p">,</span><span class="s1">&#39;_body&#39;</span><span class="p">,</span><span class="s1">&#39;_end_annotation&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_target&#39;</span><span class="p">,</span><span class="s1">&#39;_iterable&#39;</span><span class="p">,</span><span class="s1">&#39;_body&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">,</span>
        <span class="n">iter_obj</span><span class="p">,</span>
        <span class="n">body</span><span class="p">,</span>
        <span class="n">scope</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">):</span>
        <span class="k">if</span> <span class="n">pyccel_stage</span> <span class="o">!=</span> <span class="s2">&quot;syntactic&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iter_obj</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
                <span class="n">iter_obj</span> <span class="o">=</span> <span class="n">Iterable</span><span class="p">(</span><span class="n">iter_obj</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">iter_obj</span><span class="o">.</span><span class="n">num_loop_counters_required</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;iter_obj must be an iterable&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">iterable</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">CodeBlock</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span><span class="n">CodeBlock</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;body must be an iterable or a Codeblock&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="n">target</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span> <span class="o">=</span> <span class="n">iter_obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_body</span> <span class="o">=</span> <span class="n">body</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_end_annotation</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">end_annotation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_end_annotation</span>

    <span class="nd">@end_annotation</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">end_annotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_end_annotation</span> <span class="o">=</span> <span class="n">expr</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">iterable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_body</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">local_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of variables defined in the loop &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<div class="viewcode-block" id="For.insert2body"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.For.insert2body">[docs]</a>    <span class="k">def</span> <span class="nf">insert2body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stmt</span><span class="p">):</span>
        <span class="n">stmt</span><span class="o">.</span><span class="n">set_current_user_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">insert2body</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="DoConcurrent"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.DoConcurrent">[docs]</a><span class="k">class</span> <span class="nc">DoConcurrent</span><span class="p">(</span><span class="n">For</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="ForIterator"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.ForIterator">[docs]</a><span class="k">class</span> <span class="nc">ForIterator</span><span class="p">(</span><span class="n">For</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Class that describes iterable classes defined by the user.&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">,</span>
        <span class="n">iterable</span><span class="p">,</span>
        <span class="n">body</span><span class="p">,</span>
        <span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
            <span class="n">iterable</span> <span class="o">=</span> <span class="n">PythonRange</span><span class="p">(</span><span class="n">PythonLen</span><span class="p">(</span><span class="n">iterable</span><span class="p">))</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">iterable</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

    <span class="c1"># TODO uncomment later when we intriduce iterators</span>
    <span class="c1"># @property</span>
    <span class="c1"># def target(self):</span>
    <span class="c1">#    ts = super(ForIterator, self).target</span>

    <span class="c1">#    if not(len(ts) == self.depth):</span>
    <span class="c1">#        raise ValueError(&#39;wrong number of targets&#39;)</span>

    <span class="c1">#    return ts</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">it</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeRange</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">1</span>

            <span class="n">cls_base</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">cls_base</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cls_base</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;cls_base undefined&#39;</span><span class="p">)</span>

            <span class="n">methods</span> <span class="o">=</span> <span class="n">cls_base</span><span class="o">.</span><span class="n">methods_as_dict</span>
            <span class="n">it_method</span> <span class="o">=</span> <span class="n">methods</span><span class="p">[</span><span class="s1">&#39;__iter__&#39;</span><span class="p">]</span>

            <span class="n">it_vars</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">stmt</span> <span class="ow">in</span> <span class="n">it_method</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">Assign</span><span class="p">):</span>
                    <span class="n">it_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>

            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">it_vars</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="k">return</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ranges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">get_iterable_ranges</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterable</span><span class="p">)</span></div>

<div class="viewcode-block" id="ConstructorCall"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.ConstructorCall">[docs]</a><span class="k">class</span> <span class="nc">ConstructorCall</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It  serves as a constructor for undefined function classes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    func: FunctionDef, str</span>
<span class="sd">        an instance of FunctionDef or function name</span>

<span class="sd">    arguments: list, tuple, None</span>
<span class="sd">        a list of arguments.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_cls_variable&#39;</span><span class="p">,</span> <span class="s1">&#39;_func&#39;</span><span class="p">,</span> <span class="s1">&#39;_arguments&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_func&#39;</span><span class="p">,</span> <span class="s1">&#39;_arguments&#39;</span><span class="p">)</span>

    <span class="n">is_commutative</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># TODO improve</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">func</span><span class="p">,</span>
        <span class="n">arguments</span><span class="p">,</span>
        <span class="n">cls_variable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">Interface</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting func to be a FunctionDef or str&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cls_variable</span> <span class="o">=</span> <span class="n">cls_variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_func</span> <span class="o">=</span> <span class="n">func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span> <span class="o">=</span> <span class="n">arguments</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">arguments</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">(</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cls_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cls_variable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">FunctionDef</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span></div>

<div class="viewcode-block" id="FunctionCallArgument"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.FunctionCallArgument">[docs]</a><span class="k">class</span> <span class="nc">FunctionCallArgument</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An argument passed in a function call</span>

<span class="sd">    Parameters</span>
<span class="sd">    ---------</span>
<span class="sd">    value   : PyccelAstNode</span>
<span class="sd">              The expression passed as an argument</span>
<span class="sd">    keyword : str</span>
<span class="sd">              If the argument is passed by keyword then this</span>
<span class="sd">              is that keyword</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_value&#39;</span><span class="p">,</span> <span class="s1">&#39;_keyword&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_value&#39;</span><span class="p">,)</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">keyword</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_keyword</span> <span class="o">=</span> <span class="n">keyword</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The value passed as argument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">keyword</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The keyword used to pass the argument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keyword</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_keyword</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates whether the argument was passed by keyword</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keyword</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_keyword</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;FunctionCallArgument(</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyword</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;FunctionCallArgument(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_keyword</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyword</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span></div>

<div class="viewcode-block" id="FunctionDefArgument"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.FunctionDefArgument">[docs]</a><span class="k">class</span> <span class="nc">FunctionDefArgument</span><span class="p">(</span><span class="n">PyccelAstNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A FunctionDef FunctionDefArgument</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import FunctionDefArgument</span>
<span class="sd">    &gt;&gt;&gt; n = FunctionDefArgument(&#39;n&#39;)</span>
<span class="sd">    &gt;&gt;&gt; n</span>
<span class="sd">    n</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span><span class="s1">&#39;_var&#39;</span><span class="p">,</span><span class="s1">&#39;_kwonly&#39;</span><span class="p">,</span><span class="s1">&#39;_annotation&#39;</span><span class="p">,</span><span class="s1">&#39;_value&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_value&#39;</span><span class="p">,</span><span class="s1">&#39;_var&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">kwonly</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">annotation</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">Variable</span><span class="p">,</span> <span class="n">FunctionAddress</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_var</span>  <span class="o">=</span> <span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">name</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">PyccelSymbol</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_var</span>  <span class="o">=</span> <span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Name must be a PyccelSymbol, Variable or FunctionAddress&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>      <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_kwonly</span>     <span class="o">=</span> <span class="n">kwonly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_annotation</span> <span class="o">=</span> <span class="n">annotation</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The name of the argument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">var</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The variable representing the argument</span>
<span class="sd">        (available after the semantic treatment)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_kwonly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates if the argument must be passed</span>
<span class="sd">        by keyword</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kwonly</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">annotation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The argument annotation providing dtype information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_annotation</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The default value of the argument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">default_call_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The FunctionCallArgument which is passed to FunctionCall</span>
<span class="sd">        if no value is provided for this argument</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionCallArgument</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">keyword</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> \
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_default</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates whether the argument has a default value</span>
<span class="sd">        (if not then it must be provided)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_default</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">=</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_default</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;FunctionDefArgument(</span><span class="si">{0}</span><span class="s1">=</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;FunctionDefArgument(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span></div>

<div class="viewcode-block" id="FunctionCall"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.FunctionCall">[docs]</a><span class="k">class</span> <span class="nc">FunctionCall</span><span class="p">(</span><span class="n">PyccelAstNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a function call in the code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_arguments&#39;</span><span class="p">,</span><span class="s1">&#39;_funcdef&#39;</span><span class="p">,</span><span class="s1">&#39;_interface&#39;</span><span class="p">,</span><span class="s1">&#39;_func_name&#39;</span><span class="p">,</span><span class="s1">&#39;_interface_name&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_precision&#39;</span><span class="p">,</span><span class="s1">&#39;_shape&#39;</span><span class="p">,</span><span class="s1">&#39;_rank&#39;</span><span class="p">,</span><span class="s1">&#39;_order&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_arguments&#39;</span><span class="p">,</span><span class="s1">&#39;_funcdef&#39;</span><span class="p">,</span><span class="s1">&#39;_interface&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">current_function</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="c1"># Ensure all arguments are of type FunctionCallArgument</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">FunctionCallArgument</span><span class="p">)</span> <span class="k">else</span> <span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">pyccel_stage</span> <span class="o">==</span> <span class="s2">&quot;syntactic&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interface</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_funcdef</span>   <span class="o">=</span> <span class="n">func</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_func_name</span> <span class="o">=</span> <span class="n">func</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># ...</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">Interface</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;&gt; expecting a FunctionDef or an Interface&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">Interface</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interface</span> <span class="o">=</span> <span class="n">func</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interface_name</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">name</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interface</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">name</span>
        <span class="c1"># ...</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">current_function</span><span class="p">,</span> <span class="n">DottedName</span><span class="p">):</span>
            <span class="n">current_function</span> <span class="o">=</span> <span class="n">current_function</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">current_function</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">func</span><span class="o">.</span><span class="n">set_recursive</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;args must be a list or tuple&#39;</span><span class="p">)</span>

        <span class="c1"># add the missing argument in the case of optional arguments</span>
        <span class="n">f_args</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">arguments</span>
        <span class="k">if</span> <span class="n">func</span><span class="o">.</span><span class="n">cls_name</span><span class="p">:</span>
            <span class="n">f_args</span> <span class="o">=</span> <span class="n">f_args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">f_args</span><span class="p">):</span>
            <span class="c1"># Collect dict of keywords and values (initialised as default)</span>
            <span class="n">f_args_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">has_default</span> \
                    <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">f_args</span><span class="p">}</span>
            <span class="n">keyword_args</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">keyword</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Replace default positional arguments with provided arguments</span>
                    <span class="n">f_args_dict</span><span class="p">[</span><span class="n">f_args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">keyword_args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
                    <span class="k">break</span>

            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">keyword_args</span><span class="p">:</span>
                <span class="c1"># Replace default arguments with provided keyword arguments</span>
                <span class="n">f_args_dict</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">keyword</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>

            <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">keyword</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">f_args_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>

        <span class="c1"># Handle function as argument</span>
        <span class="n">arg_vals</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">FunctionAddress</span><span class="p">(</span><span class="n">av</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">av</span><span class="o">.</span><span class="n">arguments</span><span class="p">,</span> <span class="n">av</span><span class="o">.</span><span class="n">results</span><span class="p">,</span> <span class="p">[]),</span> <span class="n">keyword</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">keyword</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">av</span><span class="p">,</span> <span class="n">FunctionDef</span><span class="p">)</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">av</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">arg_vals</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">current_function</span> <span class="o">==</span> <span class="n">func</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">PyccelAstNode</span><span class="p">):</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">RECURSIVE_RESULTS_REQUIRED</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;fatal&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_funcdef</span>       <span class="o">=</span> <span class="n">func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span>     <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>         <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">NativeTuple</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rank</span>          <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span>      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span>         <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision</span>     <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">precision</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order</span>         <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">order</span>     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_func_name</span>     <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">name</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of FunctionCallArguments provided to the function call</span>
<span class="sd">        (contains default values after semantic stage)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">funcdef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The function called by this function call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_funcdef</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">interface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The interface called by this function call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interface</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">func_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The name of the function called by this function call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">interface_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The name of the interface called by this function call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interface_name</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func_name</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">))</span>

<div class="viewcode-block" id="FunctionCall._ignore"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.FunctionCall._ignore">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_ignore</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates if a node should be ignored when recursing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">c</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="o">*</span><span class="bp">cls</span><span class="o">.</span><span class="n">_ignored_types</span><span class="p">))</span></div></div>

<span class="k">class</span> <span class="nc">DottedFunctionCall</span><span class="p">(</span><span class="n">FunctionCall</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a function call in the code where</span>
<span class="sd">    the function is defined in another object</span>
<span class="sd">    (e.g. module/class)</span>

<span class="sd">    a.f()</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    func             : FunctionDef</span>
<span class="sd">                       The definition of the function being called</span>
<span class="sd">    args             : tuple</span>
<span class="sd">                       The arguments being passed to the function</span>
<span class="sd">    prefix           : PyccelAstNode</span>
<span class="sd">                       The object in which the function is defined</span>
<span class="sd">                       E.g. for a.f()</span>
<span class="sd">                       prefix will contain a</span>
<span class="sd">    current_function : str</span>
<span class="sd">                        The function from which this call occurs</span>
<span class="sd">                        (This is required in order to recognise</span>
<span class="sd">                        recursive functions)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_prefix&#39;</span><span class="p">,)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">FunctionCall</span><span class="o">.</span><span class="n">_attribute_nodes</span><span class="p">,</span> <span class="s1">&#39;_prefix&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">current_function</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span> <span class="o">=</span> <span class="n">prefix</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">current_function</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_func_name</span> <span class="o">=</span> <span class="n">DottedName</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interface</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interface_name</span> <span class="o">=</span> <span class="n">DottedName</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interface_name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The object in which the function is defined</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span>

<div class="viewcode-block" id="Return"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Return">[docs]</a><span class="k">class</span> <span class="nc">Return</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a function return in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    expr : PyccelAstNode</span>
<span class="sd">        The expression to return.</span>

<span class="sd">    stmts :represent assign stmts in the case of expression return</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_expr&#39;</span><span class="p">,</span> <span class="s1">&#39;_stmt&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_expr&#39;</span><span class="p">,</span> <span class="s1">&#39;_stmt&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">stmt</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">stmt</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">CodeBlock</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;stmt should only be of type CodeBlock&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span> <span class="o">=</span> <span class="n">expr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stmt</span> <span class="o">=</span> <span class="n">stmt</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stmt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stmt</span>

    <span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;used for Pickling self.&quot;&quot;&quot;</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stmt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">args</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stmt</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stmt</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">code</span><span class="o">+</span><span class="s2">&quot;Return(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FunctionDef"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.FunctionDef">[docs]</a><span class="k">class</span> <span class="nc">FunctionDef</span><span class="p">(</span><span class="n">ScopedNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a function definition.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the function.</span>

<span class="sd">    arguments : iterable</span>
<span class="sd">        The arguments to the function.</span>

<span class="sd">    results : iterable</span>
<span class="sd">        The direct outputs of the function.</span>

<span class="sd">    body : iterable</span>
<span class="sd">        The body of the function.</span>

<span class="sd">    global_vars : list of Symbols</span>
<span class="sd">        Variables which will not be passed into the function.</span>

<span class="sd">    cls_name: str</span>
<span class="sd">        Class name if the function is a method of cls_name</span>

<span class="sd">    is_static: bool</span>
<span class="sd">        True for static functions. Needed for iso_c_binding interface</span>

<span class="sd">    imports: list, tuple</span>
<span class="sd">        a list of needed imports</span>

<span class="sd">    decorators: list, tuple</span>
<span class="sd">        a list of properties</span>

<span class="sd">    headers: list,tuple</span>
<span class="sd">        a list of headers describing the function</span>

<span class="sd">    is_recursive: bool</span>
<span class="sd">        True for a function which calls itself</span>

<span class="sd">    is_pure: bool</span>
<span class="sd">        True for a function without side effect</span>

<span class="sd">    is_elemental: bool</span>
<span class="sd">        True for a function that is elemental</span>

<span class="sd">    is_private: bool</span>
<span class="sd">        True for a function that is private</span>

<span class="sd">    is_header: bool</span>
<span class="sd">        True for a function which has no body available</span>

<span class="sd">    is_external: bool</span>
<span class="sd">        True for a function which cannot be explicitly imported or renamed</span>

<span class="sd">    arguments_inout: list, tuple</span>
<span class="sd">        a list of booleans indicating if each argument is modified by the function</span>

<span class="sd">    functions: list, tuple</span>
<span class="sd">        a list of functions defined within this function</span>

<span class="sd">    interfaces: list, tuple</span>
<span class="sd">        a list of interfaces defined within this function</span>

<span class="sd">    doc_string: str</span>
<span class="sd">        The doc string of the function</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Assign, Variable, FunctionDef</span>
<span class="sd">    &gt;&gt;&gt; x = Variable(&#39;float&#39;, &#39;x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; y = Variable(&#39;float&#39;, &#39;y&#39;)</span>
<span class="sd">    &gt;&gt;&gt; args        = [x]</span>
<span class="sd">    &gt;&gt;&gt; results     = [y]</span>
<span class="sd">    &gt;&gt;&gt; body        = [Assign(y,x+1)]</span>
<span class="sd">    &gt;&gt;&gt; FunctionDef(&#39;incr&#39;, args, results, body)</span>
<span class="sd">    FunctionDef(incr, (x,), (y,), [y := 1 + x], [], [], None, False, function)</span>

<span class="sd">    One can also use parametrized argument, using FunctionDefArgument</span>

<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Variable</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Assign</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import FunctionDef</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import FunctionDefArgument</span>
<span class="sd">    &gt;&gt;&gt; n = FunctionDefArgument(&#39;n&#39;, value=4)</span>
<span class="sd">    &gt;&gt;&gt; x = Variable(&#39;float&#39;, &#39;x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; y = Variable(&#39;float&#39;, &#39;y&#39;)</span>
<span class="sd">    &gt;&gt;&gt; args        = [x, n]</span>
<span class="sd">    &gt;&gt;&gt; results     = [y]</span>
<span class="sd">    &gt;&gt;&gt; body        = [Assign(y,x+n)]</span>
<span class="sd">    &gt;&gt;&gt; FunctionDef(&#39;incr&#39;, args, results, body)</span>
<span class="sd">    FunctionDef(incr, (x, n=4), (y,), [y := 1 + x], [], [], None, False, function, [])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span><span class="s1">&#39;_arguments&#39;</span><span class="p">,</span><span class="s1">&#39;_results&#39;</span><span class="p">,</span><span class="s1">&#39;_body&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_global_vars&#39;</span><span class="p">,</span><span class="s1">&#39;_cls_name&#39;</span><span class="p">,</span><span class="s1">&#39;_is_static&#39;</span><span class="p">,</span><span class="s1">&#39;_imports&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_decorators&#39;</span><span class="p">,</span><span class="s1">&#39;_headers&#39;</span><span class="p">,</span><span class="s1">&#39;_is_recursive&#39;</span><span class="p">,</span><span class="s1">&#39;_is_pure&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_is_elemental&#39;</span><span class="p">,</span><span class="s1">&#39;_is_private&#39;</span><span class="p">,</span><span class="s1">&#39;_is_header&#39;</span><span class="p">,</span><span class="s1">&#39;_arguments_inout&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_functions&#39;</span><span class="p">,</span><span class="s1">&#39;_interfaces&#39;</span><span class="p">,</span><span class="s1">&#39;_doc_string&#39;</span><span class="p">,</span> <span class="s1">&#39;_is_external&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_arguments&#39;</span><span class="p">,</span><span class="s1">&#39;_results&#39;</span><span class="p">,</span><span class="s1">&#39;_body&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_global_vars&#39;</span><span class="p">,</span><span class="s1">&#39;_imports&#39;</span><span class="p">,</span><span class="s1">&#39;_functions&#39;</span><span class="p">,</span><span class="s1">&#39;_interfaces&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">arguments</span><span class="p">,</span>
        <span class="n">results</span><span class="p">,</span>
        <span class="n">body</span><span class="p">,</span>
        <span class="n">global_vars</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">cls_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">is_static</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">imports</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">decorators</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">headers</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">is_recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_pure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_elemental</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_external</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">arguments_inout</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">functions</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">interfaces</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">doc_string</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">PyccelSymbol</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">name_</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">name_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyccelSymbol</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Function name must be PyccelSymbol or string&#39;</span>
                                    <span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">name_</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Function name must be PyccelSymbol or string&#39;</span><span class="p">)</span>

        <span class="c1"># arguments</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">arguments</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;arguments must be an iterable&#39;</span><span class="p">)</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">a</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">FunctionDefArgument</span><span class="p">)</span> <span class="k">else</span> <span class="n">FunctionDefArgument</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">)</span>

        <span class="c1"># body</span>

        <span class="k">if</span> <span class="n">iterable</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">CodeBlock</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span><span class="n">CodeBlock</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;body must be an iterable or a CodeBlock&#39;</span><span class="p">)</span>

<span class="c1">#        body = tuple(i for i in body)</span>
        <span class="c1"># results</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;results must be an iterable&#39;</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

        <span class="c1"># if method</span>

        <span class="k">if</span> <span class="n">cls_name</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cls_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;cls_name must be a string&#39;</span><span class="p">)</span>

            <span class="c1"># if not cls_variable:</span>
             <span class="c1">#   raise TypeError(&#39;Expecting a instance of {0}&#39;.format(cls_name))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_static</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for is_static attribute&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">imports</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;imports must be an iterable&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">decorators</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;decorators must be a dict&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_pure</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for pure&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_elemental</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for elemental&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_private</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for private&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_header</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for header&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_external</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for external&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">is_external</span> <span class="o">=</span> <span class="n">is_external</span> <span class="ow">and</span> <span class="n">is_header</span> <span class="ow">and</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>

        <span class="k">if</span> <span class="n">arguments_inout</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments_inout</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a list or tuple &#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arguments_inout</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Expecting booleans&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">arg_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">var</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">]</span>
            <span class="n">arguments_inout</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">a</span><span class="o">.</span><span class="n">is_const</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arg_vars</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">functions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">FunctionDef</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a FunctionDef&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>            <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span>       <span class="o">=</span> <span class="n">arguments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span>         <span class="o">=</span> <span class="n">results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_body</span>            <span class="o">=</span> <span class="n">body</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_vars</span>     <span class="o">=</span> <span class="n">global_vars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cls_name</span>        <span class="o">=</span> <span class="n">cls_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_static</span>       <span class="o">=</span> <span class="n">is_static</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imports</span>         <span class="o">=</span> <span class="n">imports</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_decorators</span>      <span class="o">=</span> <span class="n">decorators</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span>         <span class="o">=</span> <span class="n">headers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_recursive</span>    <span class="o">=</span> <span class="n">is_recursive</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_pure</span>         <span class="o">=</span> <span class="n">is_pure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_elemental</span>    <span class="o">=</span> <span class="n">is_elemental</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_private</span>      <span class="o">=</span> <span class="n">is_private</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_header</span>       <span class="o">=</span> <span class="n">is_header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_external</span>     <span class="o">=</span> <span class="n">is_external</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arguments_inout</span> <span class="o">=</span> <span class="n">arguments_inout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_functions</span>       <span class="o">=</span> <span class="n">functions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interfaces</span>      <span class="o">=</span> <span class="n">interfaces</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_doc_string</span>      <span class="o">=</span> <span class="n">doc_string</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Name of the function &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of variables which are the function arguments &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of variables which are the function results &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; CodeBlock containing all the statements in the function &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_body</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">local_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of variables defined in the function &quot;&quot;&quot;</span>
        <span class="n">local_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="n">argument_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">var</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arguments</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">local_vars</span> <span class="k">if</span> <span class="n">l</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="ow">and</span> <span class="n">l</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">argument_vars</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">global_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of global variables used in the function &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_vars</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cls_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; String containing the name of the class to which the method belongs.</span>
<span class="sd">        If the function is not a class procedure then this returns None &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cls_name</span>

    <span class="nd">@cls_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cls_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cls_name</span> <span class="o">=</span> <span class="n">cls_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">imports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of imports in the function &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imports</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">decorators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of decorators applied to the function &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decorators</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of headers applied to the function &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">templates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of templates used to determine the types &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_templates</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_recursive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns True if the function is recursive (i.e. calls itself)</span>
<span class="sd">        and False otherwise &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_recursive</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_pure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns True if the function is marked as pure and False otherwise</span>
<span class="sd">        Pure functions must not have any side effects.</span>
<span class="sd">        In other words this means that the result must be the same no matter</span>
<span class="sd">        how many times the function is called</span>
<span class="sd">        e.g:</span>
<span class="sd">        &gt;&gt;&gt; a = f()</span>
<span class="sd">        &gt;&gt;&gt; a = f()</span>

<span class="sd">        gives the same result as</span>
<span class="sd">        &gt;&gt;&gt; a = f()</span>

<span class="sd">        This is notably not true for I/O functions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_pure</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_elemental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; returns True if the function is marked as elemental and</span>
<span class="sd">        False otherwise</span>
<span class="sd">        An elemental function is a function with a single scalar operator</span>
<span class="sd">        and a scalar return value which can also be called on an array.</span>
<span class="sd">        When it is called on an array it returns the result of the function</span>
<span class="sd">        called elementwise on the array &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_elemental</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_private</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; True if the function should not be exposed to</span>
<span class="sd">        other modules. This includes the wrapper module and</span>
<span class="sd">        means that the function cannot be used in an import</span>
<span class="sd">        or exposed to python &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_private</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; True if the implementation of the function body</span>
<span class="sd">        is not provided False otherwise &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_header</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_external</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; True if the function is exposed through a header file and coming</span>
<span class="sd">        from a f77 module &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_external</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_inline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; True if the function should be printed inline &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arguments_inout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of variables which are the modifiable function arguments &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arguments_inout</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">functions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of functions within this function &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_functions</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">interfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of interfaces within this function &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interfaces</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">doc_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The docstring of the function &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doc_string</span>

<div class="viewcode-block" id="FunctionDef.set_recursive"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.FunctionDef.set_recursive">[docs]</a>    <span class="k">def</span> <span class="nf">set_recursive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Mark the function as a recursive function &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_recursive</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="FunctionDef.clone"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.FunctionDef.clone">[docs]</a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an identical FunctionDef with name</span>
<span class="sd">        newname.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        newname: str</span>
<span class="sd">            new name for the FunctionDef</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">()</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">new_func</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">new_func</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">newname</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_func</span></div>


<div class="viewcode-block" id="FunctionDef.rename"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.FunctionDef.rename">[docs]</a>    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rename the FunctionDef name</span>
<span class="sd">        newname.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        newname: str</span>
<span class="sd">            new name for the FunctionDef</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">newname</span></div>

    <span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">          This method returns the positional and keyword arguments</span>
<span class="sd">            used to create an instance of this class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arguments</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_body</span><span class="p">)</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;global_vars&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_global_vars</span><span class="p">,</span>
        <span class="s1">&#39;cls_name&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_cls_name</span><span class="p">,</span>
        <span class="s1">&#39;is_static&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_static</span><span class="p">,</span>
        <span class="s1">&#39;imports&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_imports</span><span class="p">,</span>
        <span class="s1">&#39;decorators&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_decorators</span><span class="p">,</span>
        <span class="s1">&#39;headers&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_headers</span><span class="p">,</span>
        <span class="s1">&#39;is_recursive&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_recursive</span><span class="p">,</span>
        <span class="s1">&#39;is_pure&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_pure</span><span class="p">,</span>
        <span class="s1">&#39;is_elemental&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_elemental</span><span class="p">,</span>
        <span class="s1">&#39;is_private&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_private</span><span class="p">,</span>
        <span class="s1">&#39;is_header&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_header</span><span class="p">,</span>
        <span class="s1">&#39;arguments_inout&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_arguments_inout</span><span class="p">,</span>
        <span class="s1">&#39;functions&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_functions</span><span class="p">,</span>
        <span class="s1">&#39;is_external&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_external</span><span class="p">,</span>
        <span class="s1">&#39;interfaces&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_interfaces</span><span class="p">,</span>
        <span class="s1">&#39;doc_string&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_doc_string</span><span class="p">,</span>
        <span class="s1">&#39;scope&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_scope</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>

    <span class="k">def</span> <span class="nf">__reduce_ex__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Used by pickle to create an object of this class.</span>

<span class="sd">          Parameters</span>
<span class="sd">          ----------</span>

<span class="sd">          i : int</span>
<span class="sd">           protocol</span>

<span class="sd">          Results</span>
<span class="sd">          -------</span>

<span class="sd">          out : tuple</span>
<span class="sd">           A tuple of two elements</span>
<span class="sd">           a callable function that can be called</span>
<span class="sd">           to create the initial version of the object</span>
<span class="sd">           and its arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">apply</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">out</span>


    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> \
                    <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{name}</span><span class="s1">(</span><span class="si">{args}</span><span class="s1">) -&gt; </span><span class="si">{result}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">name</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">args</span>   <span class="o">=</span> <span class="n">args</span><span class="p">,</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_unused</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="InlineFunctionDef"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.InlineFunctionDef">[docs]</a><span class="k">class</span> <span class="nc">InlineFunctionDef</span><span class="p">(</span><span class="n">FunctionDef</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a function definition for an inline function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    See FunctionDef</span>

<span class="sd">    namespace_imports : Scope</span>
<span class="sd">                        The objects in the scope which are available due to imports</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_namespace_imports&#39;</span><span class="p">,</span><span class="s1">&#39;_orig_args&#39;</span><span class="p">,</span><span class="s1">&#39;_new_args&#39;</span><span class="p">,</span><span class="s1">&#39;_new_local_vars&#39;</span><span class="p">,</span> <span class="s1">&#39;_if_block_replacements&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_global_funcs&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">namespace_imports</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">global_funcs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_namespace_imports</span> <span class="o">=</span> <span class="n">namespace_imports</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_funcs</span> <span class="o">=</span> <span class="n">global_funcs</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orig_args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">var</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_new_args</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_new_local_vars</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_if_block_replacements</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_inline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; True if the function should be printed inline &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">namespace_imports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The objects in the scope which are available due to imports</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namespace_imports</span>

<div class="viewcode-block" id="InlineFunctionDef.swap_in_args"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.InlineFunctionDef.swap_in_args">[docs]</a>    <span class="k">def</span> <span class="nf">swap_in_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">new_local_vars</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Modify the body of the function by replacing the arguments</span>
<span class="sd">        and local variables with the provided arguments and local variables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_args</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_local_vars</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="c1"># Collect the function arguments and the expressions they will be replaced with</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_new_local_vars</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_local_vars</span><span class="p">)</span>

        <span class="c1"># We cannot replace with singletons as this cannot be reversed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_new_args</span>  <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">NilArgument</span><span class="p">()</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="n">Nil</span><span class="p">()</span> <span class="k">else</span> \
                        <span class="n">PyccelAssociativeParenthesis</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">PyccelOperator</span><span class="p">)</span> \
                        <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>

        <span class="c1"># Replace the arguments in the code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orig_args</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">local_vars</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_args</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_new_local_vars</span><span class="p">,</span> <span class="n">invalidate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="InlineFunctionDef.swap_out_args"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.InlineFunctionDef.swap_out_args">[docs]</a>    <span class="k">def</span> <span class="nf">swap_out_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Modify the body of the function by reinstating the original arguments and local variables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_new_args</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_new_local_vars</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orig_args</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">local_vars</span><span class="p">,</span> <span class="n">invalidate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_new_args</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_new_local_vars</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="InlineFunctionDef.remove_presence_checks"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.InlineFunctionDef.remove_presence_checks">[docs]</a>    <span class="k">def</span> <span class="nf">remove_presence_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Modify the body by replacing all expressions checking for the presence of an optional</span>
<span class="sd">        variable. Either the If is removed or the check is replaced with its literal result</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_if_block_replacements</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="c1"># Look for if blocks and replace present(x) statements</span>
        <span class="n">if_blocks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">get_attribute_nodes</span><span class="p">(</span><span class="n">If</span><span class="p">,</span> <span class="n">excluded_nodes</span><span class="o">=</span><span class="p">(</span><span class="n">FunctionDef</span><span class="p">,))</span>
        <span class="n">if_block_replacements</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[]]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">if_blocks</span><span class="p">:</span>
            <span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">c</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">blocks</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">PyccelIs</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">LiteralTrue</span><span class="p">(),</span> <span class="n">e</span><span class="p">))</span>
                        <span class="k">break</span>
                    <span class="k">elif</span> <span class="n">c</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                        <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">presence_checks</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_attribute_nodes</span><span class="p">(</span><span class="n">PyccelIs</span><span class="p">,</span> <span class="n">excluded_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="n">FunctionDef</span><span class="p">,))</span>
                    <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">presence_checks</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">pi</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                            <span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
                            <span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LiteralTrue</span><span class="p">())</span>
                        <span class="k">elif</span> <span class="n">pi</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                            <span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
                            <span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LiteralFalse</span><span class="p">())</span>
                <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EmptyNode</span><span class="p">())</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">LiteralTrue</span><span class="p">):</span>
                <span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">blocks</span><span class="p">):</span>
                <span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">If</span><span class="p">(</span><span class="o">*</span><span class="n">blocks</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_if_block_replacements</span> <span class="o">=</span> <span class="n">if_block_replacements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">if_block_replacements</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">invalidate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="InlineFunctionDef.reinstate_presence_checks"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.InlineFunctionDef.reinstate_presence_checks">[docs]</a>    <span class="k">def</span> <span class="nf">reinstate_presence_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Modify the body by reinstating all expressions checking for the presence of an optional</span>
<span class="sd">        variable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_if_block_replacements</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_if_block_replacements</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_if_block_replacements</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">global_funcs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; List of global functions used in the function &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_funcs</span></div>

<span class="k">class</span> <span class="nc">PyccelFunctionDef</span><span class="p">(</span><span class="n">FunctionDef</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class inheriting from FunctionDef which can store a pointer</span>
<span class="sd">    to a class type defined by pyccel for treating internal functions.</span>
<span class="sd">    This is useful for importing builtin functions</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">           The name of the function</span>
<span class="sd">    func_class : type inheriting from PyccelInternalFunction / PyccelAstNode</span>
<span class="sd">                 The class which should be instantiated upon a FunctionCall</span>
<span class="sd">                 to this FunctionDef object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">func_class</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func_class</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="nb">issubclass</span><span class="p">(</span><span class="n">func_class</span><span class="p">,</span> <span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">,</span> <span class="n">PyccelAstNode</span><span class="p">))</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">body</span> <span class="o">=</span> <span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cls_name</span> <span class="o">=</span> <span class="n">func_class</span>

<div class="viewcode-block" id="Interface"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Interface">[docs]</a><span class="k">class</span> <span class="nc">Interface</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents an Interface.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the interface.</span>

<span class="sd">    functions : iterable</span>
<span class="sd">        The functions of the interface.</span>

<span class="sd">    is_argument: bool</span>
<span class="sd">        True if the interface is used for a function argument.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Interface, FunctionDef</span>
<span class="sd">    &gt;&gt;&gt; f = FunctionDef(&#39;F&#39;, [], [], [])</span>
<span class="sd">    &gt;&gt;&gt; Interface(&#39;I&#39;, [f])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span><span class="s1">&#39;_functions&#39;</span><span class="p">,</span><span class="s1">&#39;_is_argument&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_functions&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">functions</span><span class="p">,</span>
        <span class="n">is_argument</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting an str&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">functions</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a list&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_functions</span> <span class="o">=</span> <span class="n">functions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_argument</span> <span class="o">=</span> <span class="n">is_argument</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Name of the interface.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">functions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;&quot;Functions of the interface.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_functions</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_argument</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;True if the interface is used for a function argument.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_argument</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">doc_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_functions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">doc_string</span>

<div class="viewcode-block" id="Interface.point"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Interface.point">[docs]</a>    <span class="k">def</span> <span class="nf">point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">use_final_precision</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the actual function that will be called, depending on the passed arguments.&quot;&quot;&quot;</span>
        <span class="n">fs_args</span> <span class="o">=</span> <span class="p">[[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">arguments</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_functions</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">use_final_precision</span><span class="p">:</span>
            <span class="n">type_match</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">dtype1</span><span class="p">,</span> <span class="n">dtype2</span><span class="p">,</span> <span class="n">call_arg</span><span class="p">,</span> <span class="n">func_arg</span><span class="p">:</span> \
                    <span class="p">(</span><span class="n">dtype1</span> <span class="ow">in</span> <span class="n">dtype2</span> <span class="ow">or</span> <span class="n">dtype2</span> <span class="ow">in</span> <span class="n">dtype1</span><span class="p">)</span> \
                    <span class="ow">and</span> <span class="p">(</span><span class="n">call_arg</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="n">func_arg</span><span class="o">.</span><span class="n">rank</span><span class="p">)</span> \
                    <span class="ow">and</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">call_arg</span><span class="p">)</span> <span class="o">==</span> \
                        <span class="n">get_final_precision</span><span class="p">(</span><span class="n">func_arg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">type_match</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">dtype1</span><span class="p">,</span> <span class="n">dtype2</span><span class="p">,</span> <span class="n">call_arg</span><span class="p">,</span> <span class="n">func_arg</span><span class="p">:</span> \
                    <span class="p">(</span><span class="n">dtype1</span> <span class="ow">in</span> <span class="n">dtype2</span> <span class="ow">or</span> <span class="n">dtype2</span> <span class="ow">in</span> <span class="n">dtype1</span><span class="p">)</span> \
                    <span class="ow">and</span> <span class="p">(</span><span class="n">call_arg</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="n">func_arg</span><span class="o">.</span><span class="n">rank</span><span class="p">)</span> \
                    <span class="ow">and</span> <span class="n">call_arg</span><span class="o">.</span><span class="n">precision</span> <span class="o">==</span> <span class="n">func_arg</span><span class="o">.</span><span class="n">precision</span>


        <span class="n">j</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fs_args</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
                <span class="n">func_arg</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">var</span>
                <span class="n">call_arg</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">value</span>
                <span class="n">dtype1</span> <span class="o">=</span> <span class="n">str_dtype</span><span class="p">(</span><span class="n">call_arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                <span class="n">dtype2</span> <span class="o">=</span> <span class="n">str_dtype</span><span class="p">(</span><span class="n">func_arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="n">found</span> <span class="ow">and</span> <span class="n">type_match</span><span class="p">(</span><span class="n">dtype1</span><span class="p">,</span> <span class="n">dtype2</span><span class="p">,</span> <span class="n">call_arg</span><span class="p">,</span> <span class="n">func_arg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
            <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_functions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s1">&#39;Arguments types provided to </span><span class="si">{}</span><span class="s1"> are incompatible&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span></div></div>

<span class="k">class</span> <span class="nc">FunctionAddress</span><span class="p">(</span><span class="n">FunctionDef</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a function address.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the function address.</span>

<span class="sd">    arguments : iterable</span>
<span class="sd">        The arguments to the function address.</span>

<span class="sd">    results : iterable</span>
<span class="sd">        The direct outputs of the function address.</span>

<span class="sd">    is_argument: bool</span>
<span class="sd">        if object is the argument of a function [Default value: False]</span>

<span class="sd">    is_kwonly: bool</span>
<span class="sd">        if object is an argument which can only be specified using its keyword</span>

<span class="sd">    is_optional: bool</span>
<span class="sd">        if object is an optional argument of a function [Default value: False]</span>

<span class="sd">    memory_handling: str</span>
<span class="sd">        must be &#39;heap&#39;, &#39;stack&#39; or &#39;alias&#39; [Default value: &#39;stack&#39;]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Variable, FunctionAddress, FuncAddressDeclare, FunctionDef</span>
<span class="sd">    &gt;&gt;&gt; x = Variable(&#39;float&#39;, &#39;x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; y = Variable(&#39;float&#39;, &#39;y&#39;)</span>

<span class="sd">    a function definition can have a FunctionAddress as an argument</span>

<span class="sd">    &gt;&gt;&gt; FunctionDef(&#39;g&#39;, [FunctionAddress(&#39;f&#39;, [x], [y], [])], [], [])</span>

<span class="sd">    we can also Declare a FunctionAddress</span>

<span class="sd">    &gt;&gt;&gt; FuncAddressDeclare(FunctionAddress(&#39;f&#39;, [x], [y], []))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_is_optional&#39;</span><span class="p">,</span><span class="s1">&#39;_is_kwonly&#39;</span><span class="p">,</span><span class="s1">&#39;_is_argument&#39;</span><span class="p">,</span> <span class="s1">&#39;_memory_handling&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">arguments</span><span class="p">,</span>
        <span class="n">results</span><span class="p">,</span>
        <span class="n">body</span><span class="p">,</span>
        <span class="n">is_optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_kwonly</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">is_argument</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">memory_handling</span><span class="o">=</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_argument</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for is_argument&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">memory_handling</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;heap&#39;</span><span class="p">,</span> <span class="s1">&#39;alias&#39;</span><span class="p">,</span> <span class="s1">&#39;stack&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting </span><span class="se">\&#39;</span><span class="s1">heap</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">stack</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">alias</span><span class="se">\&#39;</span><span class="s1"> or None for memory_handling&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_kwonly</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for kwonly&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_optional</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;is_optional must be a boolean.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_optional</span>   <span class="o">=</span> <span class="n">is_optional</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_kwonly</span>     <span class="o">=</span> <span class="n">is_kwonly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_argument</span>   <span class="o">=</span> <span class="n">is_argument</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_memory_handling</span> <span class="o">=</span> <span class="n">memory_handling</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">memory_handling</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the memory handling of the instance of FunctionAddress</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_handling</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates if the instance of FunctionAddress is an alias</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_handling</span> <span class="o">==</span> <span class="s1">&#39;alias&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_argument</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_argument</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_kwonly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_kwonly</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_optional</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_optional</span>

<div class="viewcode-block" id="SympyFunction"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.SympyFunction">[docs]</a><span class="k">class</span> <span class="nc">SympyFunction</span><span class="p">(</span><span class="n">FunctionDef</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a function definition.&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span></div>



<div class="viewcode-block" id="ClassDef"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.ClassDef">[docs]</a><span class="k">class</span> <span class="nc">ClassDef</span><span class="p">(</span><span class="n">ScopedNode</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a class definition.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the class.</span>

<span class="sd">    attributes: iterable</span>
<span class="sd">        The attributes to the class.</span>

<span class="sd">    methods: iterable</span>
<span class="sd">        Class methods</span>

<span class="sd">    options: list, tuple</span>
<span class="sd">        list of options (&#39;public&#39;, &#39;private&#39;, &#39;abstract&#39;)</span>

<span class="sd">    imports: list, tuple</span>
<span class="sd">        list of needed imports</span>

<span class="sd">    superclass : str</span>
<span class="sd">        superclass&#39;s class name</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Variable, Assign</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import ClassDef, FunctionDef</span>
<span class="sd">    &gt;&gt;&gt; x = Variable(&#39;float&#39;, &#39;x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; y = Variable(&#39;float&#39;, &#39;y&#39;)</span>
<span class="sd">    &gt;&gt;&gt; z = Variable(&#39;float&#39;, &#39;z&#39;)</span>
<span class="sd">    &gt;&gt;&gt; t = Variable(&#39;float&#39;, &#39;t&#39;)</span>
<span class="sd">    &gt;&gt;&gt; a = Variable(&#39;float&#39;, &#39;a&#39;)</span>
<span class="sd">    &gt;&gt;&gt; b = Variable(&#39;float&#39;, &#39;b&#39;)</span>
<span class="sd">    &gt;&gt;&gt; body = [Assign(y,x+a)]</span>
<span class="sd">    &gt;&gt;&gt; translate = FunctionDef(&#39;translate&#39;, [x,y,a,b], [z,t], body)</span>
<span class="sd">    &gt;&gt;&gt; attributes   = [x,y]</span>
<span class="sd">    &gt;&gt;&gt; methods     = [translate]</span>
<span class="sd">    &gt;&gt;&gt; ClassDef(&#39;Point&#39;, attributes, methods)</span>
<span class="sd">    ClassDef(Point, (x, y), (FunctionDef(translate, (x, y, a, b), (z, t), [y := a + x], [], [], None, False, function),), [public])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span><span class="s1">&#39;_attributes&#39;</span><span class="p">,</span><span class="s1">&#39;_methods&#39;</span><span class="p">,</span><span class="s1">&#39;_options&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_imports&#39;</span><span class="p">,</span><span class="s1">&#39;_superclass&#39;</span><span class="p">,</span><span class="s1">&#39;_interfaces&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_attributes&#39;</span><span class="p">,</span> <span class="s1">&#39;_methods&#39;</span><span class="p">,</span> <span class="s1">&#39;_imports&#39;</span><span class="p">,</span> <span class="s1">&#39;_interfaces&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">attributes</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">methods</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">options</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;public&#39;</span><span class="p">,),</span>
        <span class="n">imports</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">superclass</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">interfaces</span><span class="o">=</span><span class="p">(),</span>
        <span class="n">scope</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">):</span>

        <span class="c1"># name</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">PyccelSymbol</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Function name must be PyccelSymbol or string&#39;</span><span class="p">)</span>

        <span class="c1"># attributes</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">attributes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;attributes must be an iterable&#39;</span><span class="p">)</span>
        <span class="n">attributes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">attributes</span><span class="p">)</span>

        <span class="c1"># methods</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">methods</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;methods must be an iterable&#39;</span><span class="p">)</span>

        <span class="c1"># options</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;options must be an iterable&#39;</span><span class="p">)</span>

        <span class="c1"># imports</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">imports</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;imports must be an iterable&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">superclass</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;superclass must be iterable&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">interfaces</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;interfaces must be iterable&#39;</span><span class="p">)</span>

        <span class="n">imports</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">imports</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
            <span class="n">imports</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">imports</span><span class="p">)</span>

        <span class="n">imports</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">imports</span><span class="p">)</span>  <span class="c1"># for unicity</span>
        <span class="n">imports</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">imports</span><span class="p">)</span>

        <span class="c1"># ...</span>
        <span class="c1"># look if the class has the method __del__</span>
        <span class="c1"># d_methods = {}</span>
        <span class="c1"># for i in methods:</span>
        <span class="c1">#    d_methods[str(i.name).replace(&#39;\&#39;&#39;,&#39;&#39;)] = i</span>
        <span class="c1"># if not (&#39;__del__&#39; in d_methods):</span>
        <span class="c1">#    dtype = DataTypeFactory(str(name), (&quot;_name&quot;), prefix=&#39;Custom&#39;)</span>
        <span class="c1">#    this  = Variable(dtype(), &#39;self&#39;)</span>

            <span class="c1"># constructs the __del__ method if not provided</span>
         <span class="c1">#   args = []</span>
         <span class="c1">#   for a in attributes:</span>
         <span class="c1">#       if isinstance(a, Variable):</span>
         <span class="c1">#           if a.allocatable:</span>
         <span class="c1">#              args.append(a)</span>

         <span class="c1">#   args = [Variable(a.dtype, DottedName(str(this), str(a.name))) for a in args]</span>
         <span class="c1">#   body = [Del(a) for a in args]</span>

         <span class="c1">#   free = FunctionDef(&#39;__del__&#39;, [this], [], \</span>
         <span class="c1">#                      body, local_vars=[], global_vars=[], \</span>
         <span class="c1">#                      cls_name=&#39;__UNDEFINED__&#39;, imports=[])</span>

         <span class="c1">#  methods = list(methods) + [free]</span>
         <span class="c1"># TODO move this somewhere else</span>

        <span class="n">methods</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span>

        <span class="c1"># ...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span> <span class="o">=</span> <span class="n">attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span> <span class="o">=</span> <span class="n">methods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="n">options</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imports</span> <span class="o">=</span> <span class="n">imports</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_superclass</span>  <span class="o">=</span> <span class="n">superclass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interfaces</span> <span class="o">=</span> <span class="n">interfaces</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">scope</span> <span class="o">=</span> <span class="n">scope</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_methods</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">imports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imports</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">superclass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_superclass</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">interfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interfaces</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">methods_as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary that contains all methods, where the key is the</span>
<span class="sd">        method&#39;s name.&quot;&quot;&quot;</span>

        <span class="n">d_methods</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">methods</span><span class="p">:</span>
            <span class="n">d_methods</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">return</span> <span class="n">d_methods</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">attributes_as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary that contains all attributes, where the key is the</span>
<span class="sd">        attribute&#39;s name.&quot;&quot;&quot;</span>

        <span class="n">d_attributes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
            <span class="n">d_attributes</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">return</span> <span class="n">d_attributes</span>

    <span class="c1"># TODO add other attributes?</span>


<div class="viewcode-block" id="ClassDef.get_attribute"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.ClassDef.get_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the attribute attr of the class O of instance self.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting attribute to be a string&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
            <span class="n">cls_name</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cls_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">O</span><span class="p">)</span>

        <span class="n">attributes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
            <span class="n">attributes</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> is not an attribute of </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span>
                             <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>

        <span class="n">var</span> <span class="o">=</span> <span class="n">attributes</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">DottedName</span><span class="p">(</span><span class="n">cls_name</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Variable</span><span class="p">(</span>
            <span class="n">var</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">rank</span><span class="o">=</span><span class="n">var</span><span class="o">.</span><span class="n">rank</span><span class="p">,</span>
            <span class="n">memory_handling</span><span class="o">=</span><span class="n">var</span><span class="o">.</span><span class="n">memory_handling</span><span class="p">,</span>
            <span class="n">shape</span><span class="o">=</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
            <span class="n">cls_base</span><span class="o">=</span><span class="n">var</span><span class="o">.</span><span class="n">cls_base</span><span class="p">,</span>
            <span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_iterable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if the class has an iterator.&quot;&quot;&quot;</span>

        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">methods</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;__next__&#39;</span> <span class="ow">in</span> <span class="n">names</span> <span class="ow">and</span> <span class="s1">&#39;__iter__&#39;</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="s1">&#39;__next__&#39;</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;ClassDef does not contain __iter__ method&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;__iter__&#39;</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;ClassDef does not contain __next__ method&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_with_construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if the class is a with construct.&quot;&quot;&quot;</span>

        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">methods</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;__enter__&#39;</span> <span class="ow">in</span> <span class="n">names</span> <span class="ow">and</span> <span class="s1">&#39;__exit__&#39;</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="s1">&#39;__enter__&#39;</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;ClassDef does not contain __exit__ method&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;__exit__&#39;</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;ClassDef does not contain __enter__ method&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;hide&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_iterable</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_with_construct</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_unused</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Import"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Import">[docs]</a><span class="k">class</span> <span class="nc">Import</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents inclusion of dependencies in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    source : str, DottedName, AsName</span>
<span class="sd">        the module from which we import</span>
<span class="sd">    target : str, AsName, list, tuple</span>
<span class="sd">        targets to import</span>
<span class="sd">    ignore_at_print : bool</span>
<span class="sd">        indicates whether the import should be printed</span>
<span class="sd">    mod : Module</span>
<span class="sd">        The module describing the source</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Import</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import DottedName</span>
<span class="sd">    &gt;&gt;&gt; Import(&#39;foo&#39;)</span>
<span class="sd">    import foo</span>

<span class="sd">    &gt;&gt;&gt; abc = DottedName(&#39;foo&#39;, &#39;bar&#39;, &#39;baz&#39;)</span>
<span class="sd">    &gt;&gt;&gt; Import(abc)</span>
<span class="sd">    import foo.bar.baz</span>

<span class="sd">    &gt;&gt;&gt; Import(&#39;foo&#39;, &#39;bar&#39;)</span>
<span class="sd">    from foo import bar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_source&#39;</span><span class="p">,</span><span class="s1">&#39;_target&#39;</span><span class="p">,</span><span class="s1">&#39;_ignore_at_print&#39;</span><span class="p">,</span><span class="s1">&#39;_source_mod&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ignore_at_print</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">mod</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">Import</span><span class="o">.</span><span class="n">_format</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_source_mod</span>      <span class="o">=</span> <span class="n">mod</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ignore_at_print</span> <span class="o">=</span> <span class="n">ignore_at_print</span>
        <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pyccel_stage</span> <span class="o">==</span> <span class="s2">&quot;syntactic&quot;</span><span class="p">:</span>
                <span class="n">target</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Missing argument &#39;target&#39;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
            <span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="n">target</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">pyccel_stage</span> <span class="o">==</span> <span class="s2">&quot;syntactic&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">target</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Import</span><span class="o">.</span><span class="n">_format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">target</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">AsName</span><span class="p">,</span> <span class="n">Module</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Module</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">AsName</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">source</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

<div class="viewcode-block" id="Import._format"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Import._format">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_format</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">DottedName</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">PyccelSymbol</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">DottedName</span><span class="p">,</span> <span class="n">AsName</span><span class="p">,</span> <span class="n">PyccelSymbol</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a string, PyccelSymbol DottedName, given </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ignore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ignore_at_print</span>

    <span class="nd">@ignore</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ignore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_ignore</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">to_ignore</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;to_ignore must be a boolean.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ignore_at_print</span> <span class="o">=</span> <span class="n">to_ignore</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">source</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;import </span><span class="si">{source}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">])</span>
            <span class="k">return</span> <span class="s1">&#39;from </span><span class="si">{source}</span><span class="s1"> import </span><span class="si">{target}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
                    <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>

<div class="viewcode-block" id="Import.define_target"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Import.define_target">[docs]</a>    <span class="k">def</span> <span class="nf">define_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_target</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an additional target to the imports</span>
<span class="sd">        I.e. if imp is an Import defined as:</span>
<span class="sd">        &gt;&gt;&gt; from numpy import ones</span>

<span class="sd">        and we call imp.define_target(&#39;cos&#39;)</span>
<span class="sd">        then it becomes:</span>
<span class="sd">        &gt;&gt;&gt; from numpy import ones, cos</span>

<span class="sd">        Parameter</span>
<span class="sd">        ---------</span>
<span class="sd">        new_target: str/AsName/iterable of str/AsName</span>
<span class="sd">                    The new import target</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">iterable</span><span class="p">(</span><span class="n">new_target</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_target</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_target</span><span class="p">)</span></div>

<div class="viewcode-block" id="Import.find_module_target"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Import.find_module_target">[docs]</a>    <span class="k">def</span> <span class="nf">find_module_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_target</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">AsName</span><span class="p">)</span> <span class="ow">and</span> <span class="n">new_target</span> <span class="o">==</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">target</span>
            <span class="k">elif</span> <span class="n">new_target</span> <span class="o">==</span> <span class="n">t</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">t</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source_module</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The module describing the Import source</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source_mod</span></div>


<span class="c1"># TODO: Should Declare have an optional init value for each var?</span>

<span class="k">class</span> <span class="nc">FuncAddressDeclare</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a FunctionAddress declaration in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variable:</span>
<span class="sd">        An instance of FunctionAddress.</span>
<span class="sd">    intent: None, str</span>
<span class="sd">        one among {&#39;in&#39;, &#39;out&#39;, &#39;inout&#39;}</span>
<span class="sd">    value: PyccelAstNode</span>
<span class="sd">        variable value</span>
<span class="sd">    static: bool</span>
<span class="sd">        True for a static declaration of an array.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Variable, FunctionAddress, FuncAddressDeclare</span>
<span class="sd">    &gt;&gt;&gt; x = Variable(&#39;float&#39;, &#39;x&#39;)</span>
<span class="sd">    &gt;&gt;&gt; y = Variable(&#39;float&#39;, &#39;y&#39;)</span>
<span class="sd">    &gt;&gt;&gt; FuncAddressDeclare(FunctionAddress(&#39;f&#39;, [x], [y], []))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variable&#39;</span><span class="p">,</span><span class="s1">&#39;_intent&#39;</span><span class="p">,</span><span class="s1">&#39;_value&#39;</span><span class="p">,</span><span class="s1">&#39;_static&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variable&#39;</span><span class="p">,</span> <span class="s1">&#39;_value&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">variable</span><span class="p">,</span>
        <span class="n">intent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">static</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">FunctionAddress</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;variable must be of type FunctionAddress, given </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">intent</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">intent</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="s1">&#39;inout&#39;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;intent must be one among {&#39;in&#39;, &#39;out&#39;, &#39;inout&#39;}&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">static</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for static attribute&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span>  <span class="o">=</span> <span class="n">variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intent</span>    <span class="o">=</span> <span class="n">intent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>     <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_static</span>    <span class="o">=</span> <span class="n">static</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span><span class="o">.</span><span class="n">results</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span><span class="o">.</span><span class="n">arguments</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intent</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">static</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_static</span>

<span class="c1"># ARA : issue-999 add is_external for external function exported through header files</span>
<div class="viewcode-block" id="Declare"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Declare">[docs]</a><span class="k">class</span> <span class="nc">Declare</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a variable declaration in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dtype : DataType</span>
<span class="sd">        The type for the declaration.</span>
<span class="sd">    variable(s)</span>
<span class="sd">        A single variable or an iterable of Variables. If iterable, all</span>
<span class="sd">        Variables must be of the same type.</span>
<span class="sd">    intent: None, str</span>
<span class="sd">        one among {&#39;in&#39;, &#39;out&#39;, &#39;inout&#39;}</span>
<span class="sd">    value: PyccelAstNode</span>
<span class="sd">        variable value</span>
<span class="sd">    static: bool</span>
<span class="sd">        True for a static declaration of an array.</span>
<span class="sd">    external: bool</span>
<span class="sd">        True for a function declared through a header</span>
<span class="sd">    module_variable : bool</span>
<span class="sd">        True for a variable which belongs to a module</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Declare, Variable</span>
<span class="sd">    &gt;&gt;&gt; Declare(&#39;int&#39;, Variable(&#39;int&#39;, &#39;n&#39;))</span>
<span class="sd">    Declare(NativeInteger(), (n,), None)</span>
<span class="sd">    &gt;&gt;&gt; Declare(&#39;float&#39;, Variable(&#39;float&#39;, &#39;x&#39;), intent=&#39;out&#39;)</span>
<span class="sd">    Declare(NativeFloat(), (x,), out)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_dtype&#39;</span><span class="p">,</span><span class="s1">&#39;_variable&#39;</span><span class="p">,</span><span class="s1">&#39;_intent&#39;</span><span class="p">,</span><span class="s1">&#39;_value&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_static&#39;</span><span class="p">,</span><span class="s1">&#39;_passed_from_dotted&#39;</span><span class="p">,</span> <span class="s1">&#39;_external&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_module_variable&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variable&#39;</span><span class="p">,</span> <span class="s1">&#39;_value&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dtype</span><span class="p">,</span>
        <span class="n">variable</span><span class="p">,</span>
        <span class="n">intent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">static</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">passed_from_dotted</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">external</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">module_variable</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">datatype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">DataType</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;datatype must be an instance of DataType.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;var must be of type Variable, given </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">dtype</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All variables must have the same dtype&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">intent</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">intent</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="s1">&#39;inout&#39;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;intent must be one among {&#39;in&#39;, &#39;out&#39;, &#39;inout&#39;}&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">static</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for static attribute&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">passed_from_dotted</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for passed_from_dotted attribute&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">external</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for external attribute&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module_variable</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a boolean for module_variable attribute&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span> <span class="o">=</span> <span class="n">variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intent</span> <span class="o">=</span> <span class="n">intent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_static</span> <span class="o">=</span> <span class="n">static</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_passed_from_dotted</span> <span class="o">=</span> <span class="n">passed_from_dotted</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_external</span> <span class="o">=</span> <span class="n">external</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module_variable</span> <span class="o">=</span> <span class="n">module_variable</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intent</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">static</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_static</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">passed_from_dotted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Argument is the lhs of a DottedFunction</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_passed_from_dotted</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">external</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_external</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">module_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Indicates whether the variable is scoped to</span>
<span class="sd">        a module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_variable</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Declare(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">))</span></div>

<div class="viewcode-block" id="Break"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Break">[docs]</a><span class="k">class</span> <span class="nc">Break</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a break in the code.&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span></div>


<div class="viewcode-block" id="Continue"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Continue">[docs]</a><span class="k">class</span> <span class="nc">Continue</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a continue in the code.&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span></div>


<span class="k">class</span> <span class="nc">Raise</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a raise in the code.&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span>



<div class="viewcode-block" id="SymbolicPrint"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.SymbolicPrint">[docs]</a><span class="k">class</span> <span class="nc">SymbolicPrint</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a print function of symbolic expressions in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    expr : PyccelAstNode</span>
<span class="sd">        The expression to print</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.internals import symbols</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Print</span>
<span class="sd">    &gt;&gt;&gt; n,m = symbols(&#39;n,m&#39;)</span>
<span class="sd">    &gt;&gt;&gt; Print((&#39;results&#39;, n,m))</span>
<span class="sd">    Print((results, n, m))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_expr&#39;</span><span class="p">,)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_expr&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting an iterable&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">Lambda</span><span class="p">,</span> <span class="n">SymbolicAssign</span><span class="p">,</span>
                              <span class="n">SympyFunction</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting Lambda, SymbolicAssign, SympyFunction for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span> <span class="o">=</span> <span class="n">expr</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr</span></div>


<div class="viewcode-block" id="Del"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Del">[docs]</a><span class="k">class</span> <span class="nc">Del</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a memory deallocation in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    variables : list, tuple</span>
<span class="sd">        a list of pyccel variables</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Del, Variable</span>
<span class="sd">    &gt;&gt;&gt; x = Variable(&#39;float&#39;, &#39;x&#39;, rank=2, shape=(10,2), memory_handling=&#39;heap&#39;)</span>
<span class="sd">    &gt;&gt;&gt; Del([x])</span>
<span class="sd">    Del([x])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variables&#39;</span><span class="p">,)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_variables&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

        <span class="c1"># TODO: check that the variable is allocatable</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">iterable</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
            <span class="n">expr</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">expr</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="n">expr</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span></div>


<div class="viewcode-block" id="EmptyNode"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.EmptyNode">[docs]</a><span class="k">class</span> <span class="nc">EmptyNode</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents an empty node in the abstract syntax tree (AST).</span>
<span class="sd">    When a subtree is removed from the AST, we replace it with an EmptyNode</span>
<span class="sd">    object that acts as a placeholder. Using an EmptyNode instead of None</span>
<span class="sd">    is more explicit and avoids confusion. Further, finding a None in the AST</span>
<span class="sd">    is signal of an internal bug.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    text : str</span>
<span class="sd">       the comment line</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import EmptyNode</span>
<span class="sd">    &gt;&gt;&gt; EmptyNode()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span></div>


<div class="viewcode-block" id="Comment"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Comment">[docs]</a><span class="k">class</span> <span class="nc">Comment</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a Comment in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    text : str</span>
<span class="sd">       the comment line</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Comment</span>
<span class="sd">    &gt;&gt;&gt; Comment(&#39;this is a comment&#39;)</span>
<span class="sd">    # this is a comment</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_text&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text</span> <span class="o">=</span> <span class="n">text</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;# </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__reduce_ex__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Used by pickle to create an object of this class.</span>

<span class="sd">          Parameters</span>
<span class="sd">          ----------</span>

<span class="sd">          i : int</span>
<span class="sd">           protocol</span>

<span class="sd">          Results</span>
<span class="sd">          -------</span>

<span class="sd">          out : tuple</span>
<span class="sd">           A tuple of two elements</span>
<span class="sd">           a callable function that can be called</span>
<span class="sd">           to create the initial version of the object</span>
<span class="sd">           and its arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">apply</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="p">(),</span> <span class="n">kwargs</span><span class="p">))</span></div>


<div class="viewcode-block" id="SeparatorComment"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.SeparatorComment">[docs]</a><span class="k">class</span> <span class="nc">SeparatorComment</span><span class="p">(</span><span class="n">Comment</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a Separator Comment in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mark : str</span>
<span class="sd">        marker</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import SeparatorComment</span>
<span class="sd">    &gt;&gt;&gt; SeparatorComment(n=40)</span>
<span class="sd">    # ........................................</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;.&quot;&quot;&quot;</span> <span class="o">*</span> <span class="n">n</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="AnnotatedComment"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.AnnotatedComment">[docs]</a><span class="k">class</span> <span class="nc">AnnotatedComment</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a Annotated Comment in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    accel : str</span>
<span class="sd">       accelerator id. One among {&#39;acc&#39;}</span>

<span class="sd">    txt: str</span>
<span class="sd">        statement to print</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import AnnotatedComment</span>
<span class="sd">    &gt;&gt;&gt; AnnotatedComment(&#39;acc&#39;, &#39;parallel&#39;)</span>
<span class="sd">    AnnotatedComment(acc, parallel)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_accel&#39;</span><span class="p">,</span><span class="s1">&#39;_txt&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accel</span><span class="p">,</span> <span class="n">txt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_accel</span> <span class="o">=</span> <span class="n">accel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_txt</span> <span class="o">=</span> <span class="n">txt</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">accel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accel</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">txt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_txt</span>

    <span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;used for Pickling self.&quot;&quot;&quot;</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">args</span></div>

<div class="viewcode-block" id="CommentBlock"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.CommentBlock">[docs]</a><span class="k">class</span> <span class="nc">CommentBlock</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; Represents a Block of Comments</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    txt : str</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_header&#39;</span><span class="p">,</span><span class="s1">&#39;_comments&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="s1">&#39;CommentBlock&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;txt must be of type str&#39;</span><span class="p">)</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">txts</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_header</span> <span class="o">=</span> <span class="n">header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comments</span> <span class="o">=</span> <span class="n">txts</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">comments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comments</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header</span>

    <span class="nd">@header</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_header</span> <span class="o">=</span> <span class="n">header</span></div>


<div class="viewcode-block" id="Assert"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Assert">[docs]</a><span class="k">class</span> <span class="nc">Assert</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents an assert statement in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    test: PyccelAstNode</span>
<span class="sd">        boolean expression to check</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_test&#39;</span><span class="p">,)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_test&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pyccel_stage</span> <span class="o">!=</span> <span class="s1">&#39;syntactic&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">test</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NativeBool</span><span class="p">():</span>
                <span class="n">test</span> <span class="o">=</span> <span class="n">PythonBool</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_test</span> <span class="o">=</span> <span class="n">test</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_test</span></div>


<div class="viewcode-block" id="Pass"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.Pass">[docs]</a><span class="k">class</span> <span class="nc">Pass</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Basic class for pass instruction.&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span></div>

<span class="k">class</span> <span class="nc">Exit</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Basic class for exits.&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span>

<span class="c1">#TODO: [EB 26.01.2021] Do we need this unused class?</span>
<span class="k">class</span> <span class="nc">ErrorExit</span><span class="p">(</span><span class="n">Exit</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Exit with error.&quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

<span class="k">class</span> <span class="nc">IfSection</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a condition and associated code block</span>
<span class="sd">    in an if statement in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cond : PyccelAstNode</span>
<span class="sd">           A boolean expression indicating whether or not the block</span>
<span class="sd">           should be executed</span>
<span class="sd">    body : CodeBlock</span>
<span class="sd">           The code to be executed in the condition is satisfied</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.internals import PyccelSymbol</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Assign, IfSection, CodeBlock</span>
<span class="sd">    &gt;&gt;&gt; n = PyccelSymbol(&#39;n&#39;)</span>
<span class="sd">    &gt;&gt;&gt; IfSection((n&gt;1), CodeBlock([Assign(n,n-1)]))</span>
<span class="sd">    IfSection((n&gt;1), CodeBlock([Assign(n,n-1)]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_condition&#39;</span><span class="p">,</span><span class="s1">&#39;_block&#39;</span><span class="p">)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_condition&#39;</span><span class="p">,</span><span class="s1">&#39;_block&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">pyccel_stage</span> <span class="o">==</span> <span class="s1">&#39;semantic&#39;</span> <span class="ow">and</span> <span class="n">cond</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NativeBool</span><span class="p">():</span>
            <span class="n">cond</span> <span class="o">=</span> <span class="n">PythonBool</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">CodeBlock</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">CodeBlock</span><span class="p">):</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">body</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;body is not iterable or CodeBlock&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_condition</span> <span class="o">=</span> <span class="n">cond</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_block</span>     <span class="o">=</span> <span class="n">body</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">condition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_condition</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;IfSec(</span><span class="si">{}</span><span class="s2">,</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">))</span>

<div class="viewcode-block" id="If"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.If">[docs]</a><span class="k">class</span> <span class="nc">If</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Represents a if statement in the code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    args : IfSection</span>
<span class="sd">           All arguments are sections of the complete If block</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.internals import PyccelSymbol</span>
<span class="sd">    &gt;&gt;&gt; from pyccel.ast.core import Assign, If</span>
<span class="sd">    &gt;&gt;&gt; n = PyccelSymbol(&#39;n&#39;)</span>
<span class="sd">    &gt;&gt;&gt; i1 = IfSection((n&gt;1), [Assign(n,n-1)])</span>
<span class="sd">    &gt;&gt;&gt; i2 = IfSection(True, [Assign(n,n+1)])</span>
<span class="sd">    &gt;&gt;&gt; If(i1, i2)</span>
<span class="sd">    If(IfSection((n&gt;1), [Assign(n,n-1)]), IfSection(True, [Assign(n,n+1)]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_blocks&#39;</span><span class="p">,)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_blocks&#39;</span><span class="p">,)</span>

    <span class="c1"># TODO add type check in the semantic stage</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">IfSection</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;An If must be composed of IfSections&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span> <span class="o">=</span> <span class="n">args</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bodies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">body</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blocks</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;If(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">))</span></div>

<div class="viewcode-block" id="StarredArguments"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.StarredArguments">[docs]</a><span class="k">class</span> <span class="nc">StarredArguments</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_starred_obj&#39;</span><span class="p">,)</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_starred_obj&#39;</span><span class="p">,)</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_starred_obj</span> <span class="o">=</span> <span class="n">args</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">args_var</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_starred_obj</span></div>

<span class="c1"># ...</span>

<div class="viewcode-block" id="InProgram"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.InProgram">[docs]</a><span class="k">class</span> <span class="nc">InProgram</span><span class="p">(</span><span class="n">PyccelAstNode</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class representing the boolean:</span>
<span class="sd">    __name__ == &#39;__main__&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_dtype</span> <span class="o">=</span> <span class="n">NativeBool</span><span class="p">()</span>
    <span class="n">_precision</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">_rank</span>  <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_shape</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_order</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_attribute_nodes</span> <span class="o">=</span> <span class="p">()</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span></div>

<span class="c1"># ...</span>

<span class="k">class</span> <span class="nc">Decorator</span><span class="p">(</span><span class="n">Basic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class representing a function decorator.</span>
<span class="sd">    For now this is just designed to handle the pyccel decorators</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">            The name of the decorator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_name&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the name of the decorator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

<span class="c1"># ... TODO: improve and make it recursive</span>

<div class="viewcode-block" id="get_iterable_ranges"><a class="viewcode-back" href="../../../pyccel.ast.html#pyccel.ast.core.get_iterable_ranges">[docs]</a><span class="k">def</span> <span class="nf">get_iterable_ranges</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns ranges of an iterable object.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">it</span><span class="o">.</span><span class="n">cls_base</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;iterable must be an iterable Variable object&#39;</span>
                            <span class="p">)</span>

        <span class="c1"># ...</span>

        <span class="k">def</span> <span class="nf">_construct_arg_Range</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">DottedName</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a DottedName, given  </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">)))</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">var_name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">DottedName</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">DottedName</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># ...</span>

        <span class="n">cls_base</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">cls_base</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cls_base</span><span class="p">,</span> <span class="n">PythonRange</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">DottedName</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a DottedName, given  </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">name</span><span class="p">)))</span>

            <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">cls_base</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">cls_base</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">cls_base</span><span class="o">.</span><span class="n">step</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
                    <span class="n">arg_name</span> <span class="o">=</span> <span class="n">_construct_arg_Range</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="n">arg</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">arg_name</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">IndexedElement</span><span class="p">):</span>
                    <span class="n">arg_name</span> <span class="o">=</span> <span class="n">_construct_arg_Range</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="n">base</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">arg_name</span><span class="p">)</span>
                    <span class="n">indices</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">indices</span>
                    <span class="n">arg</span> <span class="o">=</span> <span class="n">base</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Wrong type, given </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
                <span class="n">args</span> <span class="o">+=</span> <span class="p">[</span><span class="n">arg</span><span class="p">]</span>

            <span class="k">return</span> <span class="p">[</span><span class="n">PythonRange</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)]</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">ConstructorCall</span><span class="p">):</span>
        <span class="n">cls_base</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">cls_base</span>

        <span class="c1"># arguments[0] is &#39;self&#39;</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">it</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>

                <span class="c1"># we add &#39;_&#39; tp be conform with the private variables convention</span>

                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">])]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

        <span class="c1"># TODO improve</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">args</span>

<span class="c1">#        for k,v in kwargs:</span>
<span class="c1">#            params.append(k)</span>

    <span class="n">methods</span> <span class="o">=</span> <span class="n">cls_base</span><span class="o">.</span><span class="n">methods_as_dict</span>
    <span class="n">init_method</span> <span class="o">=</span> <span class="n">methods</span><span class="p">[</span><span class="s1">&#39;__init__&#39;</span><span class="p">]</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">init_method</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>

    <span class="c1"># ...</span>

    <span class="n">it_method</span> <span class="o">=</span> <span class="n">methods</span><span class="p">[</span><span class="s1">&#39;__iter__&#39;</span><span class="p">]</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">starts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">stmt</span> <span class="ow">in</span> <span class="n">it_method</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">Assign</span><span class="p">):</span>
            <span class="n">targets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
            <span class="n">starts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>

    <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">starts</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">IndexedElement</span><span class="p">):</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">base</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span>

    <span class="n">inits</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">stmt</span> <span class="ow">in</span> <span class="n">init_method</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">Assign</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
                <span class="n">expr</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">rhs</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">a_old</span><span class="p">,</span> <span class="n">a_new</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
                    <span class="n">dtype</span> <span class="o">=</span> <span class="n">datatype</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                    <span class="n">v_old</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">a_old</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a_new</span><span class="p">,</span> <span class="p">(</span><span class="n">IndexedElement</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)):</span>
                        <span class="n">v_new</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">a_new</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">v_new</span> <span class="o">=</span> <span class="n">a_new</span>
                    <span class="n">expr</span> <span class="o">=</span> <span class="n">subs</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">v_old</span><span class="p">,</span> <span class="n">v_new</span><span class="p">)</span>
                    <span class="n">inits</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">lhs</span><span class="p">)]</span> <span class="o">=</span> <span class="n">expr</span>

    <span class="n">_starts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">starts</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">IndexedElement</span><span class="p">):</span>
            <span class="n">_starts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">base</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_starts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">starts</span> <span class="o">=</span> <span class="p">[</span><span class="n">inits</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_starts</span><span class="p">]</span>

    <span class="c1"># ...</span>

    <span class="k">def</span> <span class="nf">_find_stopping_criterium</span><span class="p">(</span><span class="n">stmts</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">stmt</span> <span class="ow">in</span> <span class="n">stmts</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">If</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Wrong __next__ pattern&#39;</span><span class="p">)</span>

                <span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">et</span><span class="p">)</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">ef</span><span class="p">)</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">et</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Raise</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">cf</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ef</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Raise</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">ct</span>

                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Wrong type for __next__ pattern&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># ...</span>

    <span class="c1"># ...</span>

    <span class="k">def</span> <span class="nf">doit</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Relational</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span> <span class="ow">in</span> <span class="n">targets</span> <span class="ow">and</span> <span class="n">expr</span><span class="o">.</span><span class="n">rel_op</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">rhs</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span> <span class="ow">in</span> <span class="n">targets</span> <span class="ow">and</span> <span class="n">expr</span><span class="o">.</span><span class="n">rel_op</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;=&#39;</span>
                    <span class="p">]:</span>
                <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">lhs</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">sp_And</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">doit</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting And logical expression.&#39;</span><span class="p">)</span>

    <span class="c1"># ...</span>

    <span class="c1"># ...</span>

    <span class="n">next_method</span> <span class="o">=</span> <span class="n">methods</span><span class="p">[</span><span class="s1">&#39;__next__&#39;</span><span class="p">]</span>
    <span class="n">ends</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">_find_stopping_criterium</span><span class="p">(</span><span class="n">next_method</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>

    <span class="c1"># TODO treate case of cond with &#39;and&#39; operation</span>
    <span class="c1"># TODO we should avoid using str</span>
    <span class="c1">#      must change target from DottedName to Variable</span>

    <span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">]</span>
    <span class="n">ends</span> <span class="o">=</span> <span class="n">doit</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>

    <span class="c1"># TODO not use str</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ends</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">ends</span> <span class="o">=</span> <span class="p">[</span><span class="n">ends</span><span class="p">]</span>

    <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ends</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">IndexedElement</span><span class="p">):</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">base</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span>

    <span class="n">inits</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">stmt</span> <span class="ow">in</span> <span class="n">init_method</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">Assign</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
                <span class="n">expr</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">rhs</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">a_old</span><span class="p">,</span> <span class="n">a_new</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
                    <span class="n">dtype</span> <span class="o">=</span> <span class="n">datatype</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                    <span class="n">v_old</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">a_old</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a_new</span><span class="p">,</span> <span class="p">(</span><span class="n">IndexedElement</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)):</span>
                        <span class="n">v_new</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">a_new</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">v_new</span> <span class="o">=</span> <span class="n">a_new</span>
                    <span class="n">expr</span> <span class="o">=</span> <span class="n">subs</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">v_old</span><span class="p">,</span> <span class="n">v_new</span><span class="p">)</span>
                    <span class="n">inits</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">lhs</span><span class="p">)]</span> <span class="o">=</span> <span class="n">expr</span>

    <span class="n">_ends</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ends</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">IndexedElement</span><span class="p">):</span>
            <span class="n">_ends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">base</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_ends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">ends</span> <span class="o">=</span> <span class="p">[</span><span class="n">inits</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_ends</span><span class="p">]</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">ends</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">starts</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;wrong number of starts/ends&#39;</span><span class="p">)</span>

    <span class="c1"># ...</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">PythonRange</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">starts</span><span class="p">,</span> <span class="n">ends</span><span class="p">)]</span></div>

<span class="c1">#==============================================================================</span>

</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, *.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>