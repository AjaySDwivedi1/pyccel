

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyccel.codegen.printing.fcode &mdash; pyccel * documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/fonts.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> pyccel
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../modules.html">docBranck</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">pyccel</a>
        
      </nav>


      <div class="wy-nav-content">
<div class="git-ribbon">
  <a href="http://github.com/SwissDataScienceCenter" rel="me">Join us on GitHub</a>
</div>

        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>pyccel.codegen.printing.fcode</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyccel.codegen.printing.fcode</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding: utf-8</span>
<span class="c1">#------------------------------------------------------------------------------------------#</span>
<span class="c1"># This file is part of Pyccel which is released under MIT License. See the LICENSE file or #</span>
<span class="c1"># go to https://github.com/pyccel/pyccel/blob/master/LICENSE for full license details.     #</span>
<span class="c1">#------------------------------------------------------------------------------------------#</span>
<span class="c1"># pylint: disable=missing-function-docstring</span>

<span class="sd">&quot;&quot;&quot;Print to F90 standard. Trying to follow the information provided at</span>
<span class="sd">www.fortran90.org as much as possible.&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

<span class="kn">import</span> <span class="nn">functools</span>

<span class="kn">from</span> <span class="nn">pyccel.ast.basic</span> <span class="kn">import</span> <span class="n">PyccelAstNode</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.bind_c</span> <span class="kn">import</span> <span class="n">BindCPointer</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.core</span> <span class="kn">import</span> <span class="n">get_iterable_ranges</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.core</span> <span class="kn">import</span> <span class="n">FunctionDef</span><span class="p">,</span> <span class="n">InlineFunctionDef</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.core</span> <span class="kn">import</span> <span class="n">SeparatorComment</span><span class="p">,</span> <span class="n">Comment</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.core</span> <span class="kn">import</span> <span class="n">ConstructorCall</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.core</span> <span class="kn">import</span> <span class="n">FunctionCallArgument</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.core</span> <span class="kn">import</span> <span class="n">ErrorExit</span><span class="p">,</span> <span class="n">FunctionAddress</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.core</span> <span class="kn">import</span> <span class="n">Return</span><span class="p">,</span> <span class="n">Module</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.core</span> <span class="kn">import</span> <span class="n">Import</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.internals</span>    <span class="kn">import</span> <span class="n">PyccelInternalFunction</span><span class="p">,</span> <span class="n">get_final_precision</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.itertoolsext</span> <span class="kn">import</span> <span class="n">Product</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.core</span> <span class="kn">import</span> <span class="p">(</span><span class="n">Assign</span><span class="p">,</span> <span class="n">AliasAssign</span><span class="p">,</span> <span class="n">Declare</span><span class="p">,</span>
                             <span class="n">CodeBlock</span><span class="p">,</span> <span class="n">AsName</span><span class="p">,</span> <span class="n">EmptyNode</span><span class="p">,</span>
                             <span class="n">If</span><span class="p">,</span> <span class="n">IfSection</span><span class="p">,</span> <span class="n">For</span><span class="p">,</span> <span class="n">Deallocate</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">pyccel.ast.variable</span>  <span class="kn">import</span> <span class="p">(</span><span class="n">Variable</span><span class="p">,</span>
                             <span class="n">IndexedElement</span><span class="p">,</span>
                             <span class="n">InhomogeneousTupleVariable</span><span class="p">,</span>
                             <span class="n">DottedName</span><span class="p">,</span> <span class="n">PyccelArraySize</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">pyccel.ast.operators</span>      <span class="kn">import</span> <span class="n">PyccelAdd</span><span class="p">,</span> <span class="n">PyccelMul</span><span class="p">,</span> <span class="n">PyccelMinus</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.operators</span>      <span class="kn">import</span> <span class="n">PyccelMod</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.operators</span>      <span class="kn">import</span> <span class="n">PyccelUnarySub</span><span class="p">,</span> <span class="n">PyccelLt</span><span class="p">,</span> <span class="n">PyccelGt</span><span class="p">,</span> <span class="n">IfTernaryOperator</span>

<span class="kn">from</span> <span class="nn">pyccel.ast.core</span>      <span class="kn">import</span> <span class="n">FunctionCall</span><span class="p">,</span> <span class="n">DottedFunctionCall</span><span class="p">,</span> <span class="n">PyccelFunctionDef</span>

<span class="kn">from</span> <span class="nn">pyccel.ast.builtins</span>  <span class="kn">import</span> <span class="p">(</span><span class="n">PythonInt</span><span class="p">,</span> <span class="n">PythonType</span><span class="p">,</span>
                                  <span class="n">PythonPrint</span><span class="p">,</span> <span class="n">PythonRange</span><span class="p">,</span>
                                  <span class="n">PythonFloat</span><span class="p">,</span> <span class="n">PythonTuple</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.builtins</span>  <span class="kn">import</span> <span class="n">PythonComplex</span><span class="p">,</span> <span class="n">PythonBool</span><span class="p">,</span> <span class="n">PythonAbs</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.datatypes</span> <span class="kn">import</span> <span class="n">is_pyccel_datatype</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.datatypes</span> <span class="kn">import</span> <span class="n">is_iterable_datatype</span><span class="p">,</span> <span class="n">is_with_construct_datatype</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.datatypes</span> <span class="kn">import</span> <span class="n">NativeSymbol</span><span class="p">,</span> <span class="n">NativeString</span><span class="p">,</span> <span class="n">str_dtype</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.datatypes</span> <span class="kn">import</span> <span class="n">NativeInteger</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">,</span> <span class="n">NativeFloat</span><span class="p">,</span> <span class="n">NativeComplex</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.datatypes</span> <span class="kn">import</span> <span class="n">iso_c_binding</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.datatypes</span> <span class="kn">import</span> <span class="n">iso_c_binding_shortcut_mapping</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.datatypes</span> <span class="kn">import</span> <span class="n">NativeRange</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.datatypes</span> <span class="kn">import</span> <span class="n">CustomDataType</span>

<span class="kn">from</span> <span class="nn">pyccel.ast.internals</span> <span class="kn">import</span> <span class="n">Slice</span><span class="p">,</span> <span class="n">PrecomputedCode</span>

<span class="kn">from</span> <span class="nn">pyccel.ast.literals</span>  <span class="kn">import</span> <span class="n">LiteralInteger</span><span class="p">,</span> <span class="n">LiteralFloat</span><span class="p">,</span> <span class="n">Literal</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.literals</span>  <span class="kn">import</span> <span class="n">LiteralTrue</span><span class="p">,</span> <span class="n">LiteralFalse</span><span class="p">,</span> <span class="n">LiteralString</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.literals</span>  <span class="kn">import</span> <span class="n">Nil</span>

<span class="kn">from</span> <span class="nn">pyccel.ast.mathext</span>  <span class="kn">import</span> <span class="n">math_constants</span>

<span class="kn">from</span> <span class="nn">pyccel.ast.numpyext</span> <span class="kn">import</span> <span class="n">NumpyEmpty</span><span class="p">,</span> <span class="n">NumpyInt32</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.numpyext</span> <span class="kn">import</span> <span class="n">NumpyFloat</span><span class="p">,</span> <span class="n">NumpyBool</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.numpyext</span> <span class="kn">import</span> <span class="n">NumpyReal</span><span class="p">,</span> <span class="n">NumpyImag</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.numpyext</span> <span class="kn">import</span> <span class="n">NumpyRand</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.numpyext</span> <span class="kn">import</span> <span class="n">NumpyNewArray</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.numpyext</span> <span class="kn">import</span> <span class="n">NumpyNonZero</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.numpyext</span> <span class="kn">import</span> <span class="n">NumpySign</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.numpyext</span> <span class="kn">import</span> <span class="n">Shape</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.numpyext</span> <span class="kn">import</span> <span class="n">DtypePrecisionToCastFunction</span>

<span class="kn">from</span> <span class="nn">pyccel.ast.utilities</span> <span class="kn">import</span> <span class="n">builtin_import_registery</span> <span class="k">as</span> <span class="n">pyccel_builtin_import_registery</span>
<span class="kn">from</span> <span class="nn">pyccel.ast.utilities</span> <span class="kn">import</span> <span class="n">expand_to_loops</span>

<span class="kn">from</span> <span class="nn">pyccel.errors.errors</span> <span class="kn">import</span> <span class="n">Errors</span>
<span class="kn">from</span> <span class="nn">pyccel.errors.messages</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pyccel.codegen.printing.codeprinter</span> <span class="kn">import</span> <span class="n">CodePrinter</span>


<span class="c1"># TODO: add examples</span>
<span class="c1"># TODO: use _get_statement when returning a string</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;FCodePrinter&quot;</span><span class="p">,</span> <span class="s2">&quot;fcode&quot;</span><span class="p">]</span>

<span class="n">numpy_ufunc_to_fortran</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;NumpyAbs&#39;</span>  <span class="p">:</span> <span class="s1">&#39;abs&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyFabs&#39;</span>  <span class="p">:</span> <span class="s1">&#39;abs&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyMin&#39;</span>  <span class="p">:</span> <span class="s1">&#39;minval&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyAmin&#39;</span>  <span class="p">:</span> <span class="s1">&#39;minval&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyAmax&#39;</span>  <span class="p">:</span> <span class="s1">&#39;maxval&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyFloor&#39;</span><span class="p">:</span> <span class="s1">&#39;floor&#39;</span><span class="p">,</span>  <span class="c1"># TODO: might require special treatment with casting</span>
    <span class="c1"># ---</span>
    <span class="s1">&#39;NumpyExp&#39;</span> <span class="p">:</span> <span class="s1">&#39;exp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyLog&#39;</span> <span class="p">:</span> <span class="s1">&#39;Log&#39;</span><span class="p">,</span>
    <span class="c1"># &#39;NumpySqrt&#39;: &#39;Sqrt&#39;,  # sqrt is printed using _Print_NumpySqrt</span>
    <span class="c1"># ---</span>
    <span class="s1">&#39;NumpySin&#39;</span>    <span class="p">:</span> <span class="s1">&#39;sin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyCos&#39;</span>    <span class="p">:</span> <span class="s1">&#39;cos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyTan&#39;</span>    <span class="p">:</span> <span class="s1">&#39;tan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArcsin&#39;</span> <span class="p">:</span> <span class="s1">&#39;asin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArccos&#39;</span> <span class="p">:</span> <span class="s1">&#39;acos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArctan&#39;</span> <span class="p">:</span> <span class="s1">&#39;atan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArctan2&#39;</span><span class="p">:</span> <span class="s1">&#39;atan2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpySinh&#39;</span>   <span class="p">:</span> <span class="s1">&#39;sinh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyCosh&#39;</span>   <span class="p">:</span> <span class="s1">&#39;cosh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyTanh&#39;</span>   <span class="p">:</span> <span class="s1">&#39;tanh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArcsinh&#39;</span><span class="p">:</span> <span class="s1">&#39;asinh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArccosh&#39;</span><span class="p">:</span> <span class="s1">&#39;acosh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumpyArctanh&#39;</span><span class="p">:</span> <span class="s1">&#39;atanh&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">math_function_to_fortran</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;MathAcos&#39;</span>   <span class="p">:</span> <span class="s1">&#39;acos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathAcosh&#39;</span>  <span class="p">:</span> <span class="s1">&#39;acosh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathAsin&#39;</span>   <span class="p">:</span> <span class="s1">&#39;asin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathAsinh&#39;</span>  <span class="p">:</span> <span class="s1">&#39;asinh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathAtan&#39;</span>   <span class="p">:</span> <span class="s1">&#39;atan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathAtan2&#39;</span>  <span class="p">:</span> <span class="s1">&#39;atan2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathAtanh&#39;</span>  <span class="p">:</span> <span class="s1">&#39;atanh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathCopysign&#39;</span><span class="p">:</span> <span class="s1">&#39;sign&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathCos&#39;</span>    <span class="p">:</span> <span class="s1">&#39;cos&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathCosh&#39;</span>   <span class="p">:</span> <span class="s1">&#39;cosh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathErf&#39;</span>    <span class="p">:</span> <span class="s1">&#39;erf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathErfc&#39;</span>   <span class="p">:</span> <span class="s1">&#39;erfc&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathExp&#39;</span>    <span class="p">:</span> <span class="s1">&#39;exp&#39;</span><span class="p">,</span>
    <span class="c1"># &#39;MathExpm1&#39;  : &#39;???&#39;, # TODO</span>
    <span class="s1">&#39;MathFabs&#39;</span>   <span class="p">:</span> <span class="s1">&#39;abs&#39;</span><span class="p">,</span>
    <span class="c1"># &#39;MathFmod&#39;   : &#39;???&#39;,  # TODO</span>
    <span class="c1"># &#39;MathFsum&#39;   : &#39;???&#39;,  # TODO</span>
    <span class="s1">&#39;MathGamma&#39;</span>  <span class="p">:</span> <span class="s1">&#39;gamma&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathHypot&#39;</span>  <span class="p">:</span> <span class="s1">&#39;hypot&#39;</span><span class="p">,</span>
    <span class="c1"># &#39;MathLdexp&#39;  : &#39;???&#39;,  # TODO</span>
    <span class="s1">&#39;MathLgamma&#39;</span> <span class="p">:</span> <span class="s1">&#39;log_gamma&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathLog&#39;</span>    <span class="p">:</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathLog10&#39;</span>  <span class="p">:</span> <span class="s1">&#39;log10&#39;</span><span class="p">,</span>
    <span class="c1"># &#39;MathLog1p&#39;  : &#39;???&#39;, # TODO</span>
    <span class="c1"># &#39;MathLog2&#39;   : &#39;???&#39;, # TODO</span>
    <span class="c1"># &#39;MathPow&#39;    : &#39;???&#39;, # TODO</span>
    <span class="s1">&#39;MathSin&#39;</span>    <span class="p">:</span> <span class="s1">&#39;sin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathSinh&#39;</span>   <span class="p">:</span> <span class="s1">&#39;sinh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathSqrt&#39;</span>   <span class="p">:</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathTan&#39;</span>    <span class="p">:</span> <span class="s1">&#39;tan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathTanh&#39;</span>   <span class="p">:</span> <span class="s1">&#39;tanh&#39;</span><span class="p">,</span>
    <span class="c1"># ---</span>
    <span class="s1">&#39;MathFloor&#39;</span>    <span class="p">:</span> <span class="s1">&#39;floor&#39;</span><span class="p">,</span>
    <span class="c1"># ---</span>
    <span class="c1"># &#39;MathIsclose&#39; : &#39;???&#39;, # TODO</span>
    <span class="c1"># &#39;MathIsfinite&#39;: &#39;???&#39;, # TODO</span>
    <span class="c1"># &#39;MathIsinf&#39;   : &#39;???&#39;, # TODO</span>
    <span class="c1"># --------------------------- internal functions --------------------------</span>
    <span class="s1">&#39;MathFactorial&#39;</span> <span class="p">:</span> <span class="s1">&#39;pyc_factorial&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathGcd&#39;</span>       <span class="p">:</span> <span class="s1">&#39;pyc_gcd&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathDegrees&#39;</span>   <span class="p">:</span> <span class="s1">&#39;pyc_degrees&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathRadians&#39;</span>   <span class="p">:</span> <span class="s1">&#39;pyc_radians&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MathLcm&#39;</span>       <span class="p">:</span> <span class="s1">&#39;pyc_lcm&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">INF</span> <span class="o">=</span> <span class="n">math_constants</span><span class="p">[</span><span class="s1">&#39;inf&#39;</span><span class="p">]</span>

<span class="n">_default_methods</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;__init__&#39;</span><span class="p">:</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span>
    <span class="s1">&#39;__del__&#39;</span> <span class="p">:</span> <span class="s1">&#39;free&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">python_builtin_datatypes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;integer&#39;</span> <span class="p">:</span> <span class="n">PythonInt</span><span class="p">,</span>
    <span class="s1">&#39;float&#39;</span>   <span class="p">:</span> <span class="n">PythonFloat</span><span class="p">,</span>
    <span class="s1">&#39;bool&#39;</span>    <span class="p">:</span> <span class="n">PythonBool</span><span class="p">,</span>
    <span class="s1">&#39;complex&#39;</span> <span class="p">:</span> <span class="n">PythonComplex</span>
<span class="p">}</span>

<span class="n">type_to_print_format</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">):</span> <span class="s1">&#39;F0.12&#39;</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;complex&#39;</span><span class="p">):</span> <span class="s1">&#39;&quot;(&quot;,F0.12,&quot; + &quot;,F0.12,&quot;)&quot;&#39;</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">):</span> <span class="s1">&#39;I0&#39;</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;bool&#39;</span><span class="p">):</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">):</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;tuple&#39;</span><span class="p">):</span>  <span class="s1">&#39;*&#39;</span>
<span class="p">}</span>

<span class="n">inc_keyword</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;do\b&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;if\b&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;else\b&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;type\b\s*[^\(]&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;(elemental )?(pure )?(recursive )?((subroutine)|(function))\b&#39;</span><span class="p">,</span>
               <span class="sa">r</span><span class="s1">&#39;interface\b&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;module\b(?! *procedure)&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;program\b&#39;</span><span class="p">)</span>
<span class="n">inc_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inc_keyword</span><span class="p">))</span>

<span class="n">end_keyword</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;do&#39;</span><span class="p">,</span> <span class="s1">&#39;if&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;function&#39;</span><span class="p">,</span>
               <span class="s1">&#39;subroutine&#39;</span><span class="p">,</span> <span class="s1">&#39;interface&#39;</span><span class="p">,</span><span class="s1">&#39;module&#39;</span><span class="p">,</span><span class="s1">&#39;program&#39;</span><span class="p">)</span>
<span class="n">end_regex_str</span> <span class="o">=</span> <span class="s1">&#39;(end ?(</span><span class="si">{}</span><span class="s1">))|(else)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">end_keyword</span><span class="p">))</span>
<span class="n">dec_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">end_regex_str</span><span class="p">)</span>

<span class="n">errors</span> <span class="o">=</span> <span class="n">Errors</span><span class="p">()</span>

<div class="viewcode-block" id="FCodePrinter"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter">[docs]</a><span class="k">class</span> <span class="nc">FCodePrinter</span><span class="p">(</span><span class="n">CodePrinter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A printer to convert sympy expressions to strings of Fortran code&quot;&quot;&quot;</span>
    <span class="n">printmethod</span> <span class="o">=</span> <span class="s2">&quot;_fcode&quot;</span>
    <span class="n">language</span> <span class="o">=</span> <span class="s2">&quot;Fortran&quot;</span>

    <span class="n">_default_settings</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;tabwidth&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">}</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">prefix_module</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="n">errors</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;file&#39;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constantImports</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_class</span>    <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_imports</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prefix_module</span> <span class="o">=</span> <span class="n">prefix_module</span>

<div class="viewcode-block" id="FCodePrinter.print_constant_imports"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter.print_constant_imports">[docs]</a>    <span class="k">def</span> <span class="nf">print_constant_imports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints the use line for the constant imports used&quot;&quot;&quot;</span>
        <span class="n">macros</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">imports</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constantImports</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="n">macro</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;use, intrinsic :: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">, only : &quot;</span>
            <span class="n">rename</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; =&gt; &#39;</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">imports</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">macro</span> <span class="o">+=</span> <span class="s2">&quot; , &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rename</span><span class="p">)</span>
            <span class="n">macros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">macros</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter.get_additional_imports"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter.get_additional_imports">[docs]</a>    <span class="k">def</span> <span class="nf">get_additional_imports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return the additional modules collected for importing in printing stage&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">source</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_imports</span><span class="p">]</span></div>

<div class="viewcode-block" id="FCodePrinter.set_current_class"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter.set_current_class">[docs]</a>    <span class="k">def</span> <span class="nf">set_current_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_current_class</span> <span class="o">=</span> <span class="n">name</span></div>

<div class="viewcode-block" id="FCodePrinter.get_method"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter.get_method">[docs]</a>    <span class="k">def</span> <span class="nf">get_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_name</span><span class="p">,</span> <span class="n">method_name</span><span class="p">):</span>
        <span class="n">container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span>
        <span class="k">while</span> <span class="n">container</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cls_name</span> <span class="ow">in</span> <span class="n">container</span><span class="o">.</span><span class="n">classes</span><span class="p">:</span>
                <span class="bp">cls</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">cls_name</span><span class="p">]</span>
                <span class="n">methods</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">methods_as_dict</span>
                <span class="k">if</span> <span class="n">method_name</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">methods</span><span class="p">[</span><span class="n">method_name</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interface_funcs</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">f</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">interfaces</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">functions</span><span class="p">}</span>
                    <span class="k">if</span> <span class="n">method_name</span> <span class="ow">in</span> <span class="n">interface_funcs</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">interface_funcs</span><span class="p">[</span><span class="n">method_name</span><span class="p">]</span>
                    <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">UNDEFINED_METHOD</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">method_name</span><span class="p">,</span>
                        <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>
            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">parent_scope</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="n">DottedName</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_function</span><span class="p">(</span><span class="n">DottedName</span><span class="p">(</span><span class="n">method_name</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">UNDEFINED_FUNCTION</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">method_name</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter.get_function"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter.get_function">[docs]</a>    <span class="k">def</span> <span class="nf">get_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span>
        <span class="k">while</span> <span class="n">container</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">container</span><span class="o">.</span><span class="n">functions</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">container</span><span class="o">.</span><span class="n">functions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">parent_scope</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">DottedName</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_function</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">UNDEFINED_FUNCTION</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._get_statement"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._get_statement">[docs]</a>    <span class="k">def</span> <span class="nf">_get_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">codestring</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">codestring</span></div>

<div class="viewcode-block" id="FCodePrinter._format_code"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._format_code">[docs]</a>    <span class="k">def</span> <span class="nf">_format_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_fortran</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indent_code</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter.print_kind"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter.print_kind">[docs]</a>    <span class="k">def</span> <span class="nf">print_kind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the kind(precision) of a literal value or its shortcut if possible</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">precision</span> <span class="o">=</span> <span class="n">get_final_precision</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
        <span class="n">constant_name</span> <span class="o">=</span> <span class="n">iso_c_binding</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)][</span><span class="n">precision</span><span class="p">]</span>
        <span class="n">constant_shortcut</span> <span class="o">=</span> <span class="n">iso_c_binding_shortcut_mapping</span><span class="p">[</span><span class="n">constant_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">constant_shortcut</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">all_used_symbols</span> <span class="ow">and</span> <span class="n">constant_name</span> <span class="o">!=</span> <span class="n">constant_shortcut</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_constantImports</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ISO_C_Binding&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>\
                <span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">constant_shortcut</span><span class="p">,</span> <span class="n">constant_name</span><span class="p">))</span>
            <span class="n">constant_name</span> <span class="o">=</span> <span class="n">constant_shortcut</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_constantImports</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ISO_C_Binding&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>\
                <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">constant_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">constant_name</span></div>

<div class="viewcode-block" id="FCodePrinter._handle_inline_func_call"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._handle_inline_func_call">[docs]</a>    <span class="k">def</span> <span class="nf">_handle_inline_func_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">provided_args</span><span class="p">,</span> <span class="n">assign_lhs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Print a function call to an inline function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">funcdef</span>

        <span class="c1"># Print any arguments using the same inline function</span>
        <span class="c1"># As the function definition is modified directly this function</span>
        <span class="c1"># cannot be called recursively with the same FunctionDef</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">provided_args</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">is_user_of</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
                <span class="n">code</span> <span class="o">=</span> <span class="n">PrecomputedCode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="c1"># Create new local variables to ensure there are no name collisions</span>
        <span class="n">new_local_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_new_name</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> \
                            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">func</span><span class="o">.</span><span class="n">local_vars</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">new_local_vars</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">insert_variable</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="c1"># Put functions into current scope</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;variables&#39;</span><span class="p">,</span> <span class="s1">&#39;classes&#39;</span><span class="p">,</span> <span class="s1">&#39;functions&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">imports</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">namespace_imports</span><span class="p">[</span><span class="n">entry</span><span class="p">])</span>

        <span class="n">func</span><span class="o">.</span><span class="n">swap_in_args</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">new_local_vars</span><span class="p">)</span>

        <span class="n">func</span><span class="o">.</span><span class="n">remove_presence_checks</span><span class="p">()</span>

        <span class="n">body</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">body</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># If there is no return then the code is already ok</span>
            <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Search for the return and replace it with an empty node</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get_attribute_nodes</span><span class="p">(</span><span class="n">Return</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">empty_return</span> <span class="o">=</span> <span class="n">EmptyNode</span><span class="p">()</span>
            <span class="n">body</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">empty_return</span><span class="p">,</span> <span class="n">invalidate</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Everything before the return node needs handling before the line</span>
            <span class="c1"># which calls the inline function is executed</span>
            <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">+=</span> <span class="n">code</span>

            <span class="c1"># Collect statements from results to return object</span>
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">stmt</span><span class="p">:</span>
                <span class="n">assigns</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="o">.</span><span class="n">lhs</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">rhs</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">body</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Assign</span><span class="p">)}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">+=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stmt</span><span class="o">.</span><span class="n">body</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Assign</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">assigns</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1"># Put return statement back into function</span>
            <span class="n">body</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">empty_return</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">assign_lhs</span><span class="p">:</span>
                <span class="n">assigns</span> <span class="o">=</span> <span class="p">[</span><span class="n">Assign</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">assign_lhs</span><span class="p">,</span> <span class="n">assigns</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>
                <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">assigns</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res_return_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">assigns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">expr</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_return_vars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">return_val</span> <span class="o">=</span> <span class="n">res_return_vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">parent_assign</span> <span class="o">=</span> <span class="n">return_val</span><span class="o">.</span><span class="n">get_direct_user_nodes</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Assign</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">parent_assign</span><span class="p">:</span>
                        <span class="n">return_val</span><span class="o">.</span><span class="n">remove_user_node</span><span class="p">(</span><span class="n">parent_assign</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">invalidate</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
                        <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">return_val</span><span class="p">)</span>
                        <span class="n">return_val</span><span class="o">.</span><span class="n">set_current_user_node</span><span class="p">(</span><span class="n">parent_assign</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">return_val</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">res_return_vars</span><span class="p">))</span>

        <span class="c1"># Put back original arguments</span>
        <span class="n">func</span><span class="o">.</span><span class="n">reinstate_presence_checks</span><span class="p">()</span>
        <span class="n">func</span><span class="o">.</span><span class="n">swap_out_args</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_imports</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">imports</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">func</span><span class="o">.</span><span class="n">global_vars</span> <span class="ow">or</span> <span class="n">func</span><span class="o">.</span><span class="n">global_funcs</span><span class="p">:</span>
            <span class="n">mod</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">get_direct_user_nodes</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Module</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_additional_imports</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Import</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">[</span><span class="n">AsName</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> \
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="o">.</span><span class="n">global_vars</span><span class="p">,</span> <span class="o">*</span><span class="n">func</span><span class="o">.</span><span class="n">global_funcs</span><span class="p">)]))</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="o">.</span><span class="n">global_vars</span><span class="p">,</span> <span class="o">*</span><span class="n">func</span><span class="o">.</span><span class="n">global_funcs</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">insert_symbol</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_scope</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._get_external_declarations"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._get_external_declarations">[docs]</a>    <span class="k">def</span> <span class="nf">_get_external_declarations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Look for external functions and declare their result type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">decs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">imports</span><span class="p">[</span><span class="s1">&#39;functions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">FunctionDef</span><span class="p">)</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">is_external</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">external</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">decs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>

        <span class="k">return</span> <span class="n">decs</span></div>

    <span class="c1"># ============ Elements ============ #</span>
<div class="viewcode-block" id="FCodePrinter._print_PyccelSymbol"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelSymbol">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expr</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Module"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Module">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_scope</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">scope</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">AsName</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;mod_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix_module</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{prefix}</span><span class="s1">_</span><span class="si">{name}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix_module</span><span class="p">,</span>
                                            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># ARA : issue-999</span>
        <span class="c1">#       we look for external functions and declare their result type</span>
        <span class="n">external_decs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_external_declarations</span><span class="p">()</span>

        <span class="n">imports</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">imports</span><span class="p">)</span>

        <span class="n">decs</span>    <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">declarations</span><span class="p">)</span>
        <span class="c1"># ARA : issue-999</span>
        <span class="n">decs</span>   <span class="o">+=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">external_decs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">body</span>    <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># ... TODO add other elements</span>
        <span class="n">private_funcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">funcs</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_private</span><span class="p">]</span>
        <span class="n">private</span> <span class="o">=</span> <span class="n">private_funcs</span>
        <span class="k">if</span> <span class="n">private</span><span class="p">:</span>
            <span class="n">private</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">private</span><span class="p">)</span>
            <span class="n">private</span> <span class="o">=</span> <span class="s1">&#39;private :: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">private</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">private</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="c1"># ...</span>

        <span class="c1"># ...</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">SeparatorComment</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
        <span class="n">interfaces</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">interfaces</span><span class="p">:</span>
            <span class="n">interfaces</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">interfaces</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">funcs</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">sep</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">sep</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">funcs</span><span class="p">)</span>
        <span class="c1"># ...</span>

        <span class="c1"># ...</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">classes</span><span class="p">:</span>
            <span class="c1"># update decs with declarations from ClassDef</span>
            <span class="n">c_decs</span><span class="p">,</span> <span class="n">c_funcs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">decs</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="se">\n</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">decs</span><span class="p">,</span> <span class="n">c_decs</span><span class="p">)</span>
            <span class="n">body</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="se">\n</span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">c_funcs</span><span class="p">)</span>
        <span class="c1"># ...</span>

        <span class="n">contains</span> <span class="o">=</span> <span class="s1">&#39;contains</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">funcs</span> <span class="ow">or</span> <span class="n">expr</span><span class="o">.</span><span class="n">classes</span> <span class="ow">or</span> <span class="n">expr</span><span class="o">.</span><span class="n">interfaces</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="n">imports</span> <span class="o">+=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_imports</span><span class="p">)</span>
        <span class="n">imports</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_constant_imports</span><span class="p">()</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;module </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                 <span class="n">imports</span><span class="p">,</span>
                 <span class="s1">&#39;implicit none</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
                 <span class="n">private</span><span class="p">,</span>
                 <span class="n">decs</span><span class="p">,</span>
                 <span class="n">interfaces</span><span class="p">,</span>
                 <span class="n">contains</span><span class="p">,</span>
                 <span class="n">body</span><span class="p">,</span>
                 <span class="s1">&#39;end module </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">exit_scope</span><span class="p">()</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">parts</span> <span class="k">if</span> <span class="n">a</span><span class="p">])</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Program"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Program">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Program</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_scope</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">scope</span><span class="p">)</span>

        <span class="n">name</span>    <span class="o">=</span> <span class="s1">&#39;prog_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">imports</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">imports</span><span class="p">)</span>
        <span class="n">body</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>

        <span class="c1"># Print the declarations of all variables in the scope, which include:</span>
        <span class="c1">#  - user-defined variables (available in Program.variables)</span>
        <span class="c1">#  - pyccel-generated variables added to Scope when printing &#39;expr.body&#39;</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="n">decs</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_Declare</span><span class="p">(</span><span class="n">Declare</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">)</span>

        <span class="c1"># Detect if we are using mpi4py</span>
        <span class="c1"># TODO should we find a better way to do this?</span>
        <span class="n">mpi</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="s1">&#39;mpi4py&#39;</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">source</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">imports</span><span class="p">)</span>

        <span class="c1"># Additional code and variable declarations for MPI usage</span>
        <span class="c1"># TODO: check if we should really add them like this</span>
        <span class="k">if</span> <span class="n">mpi</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">=</span> <span class="s1">&#39;call mpi_init(ierr)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span>\
                   <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">allocate(status(0:-1 + mpi_status_size)) &#39;</span><span class="o">+</span>\
                   <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">status = 0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span>\
                   <span class="n">body</span> <span class="o">+</span>\
                   <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">call mpi_finalize(ierr)&#39;</span>

            <span class="n">decs</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">integer :: ierr = -1&#39;</span> <span class="o">+</span>\
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">integer, allocatable :: status (:)&#39;</span>
        <span class="n">imports</span> <span class="o">+=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_imports</span><span class="p">)</span>
        <span class="n">imports</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_constant_imports</span><span class="p">()</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;program </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                 <span class="n">imports</span><span class="p">,</span>
                <span class="s1">&#39;implicit none</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
                 <span class="n">decs</span><span class="p">,</span>
                 <span class="n">body</span><span class="p">,</span>
                <span class="s1">&#39;end program </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">exit_scope</span><span class="p">()</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">parts</span> <span class="k">if</span> <span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Import"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Import">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Import</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

        <span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">ignore</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">AsName</span><span class="p">):</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">target</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">source</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">DottedName</span><span class="p">):</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

        <span class="c1"># importing of pyccel extensions is not printed</span>
        <span class="k">if</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">pyccel_builtin_import_registery</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">source_module</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">source_module</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_expected_name</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;mpi4py&#39;</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">source</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="n">expr</span><span class="o">.</span><span class="n">source</span><span class="p">)):</span>
            <span class="k">return</span> <span class="s1">&#39;use mpi</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;use mpiext</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">target</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">Module</span><span class="p">)]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;use </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

        <span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">targets</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">InlineFunctionDef</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;use </span><span class="si">{}</span><span class="s1">, only:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
            <span class="n">old_name</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span>
            <span class="n">new_name</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">target</span>
            <span class="k">if</span> <span class="n">old_name</span> <span class="o">!=</span> <span class="n">new_name</span><span class="p">:</span>
                <span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{target}</span><span class="s1"> =&gt; </span><span class="si">{name}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">new_name</span><span class="p">,</span>
                                                     <span class="n">name</span><span class="o">=</span><span class="n">old_name</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{prefix}</span><span class="s1"> </span><span class="si">{target}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                                                  <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_name</span><span class="p">,</span> <span class="n">DottedName</span><span class="p">):</span>
                <span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">new_name</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{prefix}</span><span class="s1"> </span><span class="si">{target}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                                                  <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{prefix}</span><span class="s1"> </span><span class="si">{target}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                                                  <span class="n">target</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting str, PyccelSymbol, DottedName or AsName, &#39;</span>
                                <span class="s1">&#39;given </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>

            <span class="n">code</span> <span class="o">=</span> <span class="p">(</span><span class="n">code</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">line</span><span class="p">)</span> <span class="k">if</span> <span class="n">code</span> <span class="k">else</span> <span class="n">line</span>

        <span class="c1"># in some cases, the source is given as a string (when using metavar)</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_statement</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonPrint"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonPrint">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonPrint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">LiteralString</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="n">LiteralString</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">empty_end</span> <span class="o">=</span> <span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">LiteralString</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="s1">&#39;end&#39;</span><span class="p">)</span>
        <span class="n">space_end</span> <span class="o">=</span> <span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">LiteralString</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">),</span> <span class="s1">&#39;end&#39;</span><span class="p">)</span>
        <span class="n">empty_sep</span> <span class="o">=</span> <span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">LiteralString</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="s1">&#39;sep&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">expr</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">has_keyword</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">keyword</span> <span class="o">==</span> <span class="s1">&#39;sep&#39;</span><span class="p">:</span>
                    <span class="n">sep</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">value</span>
                <span class="k">elif</span> <span class="n">f</span><span class="o">.</span><span class="n">keyword</span> <span class="o">==</span> <span class="s1">&#39;end&#39;</span><span class="p">:</span>
                    <span class="n">end</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> not implemented as a keyworded argument&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">keyword</span><span class="p">),</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>
        <span class="n">args_format</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">orig_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">expr</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">has_keyword</span><span class="p">]</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>


        <span class="n">tuple_start</span> <span class="o">=</span> <span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">LiteralString</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">))</span>
        <span class="n">tuple_sep</span>   <span class="o">=</span> <span class="n">LiteralString</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
        <span class="n">tuple_end</span>   <span class="o">=</span> <span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">LiteralString</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">orig_args</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">keyword</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">InhomogeneousTupleVariable</span><span class="p">,</span> <span class="n">PythonTuple</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">args_format</span><span class="p">:</span>
                    <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatted_args_to_print</span><span class="p">(</span><span class="n">args_format</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
                    <span class="n">args_format</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">orig_args</span><span class="p">):</span>
                    <span class="n">end_of_tuple</span> <span class="o">=</span> <span class="n">empty_end</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">end_of_tuple</span> <span class="o">=</span> <span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">)</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">print_arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">tuple_elem</span> <span class="ow">in</span> <span class="n">f</span> <span class="k">for</span> <span class="n">print_arg</span> <span class="ow">in</span> <span class="p">(</span><span class="n">tuple_elem</span><span class="p">,</span> <span class="n">tuple_sep</span><span class="p">)][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">LiteralString</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))</span>
                <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PythonPrint</span><span class="p">([</span><span class="n">tuple_start</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">tuple_end</span><span class="p">,</span> <span class="n">empty_sep</span><span class="p">,</span> <span class="n">end_of_tuple</span><span class="p">],</span> <span class="n">file</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">file</span><span class="p">))</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">PythonType</span><span class="p">):</span>
                <span class="n">args_format</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">print_string</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">rank</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">args_format</span><span class="p">:</span>
                    <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatted_args_to_print</span><span class="p">(</span><span class="n">args_format</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
                    <span class="n">args_format</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">loop_scope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">create_new_loop_scope</span><span class="p">()</span>
                <span class="n">for_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_temporary_variable</span><span class="p">(</span><span class="n">NativeInteger</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
                <span class="n">max_index</span> <span class="o">=</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">for_range</span> <span class="o">=</span> <span class="n">PythonRange</span><span class="p">(</span><span class="n">max_index</span><span class="p">)</span>
                <span class="n">print_body</span> <span class="o">=</span> <span class="p">[</span><span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">for_index</span><span class="p">])]</span>
                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">print_body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">space_end</span><span class="p">)</span>

                <span class="n">for_body</span> <span class="o">=</span> <span class="p">[</span><span class="n">PythonPrint</span><span class="p">(</span><span class="n">print_body</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">file</span><span class="p">)]</span>
                <span class="n">for_loop</span> <span class="o">=</span> <span class="n">For</span><span class="p">(</span><span class="n">for_index</span><span class="p">,</span> <span class="n">for_range</span><span class="p">,</span> <span class="n">for_body</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">loop_scope</span><span class="p">)</span>
                <span class="n">for_end_char</span> <span class="o">=</span> <span class="n">LiteralString</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
                <span class="n">for_end</span> <span class="o">=</span> <span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">for_end_char</span><span class="p">,</span>
                                               <span class="n">keyword</span><span class="o">=</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>

                <span class="n">body</span> <span class="o">=</span> <span class="n">CodeBlock</span><span class="p">([</span><span class="n">PythonPrint</span><span class="p">([</span><span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">LiteralString</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)),</span> <span class="n">empty_end</span><span class="p">],</span>
                                                <span class="n">file</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">file</span><span class="p">),</span>
                                  <span class="n">for_loop</span><span class="p">,</span>
                                  <span class="n">PythonPrint</span><span class="p">([</span><span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">max_index</span><span class="p">]),</span> <span class="n">for_end</span><span class="p">],</span>
                                                <span class="n">file</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">file</span><span class="p">)],</span>
                                 <span class="n">unravelled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arg_format</span><span class="p">,</span> <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_print_format_and_arg</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">args_format</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg_format</span><span class="p">)</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatted_args_to_print</span><span class="p">(</span><span class="n">args_format</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._formatted_args_to_print"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._formatted_args_to_print">[docs]</a>    <span class="k">def</span> <span class="nf">_formatted_args_to_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fargs_format</span><span class="p">,</span> <span class="n">fargs</span><span class="p">,</span> <span class="n">fend</span><span class="p">,</span> <span class="n">fsep</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Produce a write statement from a list of formats, args and an end</span>
<span class="sd">        statement</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fargs_format : iterable</span>
<span class="sd">                       The format strings for the objects described by fargs</span>
<span class="sd">        fargs        : iterable</span>
<span class="sd">                       The args to be printed</span>
<span class="sd">        fend         : PyccelAstNode</span>
<span class="sd">                       The character describing the end of the line</span>
<span class="sd">        expr         : PyccelAstNode</span>
<span class="sd">                        The PythonPrint currently printed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fargs_format</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">]:</span>
            <span class="c1"># To print the result of a FunctionCall</span>
            <span class="k">return</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;print *&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">fargs</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>


        <span class="n">args_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_c</span> <span class="k">if</span> <span class="n">a_c</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="s2">&quot;&#39;&#39;&quot;</span> <span class="k">for</span> <span class="n">a_c</span> <span class="ow">in</span> <span class="n">fargs</span><span class="p">]</span>
        <span class="n">fend_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">fend</span><span class="p">)</span>
        <span class="n">advance</span> <span class="o">=</span> <span class="s2">&quot;yes&quot;</span> <span class="k">if</span> <span class="n">fend_code</span> <span class="o">==</span> <span class="s1">&#39;ACHAR(10)&#39;</span> <span class="k">else</span> <span class="s2">&quot;no&quot;</span>

        <span class="k">if</span> <span class="n">fsep</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">fargs_format</span> <span class="o">=</span> <span class="p">[</span><span class="n">af</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">fargs_format</span> <span class="k">for</span> <span class="n">af</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">args_list</span>    <span class="o">=</span> <span class="p">[</span><span class="n">af</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args_list</span> <span class="k">for</span> <span class="n">af</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">fsep</span><span class="p">)][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">fend_code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;ACHAR(10)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="n">fargs_format</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
            <span class="n">args_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fend_code</span><span class="p">)</span>

        <span class="n">args_code</span>       <span class="o">=</span> <span class="s1">&#39; , &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args_list</span><span class="p">)</span>
        <span class="n">args_formatting</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fargs_format</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">file</span> <span class="o">==</span> <span class="s2">&quot;stderr&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_constantImports</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ISO_FORTRAN_ENV&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>\
                <span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="s2">&quot;stderr&quot;</span><span class="p">,</span> <span class="s2">&quot;error_unit&quot;</span><span class="p">))</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;write(stderr, &#39;(</span><span class="si">{</span><span class="n">args_formatting</span><span class="si">}</span><span class="s2">)&#39;, advance=</span><span class="se">\&quot;</span><span class="si">{</span><span class="n">advance</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">) </span><span class="si">{</span><span class="n">args_code</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constantImports</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ISO_FORTRAN_ENV&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>\
                <span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="s2">&quot;stdout&quot;</span><span class="p">,</span> <span class="s2">&quot;output_unit&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;write(stdout, &#39;(</span><span class="si">{</span><span class="n">args_formatting</span><span class="si">}</span><span class="s2">)&#39;, advance=</span><span class="se">\&quot;</span><span class="si">{</span><span class="n">advance</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">) </span><span class="si">{</span><span class="n">args_code</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span></div>

<div class="viewcode-block" id="FCodePrinter._get_print_format_and_arg"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._get_print_format_and_arg">[docs]</a>    <span class="k">def</span> <span class="nf">_get_print_format_and_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">var</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the format string and the printable argument for an object.</span>
<span class="sd">        In other words get arg_format and arg such that var can be printed</span>
<span class="sd">        by doing:</span>

<span class="sd">        &gt; write(*, arg_format) arg</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        var : PyccelAstNode</span>
<span class="sd">              The object to be printed</span>

<span class="sd">        Results</span>
<span class="sd">        -------</span>
<span class="sd">        arg_format : str</span>
<span class="sd">                     The format string</span>
<span class="sd">        arg        : str</span>
<span class="sd">                     The fortran code which represents var</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">var_type</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">dtype</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">arg_format</span> <span class="o">=</span> <span class="n">type_to_print_format</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">var_type</span><span class="p">)]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> type is not supported currently&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_type</span><span class="p">),</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">var_type</span> <span class="ow">is</span> <span class="n">NativeComplex</span><span class="p">():</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">NumpyReal</span><span class="p">(</span><span class="n">var</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">NumpyImag</span><span class="p">(</span><span class="n">var</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">var_type</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">LiteralTrue</span><span class="p">):</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="s2">&quot;&#39;True&#39;&quot;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">LiteralFalse</span><span class="p">):</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="s2">&quot;&#39;False&#39;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="s1">&#39;merge(&quot;True &quot;, &quot;False&quot;, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">arg_format</span><span class="p">,</span> <span class="n">arg</span></div>

<div class="viewcode-block" id="FCodePrinter._print_SymbolicPrint"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_SymbolicPrint">[docs]</a>    <span class="k">def</span> <span class="nf">_print_SymbolicPrint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="c1"># for every expression we will generate a print</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;print *, &#39;sympy&gt; </span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_statement</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Comment"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Comment">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">comments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;!&#39;</span> <span class="o">+</span> <span class="n">comments</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_CommentBlock"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_CommentBlock">[docs]</a>    <span class="k">def</span> <span class="nf">_print_CommentBlock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">txts</span>   <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">comments</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">header</span>
        <span class="n">header_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>

        <span class="n">ln</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">txts</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ln</span><span class="o">&lt;</span><span class="nb">max</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">header_size</span><span class="o">+</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">ln</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">top</span>  <span class="o">=</span> <span class="s1">&#39;!&#39;</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">*</span><span class="nb">int</span><span class="p">((</span><span class="n">ln</span><span class="o">-</span><span class="n">header_size</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">header</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">*</span><span class="nb">int</span><span class="p">((</span><span class="n">ln</span><span class="o">-</span><span class="n">header_size</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;!&#39;</span>
        <span class="n">ln</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
        <span class="n">bottom</span> <span class="o">=</span> <span class="s1">&#39;!&#39;</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">*</span><span class="n">ln</span> <span class="o">+</span> <span class="s1">&#39;!&#39;</span>

        <span class="n">txts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;!&#39;</span> <span class="o">+</span> <span class="n">txt</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="n">ln</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">txt</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;!&#39;</span> <span class="k">for</span> <span class="n">txt</span> <span class="ow">in</span> <span class="n">txts</span><span class="p">]</span>

        <span class="n">body</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">txts</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{2}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_EmptyNode"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_EmptyNode">[docs]</a>    <span class="k">def</span> <span class="nf">_print_EmptyNode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_AnnotatedComment"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_AnnotatedComment">[docs]</a>    <span class="k">def</span> <span class="nf">_print_AnnotatedComment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">accel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">accel</span><span class="p">)</span>
        <span class="n">txt</span>   <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">txt</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;!$</span><span class="si">{0}</span><span class="s1"> </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accel</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_tuple"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_tuple">[docs]</a>    <span class="k">def</span> <span class="nf">_print_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39; tuple with elements of rank &gt; 0 is not implemented&#39;</span><span class="p">)</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;[</span><span class="si">{0}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonAbs"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonAbs">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonAbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; print the python builtin function abs</span>
<span class="sd">        args : variable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;abs(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonTuple"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonTuple">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonTuple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="p">)</span>
            <span class="n">shape</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">shape</span><span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;reshape([&#39;</span><span class="o">+</span> <span class="n">elements</span> <span class="o">+</span> <span class="s1">&#39;], &#39;</span><span class="o">+</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="n">shape</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;[</span><span class="si">{0}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonList"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonList">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_PythonTuple</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_InhomogeneousTupleVariable"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_InhomogeneousTupleVariable">[docs]</a>    <span class="k">def</span> <span class="nf">_print_InhomogeneousTupleVariable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;[</span><span class="si">{0}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Variable"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Variable">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_FunctionDefArgument"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_FunctionDefArgument">[docs]</a>    <span class="k">def</span> <span class="nf">_print_FunctionDefArgument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_FunctionCallArgument"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_FunctionCallArgument">[docs]</a>    <span class="k">def</span> <span class="nf">_print_FunctionCallArgument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">keyword</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">keyword</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">value</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Constant"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Constant">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">LiteralFloat</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_DottedVariable"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_DottedVariable">[docs]</a>    <span class="k">def</span> <span class="nf">_print_DottedVariable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">FunctionCall</span><span class="p">):</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="o">.</span><span class="n">funcdef</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_new_name</span><span class="p">()</span>
            <span class="n">var</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">insert_variable</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">Assign</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span> <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span> <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_DottedName"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_DottedName">[docs]</a>    <span class="k">def</span> <span class="nf">_print_DottedName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39; % &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Lambda"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Lambda">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Lambda</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&quot;</span><span class="si">{args}</span><span class="s1"> -&gt; </span><span class="si">{expr}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">,</span> <span class="n">expr</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">expr</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonLen"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonLen">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonLen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">arg</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span> <span class="k">else</span> <span class="n">var</span><span class="o">.</span><span class="n">rank</span>
        <span class="n">prec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

        <span class="n">dtype</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">dtype</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeString</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;len(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">var</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;size(</span><span class="si">{}</span><span class="s1">, kind=</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">),</span> <span class="n">prec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;size(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">idx</span><span class="p">),</span> <span class="n">prec</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonSum"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonSum">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonSum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;sum(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonReal"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonReal">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonReal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">internal_var</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;real(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonImag"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonImag">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonImag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">internal_var</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;aimag(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>



    <span class="c1">#========================== Numpy Elements ===============================#</span>

<div class="viewcode-block" id="FCodePrinter._print_NumpySum"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpySum">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpySum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fortran print.&quot;&quot;&quot;</span>

        <span class="n">rhs_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;sum(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rhs_code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyProduct"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyProduct">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyProduct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fortran print.&quot;&quot;&quot;</span>

        <span class="n">rhs_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;product(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rhs_code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyMatmul"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyMatmul">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyMatmul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fortran print.&quot;&quot;&quot;</span>
        <span class="n">a_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
        <span class="n">b_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">):</span>
                <span class="n">a_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PythonInt</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">a</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">):</span>
                <span class="n">b_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PythonInt</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">b</span><span class="p">))</span>
            <span class="k">return</span> <span class="s1">&#39;sum(</span><span class="si">{}</span><span class="s1">*</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_code</span><span class="p">,</span> <span class="n">b_code</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">order</span> <span class="ow">and</span> <span class="n">expr</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">order</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">order</span> <span class="o">!=</span> <span class="n">expr</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">order</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Mixed order matmul not supported.&quot;</span><span class="p">)</span>

        <span class="c1"># Fortran ordering</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;matmul(</span><span class="si">{0}</span><span class="s1">,</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_code</span><span class="p">,</span> <span class="n">b_code</span><span class="p">)</span>

        <span class="c1"># C ordering</span>
        <span class="k">return</span> <span class="s1">&#39;matmul(</span><span class="si">{1}</span><span class="s1">,</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_code</span><span class="p">,</span> <span class="n">b_code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyEmpty"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyEmpty">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyEmpty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">FORTRAN_ALLOCATABLE_IN_EXPRESSION</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyNorm"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyNorm">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyNorm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fortran print.&quot;&quot;&quot;</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">PythonAbs</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeComplex</span><span class="p">)</span> <span class="k">else</span> <span class="n">expr</span><span class="o">.</span><span class="n">arg</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">axis</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">axis</span>
            <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">order</span> <span class="o">!=</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">rank</span><span class="p">),</span> <span class="n">expr</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">python_value</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;Norm2(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">axis</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;Norm2(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyLinspace"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyLinspace">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyLinspace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">stop</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">or</span> <span class="n">expr</span><span class="o">.</span><span class="n">precision</span> <span class="o">!=</span> <span class="n">expr</span><span class="o">.</span><span class="n">stop</span><span class="o">.</span><span class="n">precision</span><span class="p">:</span>
            <span class="n">cast_func</span> <span class="o">=</span> <span class="n">DtypePrecisionToCastFunction</span><span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">expr</span><span class="o">.</span><span class="n">precision</span><span class="p">]</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">cast_func</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">LiteralFalse</span><span class="p">):</span>
            <span class="n">lhs</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">get_user_nodes</span><span class="p">(</span><span class="n">Assign</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lhs</span>


            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1">#expr.rank &gt; 1, we need to replace the last index of the loop with the last index of the array.</span>
                <span class="n">lhs_source</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">get_user_nodes</span><span class="p">(</span><span class="n">Assign</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lhs</span>
                <span class="n">lhs_source</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">ind</span><span class="p">,</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">num</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
                <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">lhs_source</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#Since the expr.rank == 1, we modify the last element in the array.</span>
                <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">IndexedElement</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span>
                                                 <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">num</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                                                 <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)))</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">LiteralTrue</span><span class="p">):</span>
                <span class="n">cond_template</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">+</span> <span class="s1">&#39; = </span><span class="si">{stop}</span><span class="s1">&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cond_template</span> <span class="o">=</span> <span class="n">lhs</span> <span class="o">+</span> <span class="s1">&#39; = merge(</span><span class="si">{stop}</span><span class="s1">, </span><span class="si">{lhs}</span><span class="s1">, (</span><span class="si">{cond}</span><span class="s1">))&#39;</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{start}</span><span class="s1"> + </span><span class="si">{index}</span><span class="s1">*</span><span class="si">{step}</span><span class="s1">)&#39;</span>
            <span class="n">var</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">ind</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;[((</span><span class="si">{start}</span><span class="s1"> + </span><span class="si">{index}</span><span class="s1">*</span><span class="si">{step}</span><span class="s1">), </span><span class="si">{index}</span><span class="s1"> = </span><span class="si">{zero}</span><span class="s1">,</span><span class="si">{end}</span><span class="s1">)]&#39;</span>
            <span class="n">var</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;linspace_index&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">insert_variable</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

        <span class="n">init_value</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">start</span><span class="p">),</span>
            <span class="n">step</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">step</span><span class="p">),</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">),</span>
            <span class="n">zero</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
            <span class="n">end</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PyccelMinus</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">num</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">LiteralFalse</span><span class="p">):</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">init_value</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">LiteralTrue</span><span class="p">):</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">init_value</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">cond_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stop</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">init_value</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">cond_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stop</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">lhs</span><span class="o">=</span><span class="n">lhs</span><span class="p">,</span> <span class="n">cond</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">endpoint</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyNonZeroElement"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyNonZeroElement">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyNonZeroElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

        <span class="n">ind</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_temporary_variable</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">))</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">array</span>

        <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">():</span>
            <span class="n">mask</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mask</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">NumpyBool</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

        <span class="n">my_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PythonRange</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">dim</span><span class="p">]))</span>

        <span class="n">stmt</span>  <span class="o">=</span> <span class="s1">&#39;pack([(</span><span class="si">{ind}</span><span class="s1">, </span><span class="si">{ind}</span><span class="s1">=</span><span class="si">{my_range}</span><span class="s1">)], </span><span class="si">{mask}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">ind</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">,</span> <span class="n">my_range</span> <span class="o">=</span> <span class="n">my_range</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">stmt</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyCountNonZero"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyCountNonZero">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyCountNonZero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

        <span class="n">axis</span>  <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">array</span>

        <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">():</span>
            <span class="n">mask</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mask</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">NumpyBool</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

        <span class="n">kind</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stmt</span> <span class="o">=</span> <span class="s1">&#39;count(</span><span class="si">{}</span><span class="s1">, kind = </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">kind</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">keep_dims</span><span class="o">.</span><span class="n">python_value</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
                    <span class="n">shape</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">shape</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="n">stmt</span> <span class="o">=</span> <span class="s1">&#39;reshape([</span><span class="si">{}</span><span class="s1">], [</span><span class="si">{}</span><span class="s1">])&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
                <span class="n">f_dim</span> <span class="o">=</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">rank</span><span class="p">),</span> <span class="n">expr</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">f_dim</span> <span class="o">=</span> <span class="n">PyccelAdd</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">dim</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">f_dim</span><span class="p">)</span>
            <span class="n">stmt</span> <span class="o">=</span> <span class="s1">&#39;count(</span><span class="si">{}</span><span class="s1">, dim = </span><span class="si">{}</span><span class="s1">, kind = </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">kind</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">keep_dims</span><span class="o">.</span><span class="n">python_value</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
                    <span class="n">shape</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">shape</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="n">stmt</span> <span class="o">=</span> <span class="s1">&#39;reshape([</span><span class="si">{}</span><span class="s1">], [</span><span class="si">{}</span><span class="s1">])&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">stmt</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyWhere"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyWhere">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyWhere</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">value_true</span>  <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">value_true</span>
        <span class="n">value_false</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">value_false</span>
        <span class="k">try</span> <span class="p">:</span>
            <span class="n">cast_func</span> <span class="o">=</span> <span class="n">DtypePrecisionToCastFunction</span><span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">expr</span><span class="o">.</span><span class="n">precision</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">PYCCEL_RESTRICTION_TODO</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">value_true</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">or</span> <span class="n">value_true</span><span class="o">.</span><span class="n">precision</span> <span class="o">!=</span> <span class="n">expr</span><span class="o">.</span><span class="n">precision</span><span class="p">:</span>
            <span class="n">value_true</span> <span class="o">=</span> <span class="n">cast_func</span><span class="p">(</span><span class="n">value_true</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value_false</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">or</span> <span class="n">value_false</span><span class="o">.</span><span class="n">precision</span> <span class="o">!=</span> <span class="n">expr</span><span class="o">.</span><span class="n">precision</span><span class="p">:</span>
            <span class="n">value_false</span> <span class="o">=</span> <span class="n">cast_func</span><span class="p">(</span><span class="n">value_false</span><span class="p">)</span>

        <span class="n">condition</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">condition</span><span class="p">)</span>
        <span class="n">value_true</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">value_true</span><span class="p">)</span>
        <span class="n">value_false</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">value_false</span><span class="p">)</span>

        <span class="n">stmt</span> <span class="o">=</span> <span class="s1">&#39;merge(</span><span class="si">{true}</span><span class="s1">, </span><span class="si">{false}</span><span class="s1">, </span><span class="si">{cond}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">true</span><span class="o">=</span><span class="n">value_true</span><span class="p">,</span>
                <span class="n">false</span><span class="o">=</span><span class="n">value_false</span><span class="p">,</span>
                <span class="n">cond</span><span class="o">=</span><span class="n">condition</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">stmt</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyArray"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyArray">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fortran print.&quot;&quot;&quot;</span>

        <span class="c1"># If Numpy array is stored with column-major ordering, transpose values</span>
        <span class="c1"># use reshape with order for rank &gt; 2</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">rhs_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
                <span class="n">rhs_code</span> <span class="o">=</span> <span class="s1">&#39;transpose(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rhs_code</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">expr</span><span class="o">.</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">args</span>     <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">]</span>
                <span class="n">new_args</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">ac</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
                        <span class="n">shape</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                        <span class="n">order</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                        <span class="n">ac</span>       <span class="o">=</span> <span class="s1">&#39;reshape(</span><span class="si">{}</span><span class="s1">, [</span><span class="si">{}</span><span class="s1">], order=[</span><span class="si">{}</span><span class="s1">])&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ac</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
                    <span class="n">new_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ac</span><span class="p">)</span>

                <span class="n">args</span>     <span class="o">=</span> <span class="n">new_args</span>
                <span class="n">rhs_code</span> <span class="o">=</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="s1">&#39; ,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
                <span class="n">shape</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="n">order</span>    <span class="o">=</span> <span class="p">[</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">expr</span><span class="o">.</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
                <span class="n">order</span>    <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span> <span class="n">order</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">order</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">order</span><span class="p">)</span>
                <span class="n">rhs_code</span> <span class="o">=</span> <span class="s1">&#39;reshape(</span><span class="si">{}</span><span class="s1">, [</span><span class="si">{}</span><span class="s1">], order=[</span><span class="si">{}</span><span class="s1">])&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rhs_code</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">expr</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">args</span>     <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">]</span>
                <span class="n">new_args</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">ac</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
                        <span class="n">shape</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">order</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">rank</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                        <span class="n">ac</span>       <span class="o">=</span> <span class="s1">&#39;reshape(</span><span class="si">{}</span><span class="s1">, [</span><span class="si">{}</span><span class="s1">], order=[</span><span class="si">{}</span><span class="s1">])&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ac</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
                    <span class="n">new_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ac</span><span class="p">)</span>

                <span class="n">args</span>     <span class="o">=</span> <span class="n">new_args</span>
                <span class="n">rhs_code</span> <span class="o">=</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="s1">&#39; ,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
                <span class="n">shape</span>    <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">rhs_code</span> <span class="o">=</span> <span class="s1">&#39;reshape(</span><span class="si">{}</span><span class="s1">, [</span><span class="si">{}</span><span class="s1">])&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rhs_code</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rhs_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">expr</span><span class="o">.</span><span class="n">order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rhs_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rhs_code</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyFloor"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyFloor">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyFloor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">result_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_MathFloor</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;real(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result_code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyArange"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyArange">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyArange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">start</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
        <span class="n">step</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
        <span class="n">shape</span>  <span class="o">=</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">index</span>  <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">NativeInteger</span><span class="p">(),</span> <span class="n">name</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_new_name</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">insert_variable</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;[(</span><span class="si">{start}</span><span class="s1"> + </span><span class="si">{step}</span><span class="s1"> * </span><span class="si">{index}</span><span class="s1">, </span><span class="si">{index}</span><span class="s1"> = </span><span class="si">{0}</span><span class="s1">, </span><span class="si">{shape}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">)]&#39;</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span>
                           <span class="n">start</span>  <span class="o">=</span> <span class="n">start</span><span class="p">,</span>
                           <span class="n">step</span>   <span class="o">=</span> <span class="n">step</span><span class="p">,</span>
                           <span class="n">index</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">index</span><span class="p">),</span>
                           <span class="n">shape</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">shape</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyMod"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyMod">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyMod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PyccelMod</span><span class="p">(</span><span class="o">*</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyArraySize"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyArraySize">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyArraySize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">init_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
        <span class="n">prec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;size(</span><span class="si">{0}</span><span class="s1">, kind=</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">init_value</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span></div>

    <span class="c1"># ======================================================================= #</span>
<div class="viewcode-block" id="FCodePrinter._print_PyccelArraySize"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelArraySize">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelArraySize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">init_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
        <span class="n">prec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="o">.</span><span class="n">rank</span><span class="p">),</span> <span class="n">expr</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">PyccelAdd</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;size(</span><span class="si">{0}</span><span class="s1">, kind=</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">init_value</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;size(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">init_value</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonInt"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonInt">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonInt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()):</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;MERGE(1_</span><span class="si">{0}</span><span class="s1">, 0_</span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code</span>  <span class="o">=</span> <span class="s1">&#39;Int(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonFloat"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonFloat">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonFloat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()):</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;MERGE(1.0_</span><span class="si">{0}</span><span class="s1">, 0.0_</span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code</span>  <span class="o">=</span> <span class="s1">&#39;Real(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._print_MathFloor"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_MathFloor">[docs]</a>    <span class="k">def</span> <span class="nf">_print_MathFloor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">arg_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

        <span class="c1"># math.floor on integer argument is identity,</span>
        <span class="c1"># but we need parentheses around expressions</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arg_code</span><span class="p">)</span>

        <span class="n">prec</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">precision</span>
        <span class="n">prec_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;floor(</span><span class="si">{}</span><span class="s1">, kind=</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arg_code</span><span class="p">,</span> <span class="n">prec_code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonComplex"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonComplex">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonComplex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_cast</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">internal_var</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;cmplx(</span><span class="si">{0}</span><span class="s1">, kind=</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">real</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
            <span class="n">imag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;cmplx(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="n">imag</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonBool"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonBool">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonBool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;logical(</span><span class="si">{}</span><span class="s1">, kind = </span><span class="si">{prec}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">),</span> <span class="n">prec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1"> /= 0)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyRand"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyRand">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyRand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">rank</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">FORTRAN_ALLOCATABLE_IN_EXPRESSION</span><span class="p">,</span>
                          <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_new_name</span><span class="p">()</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">memory_handling</span> <span class="o">=</span> <span class="s1">&#39;stack&#39;</span><span class="p">,</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">precision</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span>
                <span class="n">order</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">rank</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rank</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">insert_variable</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">Assign</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">expr</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyRandint"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyRandint">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyRandint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">rank</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">FORTRAN_ALLOCATABLE_IN_EXPRESSION</span><span class="p">,</span>
                          <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">low</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">randfloat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PyccelMul</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">NumpyRand</span><span class="p">(),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">randfloat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PyccelAdd</span><span class="p">(</span><span class="n">PyccelMul</span><span class="p">(</span><span class="n">PyccelMinus</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">high</span><span class="p">,</span> <span class="n">expr</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="n">NumpyRand</span><span class="p">(),</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">expr</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>

        <span class="n">prec_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;floor(</span><span class="si">{}</span><span class="s1">, kind=</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">randfloat</span><span class="p">,</span> <span class="n">prec_code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyFull"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyFull">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyFull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

        <span class="c1"># Create statement for initialization</span>
        <span class="n">init_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">fill_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">init_value</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonMin"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonMin">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonMin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;minval(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;min(&#39;</span><span class="o">+</span><span class="n">code</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_statement</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonMax"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonMax">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonMax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;maxval(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;max(&#39;</span><span class="o">+</span><span class="n">code</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_statement</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></div>

    <span class="c1"># ... MACROS</span>
<div class="viewcode-block" id="FCodePrinter._print_MacroShape"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_MacroShape">[docs]</a>    <span class="k">def</span> <span class="nf">_print_MacroShape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">argument</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="n">Variable</span><span class="p">,</span> <span class="n">IndexedElement</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expecting a variable, given </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">var</span><span class="p">)))</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">shape</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


        <span class="k">elif</span> <span class="ow">not</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span></div>

    <span class="c1"># ...</span>
<div class="viewcode-block" id="FCodePrinter._print_MacroType"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_MacroType">[docs]</a>    <span class="k">def</span> <span class="nf">_print_MacroType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">prec</span>  <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">precision</span>

        <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;integer&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prec</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;MPI_INTEGER&#39;</span>
            <span class="k">elif</span> <span class="n">prec</span><span class="o">==</span><span class="mi">8</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;MPI_INTEGER8&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">PYCCEL_RESTRICTION_TODO</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prec</span><span class="o">==</span><span class="mi">8</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;MPI_DOUBLE&#39;</span>
            <span class="k">if</span> <span class="n">prec</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;MPI_FLOAT&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">PYCCEL_RESTRICTION_TODO</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">PYCCEL_RESTRICTION_TODO</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_MacroCount"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_MacroCount">[docs]</a>    <span class="k">def</span> <span class="nf">_print_MacroCount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

        <span class="n">var</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">argument</span>

        <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;1&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">PyccelMul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">simplify</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Declare"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Declare">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Declare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="c1"># ... ignored declarations</span>
        <span class="c1"># we don&#39;t print the declaration if iterable object</span>
        <span class="k">if</span> <span class="n">is_iterable_datatype</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="n">is_with_construct_datatype</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeSymbol</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeRange</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># meta-variables</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)</span> <span class="ow">and</span>
            <span class="n">expr</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)):</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="c1"># ...</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">InhomogeneousTupleVariable</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_Declare</span><span class="p">(</span><span class="n">Declare</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">intent</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">intent</span><span class="p">,</span> <span class="n">static</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">static</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>

        <span class="c1"># ... TODO improve</span>
        <span class="c1"># Group the variables by intent</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">variable</span>
        <span class="n">rank</span>            <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">rank</span>
        <span class="n">shape</span>           <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">alloc_shape</span>
        <span class="n">is_target</span>       <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">is_target</span>
        <span class="n">is_const</span>        <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">is_const</span>
        <span class="n">is_optional</span>     <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">is_optional</span>
        <span class="n">is_private</span>      <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">is_private</span>
        <span class="n">is_alias</span>        <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">is_alias</span>
        <span class="n">on_heap</span>         <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">on_heap</span>
        <span class="n">on_stack</span>        <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">on_stack</span>
        <span class="n">is_static</span>       <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">static</span>
        <span class="n">is_external</span>     <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">external</span>
        <span class="n">intent</span>          <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">intent</span>
        <span class="n">intent_in</span> <span class="o">=</span> <span class="n">intent</span> <span class="ow">and</span> <span class="n">intent</span> <span class="o">!=</span> <span class="s1">&#39;out&#39;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span><span class="n">PythonTuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># ...</span>

        <span class="c1"># ... print datatype</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">CustomDataType</span><span class="p">):</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span>

            <span class="n">name</span>   <span class="o">=</span> <span class="n">dtype</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="n">dtype</span><span class="o">.</span><span class="n">prefix</span>
            <span class="n">alias</span>  <span class="o">=</span> <span class="n">dtype</span><span class="o">.</span><span class="n">alias</span>

            <span class="k">if</span> <span class="n">dtype</span><span class="o">.</span><span class="n">is_polymorphic</span> <span class="ow">or</span> <span class="n">expr</span><span class="o">.</span><span class="n">passed_from_dotted</span><span class="p">:</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="s1">&#39;class&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="s1">&#39;type&#39;</span>

            <span class="k">if</span> <span class="n">alias</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">alias</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">(</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">expr_dtype</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr_dtype</span><span class="p">)</span>

        <span class="c1"># ...</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr_dtype</span><span class="p">,</span> <span class="n">NativeString</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">intent_in</span><span class="p">:</span>
                    <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">[:</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span><span class="s1">&#39;(len =*)&#39;</span>
                    <span class="c1">#TODO improve ,this is the case of character as argument</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr_dtype</span><span class="p">,</span> <span class="n">BindCPointer</span><span class="p">):</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;type(c_ptr)&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_constantImports</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ISO_C_Binding&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;c_ptr&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dtype</span> <span class="o">+=</span> <span class="s1">&#39;(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">variable</span><span class="p">))</span>

        <span class="n">code_value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">code_value</span> <span class="o">=</span> <span class="s1">&#39; = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>

        <span class="n">vstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># arrays are 0-based in pyccel, to avoid ambiguity with range</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">is_static</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">on_heap</span> <span class="ow">or</span> <span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># Default empty strings</span>
        <span class="n">intentstr</span>      <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">allocatablestr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">optionalstr</span>    <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">privatestr</span>     <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">rankstr</span>        <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">externalstr</span>    <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># Compute intent string</span>
        <span class="k">if</span> <span class="n">intent</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">intent</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span> <span class="ow">and</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">is_static</span> <span class="ow">and</span> <span class="n">is_optional</span><span class="p">):</span>
                <span class="n">intentstr</span> <span class="o">=</span> <span class="s1">&#39;, value&#39;</span>
                <span class="k">if</span> <span class="n">is_const</span><span class="p">:</span>
                    <span class="n">intentstr</span> <span class="o">+=</span> <span class="s1">&#39;, intent(in)&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">intentstr</span> <span class="o">=</span> <span class="s1">&#39;, intent(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">intent</span><span class="p">)</span>

        <span class="c1"># Compute allocatable string</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_static</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_alias</span><span class="p">:</span>
                <span class="n">allocatablestr</span> <span class="o">=</span> <span class="s1">&#39;, pointer&#39;</span>

            <span class="k">elif</span> <span class="n">on_heap</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">intent_in</span><span class="p">:</span>
                <span class="n">allocatablestr</span> <span class="o">=</span> <span class="s1">&#39;, allocatable&#39;</span>

            <span class="c1"># ISSUES #177: var is allocatable and target</span>
            <span class="k">if</span> <span class="n">is_target</span><span class="p">:</span>
                <span class="n">allocatablestr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">, target&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">allocatablestr</span><span class="p">)</span>

        <span class="c1"># Compute optional string</span>
        <span class="k">if</span> <span class="n">is_optional</span><span class="p">:</span>
            <span class="n">optionalstr</span> <span class="o">=</span> <span class="s1">&#39;, optional&#39;</span>

        <span class="c1"># Compute private string</span>
        <span class="k">if</span> <span class="n">is_private</span><span class="p">:</span>
            <span class="n">privatestr</span> <span class="o">=</span> <span class="s1">&#39;, private&#39;</span>

        <span class="c1"># Compute external string</span>
        <span class="k">if</span> <span class="n">is_external</span><span class="p">:</span>
            <span class="n">externalstr</span> <span class="o">=</span> <span class="s1">&#39;, external&#39;</span>

        <span class="c1"># Compute rank string</span>
        <span class="c1"># TODO: improve</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">PyccelAstNode</span><span class="p">)))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">is_static</span> <span class="ow">or</span> <span class="n">on_stack</span><span class="p">)):</span>
            <span class="n">rankstr</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{0}</span><span class="s1">:</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PyccelMinus</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)))</span>

        <span class="k">elif</span> <span class="p">((</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">PythonTuple</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">is_static</span> <span class="ow">or</span> <span class="n">on_stack</span><span class="p">)):</span>
            <span class="c1">#TODO fix bug when we include shape of type list</span>

            <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
                <span class="n">rankstr</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">:</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">s</span><span class="p">),</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PyccelMinus</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rankstr</span> <span class="o">=</span>  <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">:</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">s</span><span class="p">),</span>
                                                     <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PyccelMinus</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">shape</span><span class="p">)</span>
            <span class="n">rankstr</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{rank}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rank</span><span class="o">=</span><span class="n">rankstr</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">on_heap</span> <span class="ow">and</span> <span class="n">intent_in</span><span class="p">:</span>
            <span class="n">rankstr</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;0:&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">rank</span><span class="p">))</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">on_heap</span> <span class="ow">or</span> <span class="n">is_alias</span><span class="p">):</span>
            <span class="n">rankstr</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">rank</span><span class="p">))</span>

<span class="c1">#        else:</span>
<span class="c1">#            errors.report(PYCCEL_RESTRICTION_TODO, symbol=expr,</span>
<span class="c1">#                severity=&#39;fatal&#39;)</span>

        <span class="n">mod_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">module_variable</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_private</span> <span class="ow">and</span> <span class="p">(</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">mod_str</span> <span class="o">=</span> <span class="s1">&#39;, bind(c)&#39;</span>

        <span class="c1"># Construct declaration</span>
        <span class="n">left</span>  <span class="o">=</span> <span class="n">dtype</span> <span class="o">+</span> <span class="n">allocatablestr</span> <span class="o">+</span> <span class="n">optionalstr</span> <span class="o">+</span> <span class="n">privatestr</span> <span class="o">+</span> <span class="n">externalstr</span> <span class="o">+</span> <span class="n">mod_str</span> <span class="o">+</span> <span class="n">intentstr</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">vstr</span> <span class="o">+</span> <span class="n">rankstr</span> <span class="o">+</span> <span class="n">code_value</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> :: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_AliasAssign"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_AliasAssign">[docs]</a>    <span class="k">def</span> <span class="nf">_print_AliasAssign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">lhs</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rhs</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">InhomogeneousTupleVariable</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">CodeBlock</span><span class="p">([</span><span class="n">AliasAssign</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">rhs</span><span class="p">)]))</span>

        <span class="c1"># TODO improve</span>
        <span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;=&gt;&#39;</span>
        <span class="n">shape_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">lhs</span><span class="o">.</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">shape_code</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;0:&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lhs</span><span class="o">.</span><span class="n">rank</span><span class="p">))</span>
            <span class="n">shape_code</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{s_c}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s_c</span> <span class="o">=</span> <span class="n">shape_code</span><span class="p">)</span>

        <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{lhs}{s_c}</span><span class="s1"> </span><span class="si">{op}</span><span class="s1"> </span><span class="si">{rhs}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="p">),</span>
                                          <span class="n">s_c</span> <span class="o">=</span> <span class="n">shape_code</span><span class="p">,</span>
                                          <span class="n">op</span><span class="o">=</span><span class="n">op</span><span class="p">,</span>
                                          <span class="n">rhs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">rhs</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_statement</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_CodeBlock"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_CodeBlock">[docs]</a>    <span class="k">def</span> <span class="nf">_print_CodeBlock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">expr</span><span class="o">.</span><span class="n">unravelled</span><span class="p">:</span>
            <span class="n">body_exprs</span> <span class="o">=</span> <span class="n">expand_to_loops</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_temporary_variable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span>
                    <span class="n">language_has_vectors</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">body_exprs</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">body</span>
        <span class="n">body_stmts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">body_exprs</span> <span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span><span class="p">):</span>
                <span class="n">body_stmts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">body_stmts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">body_stmts</span><span class="p">)</span></div>

    <span class="c1"># TODO the ifs as they are are, is not optimal =&gt; use elif</span>
<div class="viewcode-block" id="FCodePrinter._print_SymbolicAssign"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_SymbolicAssign">[docs]</a>    <span class="k">def</span> <span class="nf">_print_SymbolicAssign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">FOUND_SYMBOLIC_ASSIGN</span><span class="p">,</span>
                      <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;warning&#39;</span><span class="p">)</span>

        <span class="n">stmt</span> <span class="o">=</span> <span class="n">Comment</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_Comment</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyReal"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyReal">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyReal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">internal_var</span><span class="p">)</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;Real(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Assign"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Assign">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">rhs</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">FunctionCall</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>

        <span class="n">lhs_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
        <span class="c1"># we don&#39;t print Range</span>
        <span class="c1"># TODO treat the case of iterable classes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">PyccelUnarySub</span><span class="p">)</span> <span class="ow">and</span> <span class="n">rhs</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">INF</span><span class="p">:</span>
            <span class="n">rhs_code</span> <span class="o">=</span> <span class="s1">&#39;-Huge(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs_code</span><span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs_code</span><span class="p">,</span> <span class="n">rhs_code</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rhs</span> <span class="o">==</span> <span class="n">INF</span><span class="p">:</span>
            <span class="n">rhs_code</span> <span class="o">=</span> <span class="s1">&#39;Huge(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs_code</span><span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs_code</span><span class="p">,</span> <span class="n">rhs_code</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="p">(</span><span class="n">PythonRange</span><span class="p">,</span> <span class="n">Product</span><span class="p">)):</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">NumpyRand</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;call random_number(</span><span class="si">{0}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">NumpyEmpty</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">NumpyNonZero</span><span class="p">):</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">lhs</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">lhs</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rhs</span><span class="o">.</span><span class="n">elements</span><span class="p">):</span>
                <span class="n">l_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">lhs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">e_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l_c</span><span class="p">,</span><span class="n">e_c</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">code</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">ConstructorCall</span><span class="p">):</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">func</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="c1"># TODO uncomment later</span>

<span class="c1">#            # we don&#39;t print the constructor call if iterable object</span>
<span class="c1">#            if this.dtype.is_iterable:</span>
<span class="c1">#                return &#39;&#39;</span>
<span class="c1">#</span>
<span class="c1">#            # we don&#39;t print the constructor call if with construct object</span>
<span class="c1">#            if this.dtype.is_with_construct:</span>
<span class="c1">#                return &#39;&#39;</span>

            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;__init__&quot;</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;create&quot;</span>
            <span class="n">rhs_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">rhs_code</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> % </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs_code</span><span class="p">,</span> <span class="n">rhs_code</span><span class="p">)</span>

            <span class="n">code_args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rhs</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;call </span><span class="si">{0}</span><span class="s1">(</span><span class="si">{1}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rhs_code</span><span class="p">,</span> <span class="n">code_args</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="n">Variable</span><span class="p">)</span> <span class="ow">and</span>
              <span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">NativeSymbol</span><span class="p">()):</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># Right-hand side code</span>
        <span class="n">rhs_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>

        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="c1"># if (expr.status == &#39;unallocated&#39;) and not (expr.like is None):</span>
        <span class="c1">#     stmt = ZerosLike(lhs=lhs_code, rhs=expr.like)</span>
        <span class="c1">#     code += self._print(stmt)</span>
        <span class="c1">#     code += &#39;\n&#39;</span>
        <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs_code</span><span class="p">,</span> <span class="n">rhs_code</span><span class="p">)</span>
<span class="c1">#        else:</span>
<span class="c1">#            code_args = &#39;&#39;</span>
<span class="c1">#            func = expr.rhs</span>
<span class="c1">#            # func here is of instance FunctionCall</span>
<span class="c1">#            cls_name = func.func.cls_name</span>
<span class="c1">#            keys = func.func.arguments</span>

<span class="c1">#            # for MPI statements, we need to add the lhs as the last argument</span>
<span class="c1">#            # TODO improve</span>
<span class="c1">#            if isinstance(func.func, MPI):</span>
<span class="c1">#                if not func.arguments:</span>
<span class="c1">#                    code_args = lhs_code</span>
<span class="c1">#                else:</span>
<span class="c1">#                    code_args = &#39;, &#39;.join(self._print(i) for i in func.arguments)</span>
<span class="c1">#                    code_args = &#39;{0}, {1}&#39;.format(code_args, lhs_code)</span>
<span class="c1">#            else:</span>
<span class="c1">#                _ij_print = lambda i, j: &#39;{0}={1}&#39;.format(self._print(i), \</span>
<span class="c1">#                                                         self._print(j))</span>
<span class="c1">#</span>
<span class="c1">#                code_args = &#39;, &#39;.join(_ij_print(i, j) \</span>
<span class="c1">#                                      for i, j in zip(keys, func.arguments))</span>
<span class="c1">#            if (not func.arguments is None) and (len(func.arguments) &gt; 0):</span>
<span class="c1">#                if (not cls_name):</span>
<span class="c1">#                    code_args = &#39;, &#39;.join(self._print(i) for i in func.arguments)</span>
<span class="c1">#                    code_args = &#39;{0}, {1}&#39;.format(code_args, lhs_code)</span>
<span class="c1">#                else:</span>
<span class="c1">#            print(&#39;code_args &gt; {0}&#39;.format(code_args))</span>
<span class="c1">#            code = &#39;call {0}({1})&#39;.format(rhs_code, code_args)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_statement</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<span class="c1">#------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="FCodePrinter._print_Allocate"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Allocate">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Allocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

        <span class="c1"># Transpose indices because of Fortran column-major ordering</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">shape</span> <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span> <span class="k">else</span> <span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">var_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
        <span class="n">size_code</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">shape</span><span class="p">)</span>
        <span class="n">shape_code</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;0:&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PyccelMinus</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">shape</span><span class="p">)</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;unallocated&#39;</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;allocate(</span><span class="si">{0}</span><span class="s1">(</span><span class="si">{1}</span><span class="s1">))</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_code</span><span class="p">,</span> <span class="n">shape_code</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">expr</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;unknown&#39;</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;if (allocated(</span><span class="si">{}</span><span class="s1">)) then</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_code</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;  if (any(size(</span><span class="si">{}</span><span class="s1">) /= [</span><span class="si">{}</span><span class="s1">])) then</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_code</span><span class="p">,</span> <span class="n">size_code</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;    deallocate(</span><span class="si">{}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span>     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_code</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;    allocate(</span><span class="si">{0}</span><span class="s1">(</span><span class="si">{1}</span><span class="s1">))</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_code</span><span class="p">,</span> <span class="n">shape_code</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;  end if</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;else</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;  allocate(</span><span class="si">{0}</span><span class="s1">(</span><span class="si">{1}</span><span class="s1">))</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_code</span><span class="p">,</span> <span class="n">shape_code</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;end if</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">elif</span> <span class="n">expr</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;allocated&#39;</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;if (any(size(</span><span class="si">{}</span><span class="s1">) /= [</span><span class="si">{}</span><span class="s1">])) then</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_code</span><span class="p">,</span> <span class="n">size_code</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;  deallocate(</span><span class="si">{}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span>     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_code</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;  allocate(</span><span class="si">{0}</span><span class="s1">(</span><span class="si">{1}</span><span class="s1">))</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_code</span><span class="p">,</span> <span class="n">shape_code</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;end if</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">return</span> <span class="n">code</span></div>

<span class="c1">#-----------------------------------------------------------------------------</span>
<div class="viewcode-block" id="FCodePrinter._print_Deallocate"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Deallocate">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Deallocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">variable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">InhomogeneousTupleVariable</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">Deallocate</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">var</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">is_alias</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
            <span class="n">code</span>  <span class="o">=</span> <span class="s1">&#39;if (allocated(</span><span class="si">{}</span><span class="s1">)) then</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_code</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;  deallocate(</span><span class="si">{}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span>     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_code</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="s1">&#39;end if</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">return</span> <span class="n">code</span></div>
<span class="c1">#------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="FCodePrinter._print_NativeBool"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NativeBool">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NativeBool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;logical&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NativeInteger"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NativeInteger">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NativeInteger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;integer&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NativeFloat"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NativeFloat">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NativeFloat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;real&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NativeComplex"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NativeComplex">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NativeComplex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;complex&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NativeString"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NativeString">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NativeString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;character(len=280)&#39;</span></div>
        <span class="c1">#TODO fix improve later</span>

<div class="viewcode-block" id="FCodePrinter._print_DataType"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_DataType">[docs]</a>    <span class="k">def</span> <span class="nf">_print_DataType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_LiteralString"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_LiteralString">[docs]</a>    <span class="k">def</span> <span class="nf">_print_LiteralString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">sp_chars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\a</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\b</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\v</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="n">sub_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">formatted_str</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sp_chars</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sub_str</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">formatted_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sub_str</span><span class="p">))</span>
                    <span class="n">sub_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">formatted_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;ACHAR(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sub_str</span> <span class="o">+=</span> <span class="n">c</span>
        <span class="k">if</span> <span class="n">sub_str</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">formatted_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sub_str</span><span class="p">))</span>
        <span class="k">return</span> <span class="s1">&#39; // &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formatted_str</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Interface"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Interface">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Interface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="c1"># ... we don&#39;t print &#39;hidden&#39; functions</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">FunctionAddress</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">functions</span><span class="p">):</span>
            <span class="n">funcs</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">functions</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">functions</span> <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> \
                    <span class="n">expr</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="s1">&#39;arg_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span> \
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">arguments</span><span class="p">)],</span> <span class="n">use_final_precision</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_argument</span><span class="p">:</span>
            <span class="n">funcs_sigs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_signature</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}</span><span class="s2">) </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">],</span> <span class="n">parts</span><span class="p">[</span><span class="s1">&#39;arg_code&#39;</span><span class="p">],</span> <span class="n">parts</span><span class="p">[</span><span class="s1">&#39;func_end&#39;</span><span class="p">]),</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">print_constant_imports</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="n">parts</span><span class="p">[</span><span class="s1">&#39;arg_decs&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;end </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="s1">&#39;func_type&#39;</span><span class="p">],</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">)]</span>
                <span class="n">funcs_sigs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">))</span>
            <span class="n">interface</span> <span class="o">=</span> <span class="s1">&#39;interface</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">funcs_sigs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;end interface</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">return</span> <span class="n">interface</span>

        <span class="k">if</span> <span class="n">funcs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cls_name</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">_default_methods</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">cls_name</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">cls_name</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">cls_name</span> <span class="o">==</span> <span class="s1">&#39;__UNDEFINED__&#39;</span><span class="p">):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cls_name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_default_methods</span><span class="p">:</span>
                <span class="c1"># because we may have a class Point with init: Point___init__</span>
                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">_default_methods</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">interface</span> <span class="o">=</span> <span class="s1">&#39;interface &#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>
            <span class="n">interface</span> <span class="o">+=</span> <span class="s1">&#39;module procedure &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">interface</span> <span class="o">+=</span> <span class="s1">&#39;end interface</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">interface</span></div>



   <span class="c1"># def _print_With(self, expr):</span>
   <span class="c1">#     self.set_scope(expr)</span>
   <span class="c1">#     test = &#39;call &#39;+self._print(expr.test) + &#39;%__enter__()&#39;</span>
   <span class="c1">#     body = self._print(expr.body)</span>
   <span class="c1">#     end = &#39;call &#39;+self._print(expr.test) + &#39;%__exit__()&#39;</span>
   <span class="c1">#     code = (&#39;{test}\n&#39;</span>
   <span class="c1">#            &#39;{body}\n&#39;</span>
   <span class="c1">#            &#39;{end}&#39;).format(test=test, body=body, end=end)</span>
        <span class="c1">#TODO return code later</span>
  <span class="c1">#      expr.block</span>
  <span class="c1">#      self.exit_scope()</span>
  <span class="c1">#      return &#39;&#39;</span>

<div class="viewcode-block" id="FCodePrinter._print_Block"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Block">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_scope</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">scope</span><span class="p">)</span>

        <span class="n">decs</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">decs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">dec</span><span class="p">]</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">body</span>

        <span class="n">body_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="n">prelude</span>   <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">decs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">exit_scope</span><span class="p">()</span>

        <span class="c1">#case of no local variables</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">decs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">body_code</span>

        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{name}</span><span class="s1"> : Block</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{prelude}</span><span class="se">\n</span><span class="s1">&#39;</span>
                 <span class="s1">&#39;</span><span class="si">{body}</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;end Block </span><span class="si">{name}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">prelude</span><span class="o">=</span><span class="n">prelude</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body_code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_BindCFunctionDef"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_BindCFunctionDef">[docs]</a>    <span class="k">def</span> <span class="nf">_print_BindCFunctionDef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">results</span>   <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">var</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">arguments</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">FunctionAddress</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">):</span>
            <span class="c1"># Functions with function addresses as arguments cannot be</span>
            <span class="c1"># exposed to python so there is no need to print their signature</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_scope</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">scope</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">functions</span><span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">expr</span>

        <span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>

        <span class="n">arguments_inout</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">arguments_inout</span>
        <span class="n">decs</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arguments</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">arguments_inout</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">intent</span><span class="o">=</span><span class="s1">&#39;inout&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">intent</span><span class="o">=</span><span class="s1">&#39;in&#39;</span>

            <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">intent</span><span class="o">=</span><span class="n">intent</span> <span class="p">,</span> <span class="n">static</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">decs</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>

        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">intent</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">static</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">decs</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>

        <span class="n">decs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_external_declarations</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">local_vars</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">decs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>
        <span class="n">vars_to_print</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vars_to_print</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">local_vars</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">):</span>
                <span class="n">decs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>

        <span class="n">func_type</span> <span class="o">=</span> <span class="s1">&#39;subroutine&#39;</span>
        <span class="n">func_end</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">func_type</span> <span class="o">=</span> <span class="s1">&#39;function&#39;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">func_end</span> <span class="o">=</span> <span class="s1">&#39;result(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">static</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">decs</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>

        <span class="c1"># ...</span>

        <span class="n">interfaces</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">interfaces</span><span class="p">)</span>
        <span class="n">arg_code</span>  <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">results</span> <span class="p">))</span>
        <span class="n">imports</span>   <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">imports</span><span class="p">)</span>
        <span class="n">prelude</span>   <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">decs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">body_code</span> <span class="o">=</span> <span class="n">body</span>
        <span class="n">doc_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">doc_string</span><span class="p">)</span> <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">doc_string</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">exit_scope</span><span class="p">()</span>

        <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">doc_string</span><span class="p">,</span>
                <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1">(</span><span class="si">{2}</span><span class="s1">) bind(c) </span><span class="si">{3}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func_type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">arg_code</span><span class="p">,</span> <span class="n">func_end</span><span class="p">),</span>
                 <span class="n">imports</span><span class="p">,</span>
                <span class="s1">&#39;implicit none</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
                 <span class="n">prelude</span><span class="p">,</span>
                 <span class="n">interfaces</span><span class="p">,</span>
                 <span class="n">body_code</span><span class="p">,</span>
                 <span class="s1">&#39;end </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func_type</span><span class="p">,</span> <span class="n">name</span><span class="p">)]</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parts</span> <span class="k">if</span> <span class="n">p</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_FunctionAddress"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_FunctionAddress">[docs]</a>    <span class="k">def</span> <span class="nf">_print_FunctionAddress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">name</span></div>

<div class="viewcode-block" id="FCodePrinter.function_signature"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter.function_signature">[docs]</a>    <span class="k">def</span> <span class="nf">function_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">is_pure</span>      <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_pure</span>
        <span class="n">is_elemental</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_elemental</span>
        <span class="n">out_args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">args_decs</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">var</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">arguments</span><span class="p">]</span>

        <span class="n">func_end</span>  <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="s1">&#39;recursive &#39;</span> <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_recursive</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">expr</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">func_type</span> <span class="o">=</span> <span class="s1">&#39;subroutine&#39;</span>
            <span class="n">out_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">out_args</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
                    <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">intent</span><span class="o">=</span><span class="s1">&#39;inout&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">intent</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
                <span class="n">args_decs</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>

            <span class="n">functions</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">functions</span>

        <span class="k">else</span><span class="p">:</span>
           <span class="c1">#todo: if return is a function</span>
            <span class="n">func_type</span> <span class="o">=</span> <span class="s1">&#39;function&#39;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">functions</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">functions</span>

            <span class="n">func_end</span> <span class="o">=</span> <span class="s1">&#39;result(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
            <span class="n">args_decs</span><span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>
        <span class="c1"># ...</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arguments</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">expr</span><span class="o">.</span><span class="n">cls_name</span><span class="p">:</span>
                    <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">intent</span><span class="o">=</span><span class="s1">&#39;inout&#39;</span><span class="p">,</span> <span class="n">passed_from_dotted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">expr</span><span class="o">.</span><span class="n">arguments_inout</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">intent</span><span class="o">=</span><span class="s1">&#39;inout&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">intent</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
                <span class="n">args_decs</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>

        <span class="c1">#remove parametres intent(inout) from out_args to prevent repetition</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">out_args</span><span class="p">:</span>
                <span class="n">out_args</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="c1"># treat case of pure function</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}{1}</span><span class="s1"> </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span> <span class="n">func_type</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_pure</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="s1">&#39;pure </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>

        <span class="c1"># treat case of elemental function</span>
        <span class="k">if</span> <span class="n">is_elemental</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="s1">&#39;elemental </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>

        <span class="n">arg_code</span>  <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">out_args</span> <span class="p">))</span>

        <span class="n">arg_decs</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">args_decs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="n">parts</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;sig&#39;</span> <span class="p">:</span> <span class="n">sig</span><span class="p">,</span>
                <span class="s1">&#39;arg_code&#39;</span> <span class="p">:</span> <span class="n">arg_code</span><span class="p">,</span>
                <span class="s1">&#39;func_end&#39;</span> <span class="p">:</span> <span class="n">func_end</span><span class="p">,</span>
                <span class="s1">&#39;arg_decs&#39;</span> <span class="p">:</span> <span class="n">arg_decs</span><span class="p">,</span>
                <span class="s1">&#39;func_type&#39;</span> <span class="p">:</span> <span class="n">func_type</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">parts</span></div>

<div class="viewcode-block" id="FCodePrinter._print_FunctionDef"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_FunctionDef">[docs]</a>    <span class="k">def</span> <span class="nf">_print_FunctionDef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_inline</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_scope</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">scope</span><span class="p">)</span>


        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">cls_name</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">_default_methods</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

            <span class="n">cls_name</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">cls_name</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">cls_name</span> <span class="o">==</span> <span class="s1">&#39;__UNDEFINED__&#39;</span><span class="p">):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cls_name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_default_methods</span><span class="p">:</span>
                <span class="c1"># because we may have a class Point with init: Point___init__</span>
                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">_default_methods</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">sig_parts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_signature</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">prelude</span> <span class="o">=</span> <span class="n">sig_parts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;arg_decs&#39;</span><span class="p">)</span>
        <span class="n">decs</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">functions</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">functions</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">is_inline</span><span class="p">]</span>
        <span class="n">func_interfaces</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">interfaces</span><span class="p">)</span>
        <span class="n">body_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="n">doc_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">doc_string</span><span class="p">)</span> <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">doc_string</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">local_vars</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">decs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>

        <span class="n">decs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_external_declarations</span><span class="p">())</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">var</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">arguments</span><span class="p">]</span>
        <span class="n">vars_to_print</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vars_to_print</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">local_vars</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">):</span>
                <span class="n">decs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">Declare</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
        <span class="n">prelude</span> <span class="o">+=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">decs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">functions</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">functions_code</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span>  <span class="n">i</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">)</span>
            <span class="n">body_code</span> <span class="o">=</span> <span class="n">body_code</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">contains</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">functions_code</span>

        <span class="n">imports</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">imports</span><span class="p">)</span>

        <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">doc_string</span><span class="p">,</span>
                <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}</span><span class="s2">) </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sig_parts</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">],</span> <span class="n">sig_parts</span><span class="p">[</span><span class="s1">&#39;arg_code&#39;</span><span class="p">],</span> <span class="n">sig_parts</span><span class="p">[</span><span class="s1">&#39;func_end&#39;</span><span class="p">]),</span>
                <span class="n">imports</span><span class="p">,</span>
                <span class="s1">&#39;implicit none</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">prelude</span><span class="p">,</span>
                <span class="n">func_interfaces</span><span class="p">,</span>
                <span class="n">body_code</span><span class="p">,</span>
                <span class="s1">&#39;end </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sig_parts</span><span class="p">[</span><span class="s1">&#39;func_type&#39;</span><span class="p">],</span> <span class="n">name</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">exit_scope</span><span class="p">()</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">parts</span> <span class="k">if</span> <span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Pass"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Pass">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Pass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;! pass</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Nil"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Nil">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Nil</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NilArgument"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NilArgument">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NilArgument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;Trying to use optional argument in inline function without providing a variable&quot;</span><span class="p">,</span>
                <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Return"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Return">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Return</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">stmt</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">stmt</span><span class="p">)</span>
        <span class="n">code</span> <span class="o">+=</span><span class="s1">&#39;return</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Del"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Del">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Del</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="c1"># TODO: treate class case</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">dtype</span>
                <span class="k">if</span> <span class="n">is_pyccel_datatype</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
                    <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;call </span><span class="si">{0}</span><span class="s1"> </span><span class="si">% f</span><span class="s1">ree()&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;deallocate(</span><span class="si">{0}</span><span class="s1">)</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">),</span> <span class="n">code</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">PYCCEL_RESTRICTION_TODO</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">code</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ClassDef"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ClassDef">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ClassDef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="c1"># ... we don&#39;t print &#39;hidden&#39; classes</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">hide</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
        <span class="c1"># ...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_scope</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">scope</span><span class="p">)</span>

        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_current_class</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">base</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># TODO: add base in ClassDef</span>

        <span class="n">decs</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">Declare</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">attributes</span><span class="p">)</span>

        <span class="n">aliases</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">names</span>   <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">methods</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ls</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">_default_methods</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
            <span class="n">aliases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">j</span><span class="p">)))</span>
        <span class="n">methods</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;procedure :: </span><span class="si">{0}</span><span class="s1"> =&gt; </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">aliases</span><span class="p">,</span> <span class="n">names</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">interfaces</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">functions</span><span class="p">)</span>
            <span class="n">methods</span> <span class="o">+=</span> <span class="s1">&#39;generic, public :: </span><span class="si">{0}</span><span class="s1"> =&gt; </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">names</span><span class="p">)</span>
            <span class="n">methods</span> <span class="o">+=</span> <span class="s1">&#39;procedure :: </span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>



        <span class="n">options</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>

        <span class="n">sig</span> <span class="o">=</span> <span class="s1">&#39;type, </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">base</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">, extends(</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>

        <span class="n">code</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> :: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">decs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">decs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;contains</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">methods</span><span class="p">)</span>
        <span class="n">decs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;end type </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

        <span class="n">sep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">SeparatorComment</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
        <span class="c1"># we rename all methods because of the aliasing</span>
        <span class="n">cls_methods</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">methods</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">interfaces</span><span class="p">:</span>
            <span class="n">cls_methods</span> <span class="o">+=</span>  <span class="p">[</span><span class="n">j</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">functions</span><span class="p">]</span>

        <span class="n">methods</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cls_methods</span><span class="p">:</span>
            <span class="n">methods</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{methods}</span><span class="se">\n</span><span class="s1">&#39;</span>
                     <span class="s1">&#39;</span><span class="si">{sep}</span><span class="se">\n</span><span class="s1">&#39;</span>
                     <span class="s1">&#39;</span><span class="si">{f}</span><span class="se">\n</span><span class="s1">&#39;</span>
                     <span class="s1">&#39;</span><span class="si">{sep}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">methods</span><span class="o">=</span><span class="n">methods</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_current_class</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">exit_scope</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">decs</span><span class="p">,</span> <span class="n">methods</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Break"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Break">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Break</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;exit</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Continue"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Continue">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Continue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;cycle</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_AugAssign"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_AugAssign">[docs]</a>    <span class="k">def</span> <span class="nf">_print_AugAssign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">new_expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">to_basic_assign</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">new_expr</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PythonRange"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonRange">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
        <span class="n">step</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>

        <span class="n">test_step</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">step</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">test_step</span><span class="p">,</span> <span class="n">PyccelUnarySub</span><span class="p">):</span>
            <span class="n">test_step</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">step</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># testing if the step is a value or an expression</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">test_step</span><span class="p">,</span> <span class="n">Literal</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">step</span><span class="p">,</span> <span class="n">PyccelUnarySub</span><span class="p">):</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="n">PyccelAdd</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">IfTernaryOperator</span><span class="p">(</span><span class="n">PyccelGt</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">step</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
                                     <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span>
                                     <span class="n">PyccelAdd</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>

        <span class="n">stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_FunctionalFor"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_FunctionalFor">[docs]</a>    <span class="k">def</span> <span class="nf">_print_FunctionalFor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">loops</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">loops</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">loops</span></div>

<div class="viewcode-block" id="FCodePrinter._print_For"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_For">[docs]</a>    <span class="k">def</span> <span class="nf">_print_For</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_scope</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">scope</span><span class="p">)</span>

        <span class="n">indices</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">iterable</span><span class="o">.</span><span class="n">loop_counters</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">indices</span> <span class="k">else</span> <span class="n">expr</span><span class="o">.</span><span class="n">target</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">iterable</span><span class="o">.</span><span class="n">num_loop_counters_required</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">insert_variable</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="n">target</span>   <span class="o">=</span> <span class="n">index</span>
        <span class="n">my_range</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">iterable</span><span class="o">.</span><span class="n">get_range</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">my_range</span><span class="p">,</span> <span class="n">PythonRange</span><span class="p">):</span>
            <span class="c1"># Only iterable currently supported is PythonRange</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">PYCCEL_RESTRICTION_TODO</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>

        <span class="n">tar</span>        <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="n">range_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">my_range</span><span class="p">)</span>

        <span class="n">prolog</span> <span class="o">=</span> <span class="s1">&#39;do </span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tar</span><span class="p">,</span> <span class="n">range_code</span><span class="p">)</span>
        <span class="n">epilog</span> <span class="o">=</span> <span class="s1">&#39;end do</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">additional_assign</span> <span class="o">=</span> <span class="n">CodeBlock</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">iterable</span><span class="o">.</span><span class="n">get_assigns</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">target</span><span class="p">))</span>
        <span class="n">prolog</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">additional_assign</span><span class="p">)</span>

        <span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">end_annotation</span><span class="p">:</span>
            <span class="n">end_annotation</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">end_annotation</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;for&quot;</span><span class="p">,</span> <span class="s2">&quot;do&quot;</span><span class="p">)</span>
            <span class="n">epilog</span> <span class="o">+=</span> <span class="n">end_annotation</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">exit_scope</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{prolog}</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{body}</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{epilog}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prolog</span><span class="o">=</span><span class="n">prolog</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">)</span></div>

    <span class="c1"># .....................................................</span>
    <span class="c1">#               Print OpenMP AnnotatedComment</span>
    <span class="c1"># .....................................................</span>

<div class="viewcode-block" id="FCodePrinter._print_OmpAnnotatedComment"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_OmpAnnotatedComment">[docs]</a>    <span class="k">def</span> <span class="nf">_print_OmpAnnotatedComment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">clauses</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">combined</span><span class="p">:</span>
            <span class="n">combined</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">combined</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;for&quot;</span><span class="p">,</span> <span class="s2">&quot;do&quot;</span><span class="p">)</span>
            <span class="n">clauses</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">combined</span>

        <span class="n">omp_expr</span> <span class="o">=</span> <span class="s1">&#39;!$omp </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;for&quot;</span><span class="p">,</span> <span class="s2">&quot;do&quot;</span><span class="p">))</span>
        <span class="n">clauses</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">txt</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;cancel for&quot;</span><span class="p">,</span> <span class="s2">&quot;cancel do&quot;</span><span class="p">)</span>
        <span class="n">omp_expr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">omp_expr</span><span class="p">,</span> <span class="n">clauses</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">omp_expr</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Omp_End_Clause"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Omp_End_Clause">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Omp_End_Clause</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">omp_expr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">txt</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;section&quot;</span> <span class="ow">in</span> <span class="n">omp_expr</span> <span class="ow">and</span> <span class="s2">&quot;sections&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">omp_expr</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="n">omp_expr</span> <span class="o">=</span> <span class="n">omp_expr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;for&quot;</span><span class="p">,</span> <span class="s2">&quot;do&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">has_nowait</span><span class="p">:</span>
            <span class="n">omp_expr</span> <span class="o">+=</span> <span class="s1">&#39; nowait&#39;</span>
        <span class="n">omp_expr</span> <span class="o">=</span> <span class="s1">&#39;!$omp </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">omp_expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">omp_expr</span></div>
    <span class="c1"># .....................................................</span>

    <span class="c1"># .....................................................</span>
    <span class="c1">#                   OpenACC statements</span>
    <span class="c1"># .....................................................</span>
<div class="viewcode-block" id="FCodePrinter._print_ACC_Parallel"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Parallel">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Parallel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">clauses</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">clauses</span><span class="p">)</span>
        <span class="n">body</span>    <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>

        <span class="c1"># ... TODO adapt get_statement to have continuation with OpenACC</span>
        <span class="n">prolog</span> <span class="o">=</span> <span class="s1">&#39;!$acc parallel </span><span class="si">{clauses}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">clauses</span><span class="o">=</span><span class="n">clauses</span><span class="p">)</span>
        <span class="n">epilog</span> <span class="o">=</span> <span class="s1">&#39;!$acc end parallel</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1"># ...</span>

        <span class="c1"># ...</span>
        <span class="n">code</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{prolog}</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{body}</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{epilog}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prolog</span><span class="o">=</span><span class="n">prolog</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">)</span>
        <span class="c1"># ...</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_statement</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_For"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_For">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_For</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="c1"># ...</span>
        <span class="n">loop</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">loop</span><span class="p">)</span>
        <span class="n">clauses</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">clauses</span><span class="p">)</span>
        <span class="c1"># ...</span>

        <span class="c1"># ... TODO adapt get_statement to have continuation with OpenACC</span>
        <span class="n">prolog</span> <span class="o">=</span> <span class="s1">&#39;!$acc loop </span><span class="si">{clauses}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">clauses</span><span class="o">=</span><span class="n">clauses</span><span class="p">)</span>
        <span class="n">epilog</span> <span class="o">=</span> <span class="s1">&#39;!$acc end loop</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1"># ...</span>

        <span class="c1"># ...</span>
        <span class="n">code</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{prolog}</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{loop}</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{epilog}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prolog</span><span class="o">=</span><span class="n">prolog</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span> <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">)</span>
        <span class="c1"># ...</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_statement</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Async"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Async">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;async(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Auto"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Auto">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Auto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;auto&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Bind"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Bind">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Bind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;bind(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">variable</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Collapse"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Collapse">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Collapse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;collapse(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">n_loops</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Copy"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Copy">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;copy(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Copyin"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Copyin">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Copyin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;copyin(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Copyout"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Copyout">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Copyout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;copyout(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Create"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Create">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;create(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Default"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Default">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;default(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">status</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_DefaultAsync"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_DefaultAsync">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_DefaultAsync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;default_async(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Delete"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Delete">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;delete(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Device"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Device">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Device</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;device(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_DeviceNum"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_DeviceNum">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_DeviceNum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;collapse(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">n_device</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_DevicePtr"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_DevicePtr">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_DevicePtr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;deviceptr(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_DeviceResident"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_DeviceResident">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_DeviceResident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;device_resident(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_DeviceType"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_DeviceType">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_DeviceType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;device_type(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Finalize"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Finalize">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;finalize&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_FirstPrivate"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_FirstPrivate">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_FirstPrivate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;firstprivate(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Gang"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Gang">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Gang</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;gang(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Host"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Host">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Host</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;host(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_If"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_If">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_If</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;if(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">test</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Independent"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Independent">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Independent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;independent&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Link"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Link">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;link(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_NoHost"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_NoHost">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_NoHost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;nohost&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_NumGangs"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_NumGangs">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_NumGangs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;num_gangs(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">n_gang</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_NumWorkers"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_NumWorkers">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_NumWorkers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;num_workers(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">n_worker</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Present"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Present">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Present</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;present(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Private"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Private">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Private</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;private(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Reduction"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Reduction">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Reduction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="n">op</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">operation</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;reduction(</span><span class="si">{0}</span><span class="s2">: </span><span class="si">{1}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Self"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Self">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;self(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Seq"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Seq">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Seq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;seq&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Tile"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Tile">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;tile(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_UseDevice"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_UseDevice">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_UseDevice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;use_device(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Vector"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Vector">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;vector(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_VectorLength"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_VectorLength">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_VectorLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;vector_length(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">n</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Wait"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Wait">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;wait(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ACC_Worker"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ACC_Worker">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ACC_Worker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;worker(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>
    <span class="c1"># .....................................................</span>

<div class="viewcode-block" id="FCodePrinter._print_ForIterator"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ForIterator">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ForIterator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_For</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

        <span class="n">prolog</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">epilog</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># ...</span>
        <span class="k">def</span> <span class="nf">_do_range</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">iterable</span><span class="p">,</span> <span class="n">prolog</span><span class="p">,</span> <span class="n">epilog</span><span class="p">):</span>
            <span class="n">tar</span>        <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
            <span class="n">range_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>

            <span class="n">prolog</span> <span class="o">+=</span> <span class="s1">&#39;do </span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tar</span><span class="p">,</span> <span class="n">range_code</span><span class="p">)</span>
            <span class="n">epilog</span> <span class="o">=</span> <span class="s1">&#39;end do</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">epilog</span>

            <span class="k">return</span> <span class="n">prolog</span><span class="p">,</span> <span class="n">epilog</span>
        <span class="c1"># ...</span>

        <span class="c1"># ...</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">iterable</span><span class="p">,</span> <span class="p">(</span><span class="n">Variable</span><span class="p">,</span> <span class="n">ConstructorCall</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;iterable must be Variable or ConstructorCall.&#39;</span><span class="p">)</span>
        <span class="c1"># ...</span>

        <span class="c1"># ...</span>
        <span class="n">targets</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">target</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">iterable</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
            <span class="n">iters</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">ranges</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">iterable</span><span class="p">,</span> <span class="n">ConstructorCall</span><span class="p">):</span>
            <span class="n">iters</span> <span class="o">=</span> <span class="n">get_iterable_ranges</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">iterable</span><span class="p">)</span>
        <span class="c1"># ...</span>

        <span class="c1"># ...</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">iters</span><span class="p">):</span>
            <span class="n">prolog</span><span class="p">,</span> <span class="n">epilog</span> <span class="o">=</span> <span class="n">_do_range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> \
                                       <span class="n">prolog</span><span class="p">,</span> <span class="n">epilog</span><span class="p">)</span>

        <span class="n">body</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="c1"># ...</span>

        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{prolog}</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{body}</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{epilog}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prolog</span><span class="o">=</span><span class="n">prolog</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">)</span></div>


    <span class="c1">#def _print_Block(self, expr):</span>
    <span class="c1">#    body    = &#39;\n&#39;.join(self._print(i) for i in expr.body)</span>
    <span class="c1">#    prelude = &#39;\n&#39;.join(self._print(i) for i in expr.declarations)</span>
    <span class="c1">#    return prelude, body</span>

<div class="viewcode-block" id="FCodePrinter._print_While"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_While">[docs]</a>    <span class="k">def</span> <span class="nf">_print_While</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">expr</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_scope</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">scope</span><span class="p">)</span>
        <span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exit_scope</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;do while (</span><span class="si">{test}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{body}</span><span class="s1">&#39;</span>
                <span class="s1">&#39;end do</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">test</span><span class="p">),</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ErrorExit"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ErrorExit">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ErrorExit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="c1"># TODO treat the case of MPI</span>
        <span class="k">return</span> <span class="s1">&#39;STOP&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Assert"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Assert">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Assert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">prolog</span> <span class="o">=</span> <span class="s2">&quot;if ( .not. (</span><span class="si">{0}</span><span class="s2">)) then&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">test</span><span class="p">))</span>
        <span class="n">body</span> <span class="o">=</span> <span class="s1">&#39;stop 1&#39;</span>
        <span class="n">epilog</span> <span class="o">=</span> <span class="s1">&#39;end if&#39;</span>
        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{prolog}</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{body}</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="si">{epilog}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prolog</span><span class="o">=</span><span class="n">prolog</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">)</span></div>


<div class="viewcode-block" id="FCodePrinter._print_PyccelIs"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelIs">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelIs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">Nil</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;.not. present(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()):</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> .eqv. </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

        <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">PYCCEL_RESTRICTION_IS_ISNOT</span><span class="p">,</span>
                      <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelIsNot"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelIsNot">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelIsNot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">rhs</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span> <span class="n">Nil</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;present(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> .neqv. </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

        <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">PYCCEL_RESTRICTION_IS_ISNOT</span><span class="p">,</span>
                      <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_If"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_If">[docs]</a>    <span class="k">def</span> <span class="nf">_print_If</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="c1"># ...</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">blocks</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;if (</span><span class="si">%s</span><span class="s2">) then</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">blocks</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">LiteralTrue</span><span class="p">):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;else</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;else if (</span><span class="si">%s</span><span class="s2">) then</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">PythonTuple</span><span class="p">)):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">ee</span><span class="p">)</span> <span class="k">for</span> <span class="n">ee</span> <span class="ow">in</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;end if</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_IfTernaryOperator"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_IfTernaryOperator">[docs]</a>    <span class="k">def</span> <span class="nf">_print_IfTernaryOperator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

        <span class="n">cond</span> <span class="o">=</span> <span class="n">PythonBool</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">cond</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">cond</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">NativeBool</span><span class="p">)</span> <span class="k">else</span> <span class="n">expr</span><span class="o">.</span><span class="n">cond</span>
        <span class="n">value_true</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">value_true</span>
        <span class="n">value_false</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">value_false</span>

        <span class="k">if</span> <span class="n">value_true</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">value_false</span><span class="o">.</span><span class="n">dtype</span> <span class="p">:</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="n">cast_func</span> <span class="o">=</span> <span class="n">python_builtin_datatypes</span><span class="p">[</span><span class="n">str_dtype</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">PYCCEL_RESTRICTION_TODO</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>
            <span class="n">value_true</span> <span class="o">=</span> <span class="n">cast_func</span><span class="p">(</span><span class="n">value_true</span><span class="p">)</span> <span class="k">if</span> <span class="n">value_true</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span> <span class="k">else</span> <span class="n">value_true</span>
            <span class="n">value_false</span> <span class="o">=</span> <span class="n">cast_func</span><span class="p">(</span><span class="n">value_false</span><span class="p">)</span> <span class="k">if</span> <span class="n">value_false</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span> <span class="k">else</span> <span class="n">value_false</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
        <span class="n">value_true</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">value_true</span><span class="p">)</span>
        <span class="n">value_false</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">value_false</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;merge(</span><span class="si">{true}</span><span class="s1">, </span><span class="si">{false}</span><span class="s1">, </span><span class="si">{cond}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cond</span> <span class="o">=</span> <span class="n">cond</span><span class="p">,</span> <span class="n">true</span> <span class="o">=</span> <span class="n">value_true</span><span class="p">,</span> <span class="n">false</span> <span class="o">=</span> <span class="n">value_false</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelPow"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelPow">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelPow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">e</span>    <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">base_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
        <span class="n">e_c</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ** </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">base_c</span><span class="p">,</span> <span class="n">e_c</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelAdd"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelAdd">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelAdd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeString</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;//&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;trim(&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">PythonInt</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
            <span class="k">return</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelMinus"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelMinus">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelMinus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">PythonInt</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="n">args_code</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>

        <span class="k">return</span> <span class="s1">&#39; - &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args_code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelMul"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelMul">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelMul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">PythonInt</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="n">args_code</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="k">return</span> <span class="s1">&#39; * &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args_code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelDiv"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelDiv">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelDiv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">(</span><span class="n">NativeBool</span><span class="p">(),</span> <span class="n">NativeInteger</span><span class="p">())</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">NumpyFloat</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
        <span class="k">return</span> <span class="s1">&#39; / &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelMod"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelMod">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelMod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">is_float</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeFloat</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">correct_type_arg</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">is_float</span> <span class="ow">and</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">NumpyFloat</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">a</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">correct_type_arg</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>

        <span class="n">code</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;MODULO(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelFloorDiv"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelFloorDiv">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelFloorDiv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>

        <span class="n">code</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">adtype</span>   <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
        <span class="n">is_float</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeFloat</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">bdtype</span>    <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">dtype</span>
            <span class="k">if</span> <span class="n">adtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">()</span> <span class="ow">and</span> <span class="n">bdtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">():</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">NumpyFloat</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="n">adtype</span> <span class="o">=</span> <span class="n">bdtype</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;FLOOR(</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">is_float</span><span class="p">:</span>
                <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;real(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">code</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelRShift"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelRShift">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelRShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;RSHIFT(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelLShift"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelLShift">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelLShift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;LSHIFT(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelBitXor"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelBitXor">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelBitXor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39; .neqv. &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;IEOR(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelBitOr"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelBitOr">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelBitOr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39; .or. &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;IOR(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelBitAnd"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelBitAnd">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelBitAnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39; .and. &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;IAND(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelInvert"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelInvert">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelInvert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;NOT(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelAssociativeParenthesis"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelAssociativeParenthesis">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelAssociativeParenthesis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelUnary"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelUnary">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelUnary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;+</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelUnarySub"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelUnarySub">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelUnarySub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelAnd"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelAnd">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelAnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="k">else</span> <span class="n">PythonBool</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="k">return</span> <span class="s1">&#39; .and. &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelOr"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelOr">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelOr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="k">else</span> <span class="n">PythonBool</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="k">return</span> <span class="s1">&#39; .or. &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelEq"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelEq">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelEq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>

        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> .eqv. </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> == </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelNe"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelNe">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelNe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>

        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> .neqv. </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> /= </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelLt"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelLt">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelLt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">PythonInt</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> &lt; </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelLe"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelLe">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelLe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">PythonInt</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> &lt;= </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelGt"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelGt">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelGt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">PythonInt</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> &gt; </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelGe"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelGe">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelGe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">PythonInt</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">()</span> <span class="k">else</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> &gt;= </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_PyccelNot"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelNot">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelNot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NativeBool</span><span class="p">()):</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> == 0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;.not. </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Header"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Header">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_ConstructorCall"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_ConstructorCall">[docs]</a>    <span class="k">def</span> <span class="nf">_print_ConstructorCall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">func</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;__init__&quot;</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;create&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">code_args</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">arguments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">code_args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">(</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">code_args</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_statement</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_SysExit"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_SysExit">[docs]</a>    <span class="k">def</span> <span class="nf">_print_SysExit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NativeInteger</span><span class="p">()</span> <span class="ow">or</span> <span class="n">expr</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">rank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">print_arg</span> <span class="o">=</span> <span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">PythonPrint</span><span class="p">((</span><span class="n">print_arg</span><span class="p">,</span> <span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="s2">&quot;stderr&quot;</span><span class="p">))</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">status</span>
            <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">precision</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="n">NumpyInt32</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s1">stop </span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyUfuncBase"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyUfuncBase">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyUfuncBase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">type_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">func_name</span> <span class="o">=</span> <span class="n">numpy_ufunc_to_fortran</span><span class="p">[</span><span class="n">type_name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print_not_supported</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">NumpyFloat</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">()</span> <span class="k">else</span> <span class="n">a</span><span class="p">)</span>\
				<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="n">code_args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">(</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func_name</span><span class="p">,</span> <span class="n">code_args</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_statement</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpySign"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpySign">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpySign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Print the corresponding Fortran function for a call to Numpy.sign</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            expr : Pyccel ast node</span>
<span class="sd">                Python expression with Numpy.sign call</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            string</span>
<span class="sd">                Equivalent internal function in Fortran</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">            import numpy</span>

<span class="sd">            numpy.sign(x) =&gt; numpy_sign(x)</span>
<span class="sd">            numpy_sign is an interface which calls the proper function depending on the data type of x</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">PyccelFunctionDef</span><span class="p">(</span><span class="s1">&#39;numpy_sign&#39;</span><span class="p">,</span> <span class="n">NumpySign</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_imports</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Import</span><span class="p">(</span><span class="s1">&#39;numpy_f90&#39;</span><span class="p">,</span> <span class="n">AsName</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s1">&#39;numpy_sign&#39;</span><span class="p">)))</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;numpy_sign(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s1">)&#39;</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpyTranspose"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpyTranspose">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpyTranspose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">internal_var</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
        <span class="n">assigns</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">get_user_nodes</span><span class="p">(</span><span class="n">Assign</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">assigns</span> <span class="ow">and</span> <span class="n">assigns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lhs</span><span class="o">.</span><span class="n">order</span> <span class="o">!=</span> <span class="n">var</span><span class="o">.</span><span class="n">order</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">arg</span>
        <span class="k">elif</span> <span class="n">var</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;transpose(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var_shape</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span> <span class="k">else</span> <span class="n">var</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">var_shape</span><span class="p">)</span>
            <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">LiteralInteger</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">rank</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">return</span> <span class="s1">&#39;reshape(</span><span class="si">{}</span><span class="s1">, shape=[</span><span class="si">{}</span><span class="s1">], order=[</span><span class="si">{}</span><span class="s1">])&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_MathFunctionBase"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_MathFunctionBase">[docs]</a>    <span class="k">def</span> <span class="nf">_print_MathFunctionBase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Convert a Python expression with a math function call to Fortran</span>
<span class="sd">        function call</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            expr : Pyccel ast node</span>
<span class="sd">                Python expression with a Math function call</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            string</span>
<span class="sd">                Equivalent expression in Fortran language</span>

<span class="sd">        ------</span>
<span class="sd">        Example:</span>
<span class="sd">        --------</span>
<span class="sd">            math.cos(x)    ==&gt; cos(x)</span>
<span class="sd">            math.gcd(x, y) ==&gt; pyc_gcd(x, y) # with include of pyc_math module</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">type_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">func_name</span> <span class="o">=</span> <span class="n">math_function_to_fortran</span><span class="p">[</span><span class="n">type_name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">PYCCEL_RESTRICTION_TODO</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">func_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;pyc&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_additional_imports</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Import</span><span class="p">(</span><span class="s1">&#39;pyc_math_f90&#39;</span><span class="p">,</span> <span class="n">Module</span><span class="p">(</span><span class="s1">&#39;pyc_math_f90&#39;</span><span class="p">,(),())))</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
                <span class="n">cast_func</span> <span class="o">=</span> <span class="n">python_builtin_datatypes</span><span class="p">[</span><span class="n">str_dtype</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)]</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">cast_func</span><span class="p">(</span><span class="n">arg</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
        <span class="n">code_args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">(</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">func_name</span><span class="p">,</span> <span class="n">code_args</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_MathCeil"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_MathCeil">[docs]</a>    <span class="k">def</span> <span class="nf">_print_MathCeil</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert a Python expression with a math ceil function call to</span>
<span class="sd">        Fortran function call&quot;&quot;&quot;</span>
        <span class="c1"># add necessary include</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">():</span>
            <span class="n">code_arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">NumpyFloat</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code_arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;ceiling(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code_arg</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_MathIsnan"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_MathIsnan">[docs]</a>    <span class="k">def</span> <span class="nf">_print_MathIsnan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert a Python expression with a math isnan function call to</span>
<span class="sd">        Fortran function call&quot;&quot;&quot;</span>
        <span class="c1"># add necessary include</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">():</span>
            <span class="n">code_arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">NumpyFloat</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code_arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;isnan(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code_arg</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_MathTrunc"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_MathTrunc">[docs]</a>    <span class="k">def</span> <span class="nf">_print_MathTrunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert a Python expression with a math trunc function call to</span>
<span class="sd">        Fortran function call&quot;&quot;&quot;</span>
        <span class="c1"># add necessary include</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">():</span>
            <span class="n">code_arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">NumpyFloat</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code_arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;dint(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code_arg</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_MathPow"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_MathPow">[docs]</a>    <span class="k">def</span> <span class="nf">_print_MathPow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">e</span>    <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">base_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
        <span class="n">e_c</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ** </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">base_c</span><span class="p">,</span> <span class="n">e_c</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_NumpySqrt"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_NumpySqrt">[docs]</a>    <span class="k">def</span> <span class="nf">_print_NumpySqrt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeInteger</span><span class="p">()</span> <span class="ow">or</span> <span class="n">arg</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">NativeBool</span><span class="p">():</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">NumpyFloat</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="n">code_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;sqrt(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code_args</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_statement</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_LiteralImaginaryUnit"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_LiteralImaginaryUnit">[docs]</a>    <span class="k">def</span> <span class="nf">_print_LiteralImaginaryUnit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; purpose: print complex numbers nicely in Fortran.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;cmplx(0,1, kind = </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_int"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_int">[docs]</a>    <span class="k">def</span> <span class="nf">_print_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Literal"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Literal">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Literal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">printed</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">python_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">printed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_LiteralTrue"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_LiteralTrue">[docs]</a>    <span class="k">def</span> <span class="nf">_print_LiteralTrue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;.True._</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_LiteralFalse"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_LiteralFalse">[docs]</a>    <span class="k">def</span> <span class="nf">_print_LiteralFalse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;.False._</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">print_kind</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._print_LiteralComplex"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_LiteralComplex">[docs]</a>    <span class="k">def</span> <span class="nf">_print_LiteralComplex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">real_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
        <span class="n">imag_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">real_str</span><span class="p">,</span> <span class="n">imag_str</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_IndexedElement"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_IndexedElement">[docs]</a>    <span class="k">def</span> <span class="nf">_print_IndexedElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">base</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="p">(</span><span class="n">PyccelInternalFunction</span><span class="p">,</span> <span class="n">PythonTuple</span><span class="p">)):</span>
            <span class="n">indexed_type</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">dtype</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">PyccelInternalFunction</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indexed_type</span><span class="p">,</span> <span class="n">PythonTuple</span><span class="p">):</span>
                <span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_PyccelInternalFunction</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">base</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_new_name</span><span class="p">()</span>
                <span class="n">var</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">memory_handling</span> <span class="o">=</span> <span class="s1">&#39;stack&#39;</span><span class="p">,</span>
                        <span class="n">shape</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">precision</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">precision</span><span class="p">,</span>
                        <span class="n">order</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">order</span><span class="p">,</span><span class="n">rank</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">rank</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">insert_variable</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">Assign</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">base</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">indices</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">InhomogeneousTupleVariable</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">base</span><span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">var</span> <span class="o">=</span> <span class="n">base</span><span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">base_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>

        <span class="n">inds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
            <span class="n">inds</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">base_shape</span> <span class="o">=</span> <span class="n">Shape</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">base</span><span class="p">)</span>
        <span class="n">allow_negative_indexes</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">allows_negative_indexes</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inds</span><span class="p">):</span>
            <span class="n">_shape</span> <span class="o">=</span> <span class="n">PyccelArraySize</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">i</span> <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">order</span> <span class="o">!=</span> <span class="s1">&#39;C&#39;</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">inds</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">Slice</span><span class="p">):</span>
                <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_slice_with_processed_arguments</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">_shape</span><span class="p">,</span> <span class="n">allow_negative_indexes</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">PyccelUnarySub</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ind</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">LiteralInteger</span><span class="p">):</span>
                <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">_shape</span><span class="p">,</span> <span class="n">ind</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#indices of indexedElement of len==1 shouldn&#39;t be a tuple</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">allow_negative_indexes</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">):</span>
                    <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">IfTernaryOperator</span><span class="p">(</span><span class="n">PyccelLt</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
                            <span class="n">PyccelAdd</span><span class="p">(</span><span class="n">_shape</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="n">ind</span><span class="p">)</span>

        <span class="n">inds</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">]</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">base_code</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inds</span><span class="p">))</span></div>

<div class="viewcode-block" id="FCodePrinter._new_slice_with_processed_arguments"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._new_slice_with_processed_arguments">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_new_slice_with_processed_arguments</span><span class="p">(</span><span class="n">_slice</span><span class="p">,</span> <span class="n">array_size</span><span class="p">,</span> <span class="n">allow_negative_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create new slice with informations collected from old slice and decorators</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            _slice : Slice</span>
<span class="sd">                slice needed to collect (start, stop, step)</span>
<span class="sd">            array_size : PyccelArraySize</span>
<span class="sd">                call to function size()</span>
<span class="sd">            allow_negative_index : Bool</span>
<span class="sd">                True when the decorator allow_negative_index is present</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Slice</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">_slice</span><span class="o">.</span><span class="n">start</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">_slice</span><span class="o">.</span><span class="n">stop</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">_slice</span><span class="o">.</span><span class="n">step</span>

        <span class="c1"># negative start and end in slice</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">PyccelUnarySub</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">LiteralInteger</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">array_size</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">allow_negative_index</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">LiteralInteger</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">IfTernaryOperator</span><span class="p">(</span><span class="n">PyccelLt</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
                        <span class="n">PyccelAdd</span><span class="p">(</span><span class="n">array_size</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="n">start</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="n">PyccelUnarySub</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stop</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">LiteralInteger</span><span class="p">):</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">array_size</span><span class="p">,</span> <span class="n">stop</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">allow_negative_index</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">):</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">IfTernaryOperator</span><span class="p">(</span><span class="n">PyccelLt</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
                        <span class="n">PyccelAdd</span><span class="p">(</span><span class="n">array_size</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="n">stop</span><span class="p">)</span>

        <span class="c1"># negative step in slice</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">PyccelUnarySub</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">LiteralInteger</span><span class="p">):</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">PyccelAdd</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">start</span> <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">array_size</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># variable step in slice</span>
        <span class="k">elif</span> <span class="n">step</span> <span class="ow">and</span> <span class="n">allow_negative_index</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">IfTernaryOperator</span><span class="p">(</span><span class="n">PyccelGt</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
                    <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">array_size</span> <span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="n">IfTernaryOperator</span><span class="p">(</span><span class="n">PyccelGt</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
                    <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">array_size</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="n">IfTernaryOperator</span><span class="p">(</span><span class="n">PyccelGt</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
                    <span class="n">stop</span><span class="p">,</span> <span class="n">PyccelAdd</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">PyccelMinus</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="n">LiteralInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCodePrinter._print_Slice"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_Slice">[docs]</a>    <span class="k">def</span> <span class="nf">_print_Slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>  <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">Nil</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">Nil</span><span class="p">):</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">:</span><span class="si">{1}</span><span class="s1">:</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">step</span><span class="p">))</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">:</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span></div>

<span class="c1">#=======================================================================================</span>

<div class="viewcode-block" id="FCodePrinter._print_FunctionCall"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_FunctionCall">[docs]</a>    <span class="k">def</span> <span class="nf">_print_FunctionCall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">func</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">funcdef</span>

        <span class="n">f_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">func_name</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">expr</span><span class="o">.</span><span class="n">interface</span> <span class="k">else</span> <span class="n">expr</span><span class="o">.</span><span class="n">interface_name</span><span class="p">)</span>
        <span class="n">args</span>   <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
        <span class="n">func_results</span>  <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">results</span>
        <span class="n">parent_assign</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">get_direct_user_nodes</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Assign</span><span class="p">))</span>
        <span class="n">is_function</span> <span class="o">=</span>  <span class="nb">len</span><span class="p">(</span><span class="n">func_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">func_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">parent_assign</span><span class="p">:</span>
            <span class="n">lhs</span> <span class="o">=</span> <span class="n">parent_assign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lhs</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">func_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">lhs_vars</span> <span class="o">=</span> <span class="p">{</span><span class="n">func_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">lhs</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lhs_vars</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">func_results</span><span class="p">,</span><span class="n">lhs</span><span class="p">))</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">keyword</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">lhs_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">var</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_new_name</span><span class="p">())</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">insert_variable</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">Assign</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">arg</span><span class="p">))</span>
                    <span class="n">newarg</span> <span class="o">=</span> <span class="n">var</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">newarg</span> <span class="o">=</span> <span class="n">arg</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FunctionCallArgument</span><span class="p">(</span><span class="n">newarg</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
            <span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lhs_vars</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">is_function</span><span class="p">:</span>
                <span class="n">results_strs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># If func body is unknown then we may not know result names</span>
                <span class="n">use_names</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">use_names</span><span class="p">:</span>
                    <span class="n">results_strs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                            <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="n">lhs_vars</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">results_strs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">lhs_vars</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">is_function</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">func_results</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_new_name</span><span class="p">())</span> \
                        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">func_results</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">insert_variable</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

            <span class="n">results_strs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> \
                            <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">func_results</span><span class="p">,</span> <span class="n">results</span><span class="p">)]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">results_strs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">func</span><span class="o">.</span><span class="n">is_inline</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">func_results</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_inline_func_call</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">assign_lhs</span> <span class="o">=</span> <span class="n">results</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_inline_func_call</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args_strs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">Nil</span><span class="p">)]</span>
            <span class="n">args_code</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args_strs</span><span class="o">+</span><span class="n">results_strs</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{name}</span><span class="s1">(</span><span class="si">{args}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">name</span> <span class="o">=</span> <span class="n">f_name</span><span class="p">,</span>
                                            <span class="n">args</span> <span class="o">=</span> <span class="n">args_code</span> <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_function</span><span class="p">:</span>
                <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;call </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">parent_assign</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_function</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">func_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">code</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">+=</span> <span class="n">code</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">func_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">is_function</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">code</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">code</span></div>

<span class="c1">#=======================================================================================</span>

<div class="viewcode-block" id="FCodePrinter._print_DottedFunctionCall"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_DottedFunctionCall">[docs]</a>    <span class="k">def</span> <span class="nf">_print_DottedFunctionCall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="n">FunctionCall</span><span class="p">):</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">prefix</span><span class="o">.</span><span class="n">funcdef</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">var_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">get_new_name</span><span class="p">()</span>
            <span class="n">var</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="o">.</span><span class="n">insert_variable</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_code</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">Assign</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">expr</span><span class="o">.</span><span class="n">prefix</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">user_node</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">current_user_node</span>
            <span class="n">expr</span> <span class="o">=</span> <span class="n">DottedFunctionCall</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">funcdef</span><span class="p">,</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
            <span class="n">expr</span><span class="o">.</span><span class="n">set_current_user_node</span><span class="p">(</span><span class="n">user_node</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_FunctionCall</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></div>

<span class="c1">#=======================================================================================</span>

<div class="viewcode-block" id="FCodePrinter._print_PyccelInternalFunction"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PyccelInternalFunction">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PyccelInternalFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">NumpyNewArray</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">errors</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">FORTRAN_ALLOCATABLE_IN_EXPRESSION</span><span class="p">,</span>
                          <span class="n">symbol</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;fatal&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_not_supported</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></div>

<span class="c1">#=======================================================================================</span>

<div class="viewcode-block" id="FCodePrinter._print_PrecomputedCode"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PrecomputedCode">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PrecomputedCode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">code</span></div>

<span class="c1">#=======================================================================================</span>

<div class="viewcode-block" id="FCodePrinter._print_CLocFunc"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_CLocFunc">[docs]</a>    <span class="k">def</span> <span class="nf">_print_CLocFunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constantImports</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;ISO_C_Binding&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;c_loc&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lhs</span><span class="si">}</span><span class="s1"> = c_loc(</span><span class="si">{</span><span class="n">rhs</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span></div>

<span class="c1">#=======================================================================================</span>

<div class="viewcode-block" id="FCodePrinter._print_PythonConjugate"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._print_PythonConjugate">[docs]</a>    <span class="k">def</span> <span class="nf">_print_PythonConjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;conjg( </span><span class="si">{}</span><span class="s1"> )&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">internal_var</span><span class="p">)</span> <span class="p">)</span></div>

<span class="c1">#=======================================================================================</span>

<div class="viewcode-block" id="FCodePrinter._wrap_fortran"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter._wrap_fortran">[docs]</a>    <span class="k">def</span> <span class="nf">_wrap_fortran</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wrap long Fortran lines</span>

<span class="sd">           Argument:</span>
<span class="sd">             lines  --  a list of lines (ending with a \\n character)</span>

<span class="sd">           A comment line is split at white space. Code lines are split with a more</span>
<span class="sd">           complex rule to give nice results.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># routine to find split point in a code line</span>
        <span class="n">my_alnum</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s2">&quot;_+-.&quot;</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">)</span>
        <span class="n">my_white</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s2">&quot; </span><span class="se">\t</span><span class="s2">()&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">split_pos_code</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">endpos</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">endpos</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">endpos</span>
            <span class="n">split</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">pos</span><span class="p">:</span> \
                <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="n">my_alnum</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">my_alnum</span><span class="p">)</span> <span class="ow">or</span> \
                <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">my_alnum</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">my_alnum</span><span class="p">)</span> <span class="ow">or</span> \
                <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="n">my_white</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">my_white</span><span class="p">)</span> <span class="ow">or</span> \
                <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">my_white</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">my_white</span><span class="p">)</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">split</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
                <span class="n">pos</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">endpos</span>
            <span class="k">return</span> <span class="n">pos</span>

        <span class="c1"># split line by line and add the splitted lines to result</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">trailing</span> <span class="o">=</span> <span class="s1">&#39; &amp;&#39;</span>
        <span class="c1"># trailing with no added space characters in case splitting is within quotes</span>
        <span class="n">quote_trailing</span> <span class="o">=</span> <span class="s1">&#39;&amp;&#39;</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">72</span><span class="p">:</span>
                <span class="n">cline</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="mi">72</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">cline</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">cline</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;!$&#39;</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="n">tab_len</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cline</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="c1"># code line</span>
                <span class="c1"># set containing positions inside quotes</span>
                <span class="n">inside_quotes_positions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                <span class="n">inside_quotes_intervals</span> <span class="o">=</span> <span class="p">[(</span><span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">())</span>
                                           <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;(&quot;[^&quot;]*&quot;)|(</span><span class="se">\&#39;</span><span class="s1">[^</span><span class="se">\&#39;</span><span class="s1">]*</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">line</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">lidx</span><span class="p">,</span> <span class="n">ridx</span> <span class="ow">in</span> <span class="n">inside_quotes_intervals</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lidx</span><span class="p">,</span> <span class="n">ridx</span><span class="p">):</span>
                        <span class="n">inside_quotes_positions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
                <span class="n">initial_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">split_pos_code</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="mi">72</span><span class="p">)</span>

                <span class="n">startswith_omp</span> <span class="o">=</span> <span class="n">cline</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;!$omp&#39;</span><span class="p">)</span>
                <span class="n">startswith_acc</span> <span class="o">=</span> <span class="n">cline</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;!$acc&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">startswith_acc</span> <span class="ow">or</span> <span class="n">startswith_omp</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">pos</span><span class="o">&gt;=</span><span class="mi">5</span>

                <span class="k">if</span> <span class="n">pos</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inside_quotes_positions</span><span class="p">:</span>
                    <span class="n">hunk</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="n">pos</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hunk</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="n">pos</span><span class="p">]</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>

                <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">hunk</span> <span class="o">+=</span> <span class="p">(</span><span class="n">quote_trailing</span> <span class="k">if</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">inside_quotes_positions</span> <span class="k">else</span> <span class="n">trailing</span><span class="p">)</span>

                <span class="n">last_cut_was_inside_quotes</span> <span class="o">=</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">inside_quotes_positions</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hunk</span><span class="p">)</span>
                <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">removed</span> <span class="o">=</span> <span class="n">initial_len</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="n">split_pos_code</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="mi">65</span><span class="o">-</span><span class="n">tab_len</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">removed</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inside_quotes_positions</span><span class="p">:</span>
                        <span class="n">hunk</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="n">pos</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">hunk</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="n">pos</span><span class="p">]</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
                    <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                        <span class="n">hunk</span> <span class="o">+=</span> <span class="p">(</span><span class="n">quote_trailing</span> <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">removed</span><span class="p">)</span> <span class="ow">in</span> <span class="n">inside_quotes_positions</span> <span class="k">else</span> <span class="n">trailing</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">last_cut_was_inside_quotes</span><span class="p">:</span>
                        <span class="n">hunk_start</span> <span class="o">=</span> <span class="n">tab_len</span><span class="o">*</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39;&amp;&#39;</span>
                    <span class="k">elif</span> <span class="n">startswith_omp</span><span class="p">:</span>
                        <span class="n">hunk_start</span> <span class="o">=</span> <span class="n">tab_len</span><span class="o">*</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39;!$omp &amp;&#39;</span>
                    <span class="k">elif</span> <span class="n">startswith_acc</span><span class="p">:</span>
                        <span class="n">hunk_start</span> <span class="o">=</span> <span class="n">tab_len</span><span class="o">*</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39;!$acc &amp;&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">hunk_start</span> <span class="o">=</span> <span class="n">tab_len</span><span class="o">*</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39;      &#39;</span>

                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hunk_start</span> <span class="o">+</span> <span class="n">hunk</span><span class="p">)</span>
                    <span class="n">last_cut_was_inside_quotes</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">removed</span><span class="p">)</span> <span class="ow">in</span> <span class="n">inside_quotes_positions</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="c1"># make sure that all lines end with a carriage return</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">l</span> <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">l</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span></div>

<div class="viewcode-block" id="FCodePrinter.indent_code"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.FCodePrinter.indent_code">[docs]</a>    <span class="k">def</span> <span class="nf">indent_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Accepts a string of code or a list of code lines&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">code_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indent_code</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">code_lines</span><span class="p">)</span>

        <span class="n">code</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">code</span><span class="p">]</span>

        <span class="n">increase</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">inc_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">code</span><span class="p">]</span>
        <span class="n">decrease</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">dec_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">code</span><span class="p">]</span>

        <span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">tabwidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_settings</span><span class="p">[</span><span class="s1">&#39;tabwidth&#39;</span><span class="p">]</span>
        <span class="n">new_code</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">code</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">line</span> <span class="ow">in</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">new_code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">level</span> <span class="o">-=</span> <span class="n">decrease</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">padding</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="p">(</span><span class="n">level</span><span class="o">*</span><span class="n">tabwidth</span><span class="p">)</span>

            <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>

            <span class="n">new_code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">level</span> <span class="o">+=</span> <span class="n">increase</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">new_code</span></div></div>


<div class="viewcode-block" id="fcode"><a class="viewcode-back" href="../../../../pyccel.codegen.printing.html#pyccel.codegen.printing.fcode.fcode">[docs]</a><span class="k">def</span> <span class="nf">fcode</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">assign_to</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts an expr to a string of Fortran code</span>

<span class="sd">    expr : Expr</span>
<span class="sd">        A pyccel expression to be converted.</span>
<span class="sd">    filename : str</span>
<span class="sd">        The name of the file being translated. Used in error printing</span>
<span class="sd">    assign_to : optional</span>
<span class="sd">        When given, the argument is used as the name of the variable to which</span>
<span class="sd">        the expression is assigned. Can be a string, ``Symbol``,</span>
<span class="sd">        ``MatrixSymbol``, or ``Indexed`` type. This is helpful in case of</span>
<span class="sd">        line-wrapping, or for expressions that generate multi-line statements.</span>
<span class="sd">    precision : integer, optional</span>
<span class="sd">        The precision for numbers such as pi [default=15].</span>
<span class="sd">    user_functions : dict, optional</span>
<span class="sd">        A dictionary where keys are ``FunctionClass`` instances and values are</span>
<span class="sd">        their string representations. Alternatively, the dictionary value can</span>
<span class="sd">        be a list of tuples i.e. [(argument_test, cfunction_string)]. See below</span>
<span class="sd">        for examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">FCodePrinter</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span><span class="o">.</span><span class="n">doprint</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">assign_to</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, *.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>